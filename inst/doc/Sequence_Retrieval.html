<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="date" content="2019-05-21" />

<title>Sequence Retrieval</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Sequence Retrieval</h1>
<h4 class="date">2019-05-21</h4>



<div id="biological-sequence-retrieval" class="section level2">
<h2>Biological Sequence Retrieval</h2>
<p>The <code>biomartr</code> package allows users to retrieve biological sequences in a very simple and intuitive way.</p>
<p>Using <code>biomartr</code>, users can retrieve either genomes, proteomes, CDS, RNA, GFF, and genome assembly statistics data using the specialized functions:</p>
<ul>
<li><a href="#genome-retrieval">1. Genome retrieval with <code>getGenome()</code></a>
<ul>
<li><a href="#example-ncbi-refseq">1.1 from NCBI RefSeq</a></li>
<li><a href="#example-ncbi-genbank">1.2 from NCBI Genbank</a></li>
<li><a href="#example-ensembl">1.3 from ENSEMBL</a></li>
</ul></li>
<li><a href="#genomeset-retrieval">1.B. Multiple genome retrieval with <code>getGenomeSet()</code></a></li>
<li><a href="#proteome-retrieval">2. Proteome retrieval with <code>getProteome()</code></a>
<ul>
<li><a href="#example-ncbi-refseq-1">2.1 from NCBI RefSeq</a></li>
<li><a href="#example-ncbi-genbank-1">2.2 from NCBI Genbank</a></li>
<li><a href="#example-ensembl-1">2.3 from ENSEMBL</a></li>
<li><a href="#example-retrieval-uniprot">2.5 from UniProt</a></li>
</ul></li>
<li><a href="#proteomeset-retrieval">2.B. Multiple proteome retrieval with <code>getProteomeSet()</code></a></li>
<li><a href="#cds-retrieval">3. Coding sequence retrieval with <code>getCDS()</code></a>
<ul>
<li><a href="#example-ncbi-refseq-2">3.1 from NCBI RefSeq</a></li>
<li><a href="#example-ncbi-genbank-2">3.2 from NCBI Genbank</a></li>
<li><a href="#example-ensembl-2">3.3 from ENSEMBL</a></li>
</ul></li>
<li><a href="#cdsset-retrieval">3.B. Multiple coding sequence retrieval with <code>getCDSSet()</code></a></li>
<li><a href="#rna-retrieval">4. RNA retrieval with <code>getRNA()</code></a>
<ul>
<li><a href="#example-ncbi-refseq-3">4.1 from NCBI RefSeq</a></li>
<li><a href="#example-ncbi-genbank-3">4.2 from NCBI Genbank</a></li>
<li><a href="#example-ensembl-3">4.3 from ENSEMBL</a></li>
</ul></li>
<li><a href="#rnaset-retrieval">4.B. Multiple RNA retrieval with <code>getRNASet()</code></a></li>
<li><a href="#retrieve-the-annotation-file-of-a-particular-genome">5. GFF retrieval with <code>getGFF()</code></a>
<ul>
<li><a href="#example-ncbi-refseq-4">5.1 from NCBI RefSeq</a></li>
<li><a href="#example-ncbi-genbank-4">5.2 from NCBI Genbank</a></li>
<li><a href="#example-ensembl-4">5.3 from ENSEMBL</a></li>
</ul></li>
<li><a href="#gffset-retrieval">5.B. Multiple GFF retrieval with <code>getGFFSet()</code></a></li>
<li><a href="#retrieve-the-annotation-file-of-a-particular-genome">6. GTF retrieval with <code>getGTF()</code></a>
<ul>
<li><a href="#example-ncbi-refseq-5">6.1 from NCBI RefSeq</a></li>
<li><a href="#example-ncbi-genbank-5">6.2 from NCBI Genbank</a></li>
<li><a href="#example-ensembl-5">6.3 from ENSEMBL</a></li>
</ul></li>
<li><a href="#repeat-masker-retrieval">7. Repeat Masker Annotation file retrieval with <code>getRepeatMasker()</code></a>
<ul>
<li><a href="#example-ncbi-refseq-6">7.1 from NCBI RefSeq</a></li>
</ul></li>
<li><a href="#genome-assembly-stats-retrieval">8. Genome Assembly Stats Retrieval with <code>getAssemblyStats()</code></a>
<ul>
<li><a href="#example-ncbi-refseq-7">8.1 from NCBI RefSeq</a></li>
<li><a href="#example-ncbi-genbank-6">8.2 from NCBI Genbank</a></li>
</ul></li>
<li><a href="#collection-retrieval">9. Collection (Genome, Proteome, CDS, RNA, GFF, Repeat Masker, AssemblyStats) retrieval with <code>getCollection()</code></a>
<ul>
<li><a href="#example-ncbi-refseq-8">9.1 from NCBI RefSeq</a></li>
<li><a href="#example-ncbi-genbank-7">9.2 from NCBI Genbank</a></li>
<li><a href="#example-ensembl-6">9.3 from NCBI ENSEMBL</a></li>
</ul></li>
</ul>
</div>
<div id="getting-started-with-sequence-retrieval" class="section level2">
<h2>Getting Started with Sequence Retrieval</h2>
<p>First users can check whether or not the genome, proteome, CDS, RNA, GFF, GTF, or genome assembly statistics of their interest is available for download.</p>
<p>Using the scientific name of the organism of interest, users can check whether the corresponding genome is available via the <code>is.genome.available()</code> function.</p>
<p>Please note that the first time you run this command it might take a while, because during the initial execution of this function all necessary information is retrieved from NCBI and then stored locally. All further runs are then much faster.</p>
<div id="example-ncbi-refseq-is.genome.available" class="section level3">
<h3>Example <code>NCBI RefSeq</code> (?is.genome.available):</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># checking whether or not the Homo sapiens </span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="co"># genome is avaialable for download</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw">is.genome.available</span>(<span class="dt">db =</span> <span class="st">&quot;refseq&quot;</span>, <span class="dt">organism =</span> <span class="st">&quot;Homo sapiens&quot;</span>)</a></code></pre></div>
<pre><code>A reference or representative genome assembly is available for 'Homo sapiens'.
[1] TRUE</code></pre>
<p>In the case of the human genome, there are more than one entry in the NCBI RefSeq database (see message). By specifying the argument ‘details = TRUE’ users can retrieve all information for ‘Homo sapiens’ that is stored in NCBI RefSeq.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co"># checking whether or not the Homo sapiens </span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="co"># genome is avaialable for download</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="kw">is.genome.available</span>(<span class="dt">db =</span> <span class="st">&quot;refseq&quot;</span>, <span class="dt">organism =</span> <span class="st">&quot;Homo sapiens&quot;</span>, <span class="dt">details =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>  assembly_accessi… bioproject biosample wgs_master refseq_category taxid
  &lt;chr&gt;             &lt;chr&gt;      &lt;chr&gt;     &lt;chr&gt;      &lt;chr&gt;           &lt;int&gt;
1 GCF_000001405.38  PRJNA168   NA        NA         reference geno…  9606
# ... with 15 more variables: species_taxid &lt;int&gt;, organism_name &lt;chr&gt;,
#   infraspecific_name &lt;chr&gt;, isolate &lt;chr&gt;, version_status &lt;chr&gt;,
#   assembly_level &lt;chr&gt;, release_type &lt;chr&gt;, genome_rep &lt;chr&gt;,
#   seq_rel_date &lt;date&gt;, asm_name &lt;chr&gt;, submitter &lt;chr&gt;,
#   gbrs_paired_asm &lt;chr&gt;, paired_asm_comp &lt;chr&gt;, ftp_path &lt;chr&gt;,
#   excluded_from_refseq &lt;chr&gt;</code></pre>
<p>Here, we find one possible versions of the human genome having the <code>assembly_accession</code> ID <code>GCF_000001405.38</code>.</p>
<p>When retrieving a genome with e.g. <code>getGenome()</code> the <code>organism</code> argument can also be specified using the <code>assembly_accession</code> ID instead of the scientific name of the organism. This is true for all <code>get*()</code> functions. Hence, instead of writing <code>getGenome(db = &quot;refseq&quot;, organism = &quot;Homo sapiens&quot;)</code>, users can specify <code>getGenome(db = &quot;refseq&quot;, organism = &quot;GCF_000001405.38&quot;)</code>. This is particularly useful when more than one entry is available for one organism.</p>
<p><strong>Please note that the <code>assembly_accession</code> id might change internally in external databases such as NCBI RefSeq. Thus when writing automated scripts using the <code>assembly_accession</code> id they might stop working due to the internal change of ids at RefSeq. Recently, I had the case where the <code>assembly_accession</code> id was changed at RefSeq from <code>GCF_000001405.37</code> to <code>GCF_000001405.38</code>. Thus, scripts based on screening for entries with <code>is.genome.available()</code> stopped working, because the id <code>GCF_000001405.37</code> couldn’t be found anymore.</strong></p>
<p>In some cases users will find several entries for the same scientific name. This might be due to the fact that ecotypes, strains, or other types of sub-species are available in the respective databases.</p>
<p>For example. when we search for the bacterium <code>Mycobacterium tuberculosis</code> in NCBI RefSeq we get 5377 hits.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw">is.genome.available</span>(<span class="dt">organism =</span> <span class="st">&quot;Mycobacterium tuberculosis&quot;</span>, <span class="dt">db =</span> <span class="st">&quot;refseq&quot;</span>, <span class="dt">details =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>A tibble: 5,377 x 21
   assembly_accessi… bioproject biosample wgs_master refseq_category  taxid
   &lt;chr&gt;             &lt;chr&gt;      &lt;chr&gt;     &lt;chr&gt;      &lt;chr&gt;            &lt;int&gt;
 1 GCF_000008585.1   PRJNA2241… SAMN0260… NA         na               83331
 2 GCF_000016145.1   PRJNA2241… SAMN0260… NA         na              419947
 3 GCF_000016925.1   PRJNA2241… SAMN0010… NA         na              336982
 4 GCF_000023625.1   PRJNA2241… SAMN0076… NA         na              478434
 5 GCF_000152105.1   PRJNA2241… SAMN0259… ADHQ00000… na              675512
 6 GCF_000153685.2   PRJNA2241… SAMN0308… NA         na              395095
 7 GCF_000154585.2   PRJNA2241… SAMN0308… NA         na              478433
 8 GCF_000154605.2   PRJNA2241… SAMN0010… NA         na              478435
 9 GCF_000155795.1   PRJNA2241… SAMN0259… ABVM00000… na              555461
10 GCF_000159755.1   PRJNA2241… SAMN0259… ACHP00000… na              611303
# ... with 5,367 more rows, and 15 more variables: species_taxid &lt;int&gt;,
#   organism_name &lt;chr&gt;, infraspecific_name &lt;chr&gt;, isolate &lt;chr&gt;,
#   version_status &lt;chr&gt;, assembly_level &lt;chr&gt;, release_type &lt;chr&gt;,
#   genome_rep &lt;chr&gt;, seq_rel_date &lt;date&gt;, asm_name &lt;chr&gt;, submitter &lt;chr&gt;,
#   gbrs_paired_asm &lt;chr&gt;, paired_asm_comp &lt;chr&gt;, ftp_path &lt;chr&gt;,
#   excluded_from_refseq &lt;chr&gt;</code></pre>
<p>When looking at the names of these organisms we see that they consist of different strains of <code>Mycobacterium tuberculosis</code>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw">head</span>(<span class="kw">is.genome.available</span>(<span class="dt">organism =</span> <span class="st">&quot;Mycobacterium tuberculosis&quot;</span>, </a>
<a class="sourceLine" id="cb7-2" data-line-number="2">                         <span class="dt">db =</span> <span class="st">&quot;refseq&quot;</span>, </a>
<a class="sourceLine" id="cb7-3" data-line-number="3">                         <span class="dt">details =</span> <span class="ot">TRUE</span>)<span class="op">$</span>organism_name)</a></code></pre></div>
<pre><code>[1] &quot;Mycobacterium tuberculosis CDC1551&quot;     
[2] &quot;Mycobacterium tuberculosis H37Ra&quot;       
[3] &quot;Mycobacterium tuberculosis F11&quot;         
[4] &quot;Mycobacterium tuberculosis KZN 1435&quot;    
[5] &quot;Mycobacterium tuberculosis SUMu001&quot;     
[6] &quot;Mycobacterium tuberculosis str. Haarlem&quot;</code></pre>
<p>Now we can use the <code>assembly_accession</code> id to retrieve the <code>Mycobacterium tuberculosis</code> strain we are interested in, e.g. <code>Mycobacterium tuberculosis CDC1551</code>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">MtbCDC1551 &lt;-<span class="st"> </span><span class="kw">getGenome</span>(<span class="dt">db =</span> <span class="st">&quot;refseq&quot;</span>, </a>
<a class="sourceLine" id="cb9-2" data-line-number="2">                        <span class="dt">organism =</span> <span class="st">&quot;GCF_000008585.1&quot;</span>,  </a>
<a class="sourceLine" id="cb9-3" data-line-number="3">                        <span class="dt">path   =</span> <span class="kw">file.path</span>(<span class="st">&quot;_ncbi_downloads&quot;</span>,<span class="st">&quot;genomes&quot;</span>), </a>
<a class="sourceLine" id="cb9-4" data-line-number="4">                        <span class="dt">reference =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb9-5" data-line-number="5">                        </a>
<a class="sourceLine" id="cb9-6" data-line-number="6">MtbCDC1551_genome &lt;-<span class="st"> </span><span class="kw">read_genome</span>(MtbCDC1551)</a>
<a class="sourceLine" id="cb9-7" data-line-number="7"></a>
<a class="sourceLine" id="cb9-8" data-line-number="8">MtbCDC1551_genome</a></code></pre></div>
<pre><code>A DNAStringSet instance of length 1
      width seq                             names               
[1] 4403837 TTGACCGATGACCC...AGGGAGATACGTCG NC_002755.2 Mycob...</code></pre>
<div id="using-the-ncbi-taxonomy-id-instead-of-the-scientific-name-to-screen-for-organism-availability" class="section level4">
<h4>Using the NCBI Taxonomy ID instead of the scientific name to screen for organism availability</h4>
<p>Instead of specifying the <code>scientific name</code> of the organism of interest users can specify the <a href="https://www.ncbi.nlm.nih.gov/taxonomy">NCBI Taxonomy</a> identifier (= <code>taxid</code>) of the corresponding organism. For example, the <code>taxid</code> of <code>Homo sapiens</code> is <code>9606</code>. Now users can specify <code>organism = &quot;9606&quot;</code> to retrieve entries for <code>Homo sapiens</code>:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="co"># checking availability for Homo sapiens using its taxid</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="kw">is.genome.available</span>(<span class="dt">db =</span> <span class="st">&quot;refseq&quot;</span>, <span class="dt">organism =</span> <span class="st">&quot;9606&quot;</span>, <span class="dt">details =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>  assembly_accession bioproject biosample wgs_master refseq_category  taxid
  &lt;chr&gt;              &lt;chr&gt;      &lt;chr&gt;     &lt;chr&gt;      &lt;chr&gt;            &lt;int&gt;
1 GCF_000001405.38   PRJNA168   NA        NA         reference genome  9606
# ... with 15 more variables: species_taxid &lt;int&gt;, organism_name &lt;chr&gt;,
#   infraspecific_name &lt;chr&gt;, isolate &lt;chr&gt;, version_status &lt;chr&gt;,
#   assembly_level &lt;chr&gt;, release_type &lt;chr&gt;, genome_rep &lt;chr&gt;,
#   seq_rel_date &lt;date&gt;, asm_name &lt;chr&gt;, submitter &lt;chr&gt;,
#   gbrs_paired_asm &lt;chr&gt;, paired_asm_comp &lt;chr&gt;, ftp_path &lt;chr&gt;,
#   excluded_from_refseq &lt;chr&gt;</code></pre>
</div>
<div id="using-the-accession-id-instead-of-the-scientific-name-or-taxid-to-screen-for-organism-availability" class="section level4">
<h4>Using the accession ID instead of the scientific name or taxid to screen for organism availability</h4>
<p>Finally, instead of specifying either the <code>scientific name</code> of the organism of interest nor the <code>taxid</code>, users can specify the accession ID of the organism of interest. In the following example we use the accession ID of <code>Homo sapiens</code> (= <code>GCF_000001405.38</code>):</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="co"># checking availability for Homo sapiens using its taxid</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="kw">is.genome.available</span>(<span class="dt">db =</span> <span class="st">&quot;refseq&quot;</span>, <span class="dt">organism =</span> <span class="st">&quot;GCF_000001405.38&quot;</span>, <span class="dt">details =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>assembly_accession bioproject biosample wgs_master refseq_category  taxid
  &lt;chr&gt;              &lt;chr&gt;      &lt;chr&gt;     &lt;chr&gt;      &lt;chr&gt;            &lt;int&gt;
1 GCF_000001405.38   PRJNA168   NA        NA         reference genome  9606
# ... with 15 more variables: species_taxid &lt;int&gt;, organism_name &lt;chr&gt;,
#   infraspecific_name &lt;chr&gt;, isolate &lt;chr&gt;, version_status &lt;chr&gt;,
#   assembly_level &lt;chr&gt;, release_type &lt;chr&gt;, genome_rep &lt;chr&gt;,
#   seq_rel_date &lt;date&gt;, asm_name &lt;chr&gt;, submitter &lt;chr&gt;,
#   gbrs_paired_asm &lt;chr&gt;, paired_asm_comp &lt;chr&gt;, ftp_path &lt;chr&gt;,
#   excluded_from_refseq &lt;chr&gt;</code></pre>
</div>
<div id="a-small-negative-example" class="section level4">
<h4>A small negative example</h4>
<p>In some cases your organism of interest will not be available in <code>NCBI RefSeq</code>. Here an example:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="co"># check genome availability for Candida glabrata</span></a>
<a class="sourceLine" id="cb15-2" data-line-number="2"><span class="kw">is.genome.available</span>(<span class="dt">db =</span> <span class="st">&quot;refseq&quot;</span>, <span class="dt">organism =</span> <span class="st">&quot;Candida glabrata&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">Unfortunatey, no entry <span class="cf">for</span> <span class="st">'Candida glabrata'</span> was found <span class="cf">in</span> the <span class="st">'refseq'</span> database. </a>
<a class="sourceLine" id="cb16-2" data-line-number="2">Please consider specifying <span class="st">'db = genbank'</span> or <span class="st">'db = ensembl'</span> </a>
<a class="sourceLine" id="cb16-3" data-line-number="3">to check whether <span class="st">'Candida glabrata'</span> is availabe <span class="cf">in</span> these databases.</a>
<a class="sourceLine" id="cb16-4" data-line-number="4">[<span class="dv">1</span>] <span class="ot">FALSE</span></a></code></pre></div>
<p>When now checking the availability in <code>NCBI Genbank</code> we find that indeed ‘Candida glabrata’ is availabe:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="co"># check genome availability for Candida glabrata</span></a>
<a class="sourceLine" id="cb17-2" data-line-number="2"><span class="kw">is.genome.available</span>(<span class="dt">db =</span> <span class="st">&quot;genbank&quot;</span>, <span class="dt">organism =</span> <span class="st">&quot;Candida glabrata&quot;</span>)</a></code></pre></div>
<pre><code>Only a non-reference genome assembly is available for 'Candida glabrata'. 
Please make sure to specify the argument 'reference = FALSE' when running any get*() function.
[1] TRUE</code></pre>
<p>Although, an entry is available the <code>is.genome.available()</code> warns us that only a non-reference genome is available for ‘Candida glabrata’. To then retrieve the e.g. genome etc. files users need to speficy the <code>reference = FALSE</code> argument in the <code>get*()</code> functions.</p>
<p>For example:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="co"># retrieve non-reference genome </span></a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="kw">getGenome</span>(<span class="dt">db =</span> <span class="st">&quot;genbank&quot;</span>, <span class="dt">organism =</span> <span class="st">&quot;Candida glabrata&quot;</span>, <span class="dt">reference =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<pre><code>Only a non-reference genome assembly is available for 'Candida glabrata'. 
Please make sure to specify the argument 'reference = FALSE' when running any get*() function.
Genome download is completed!
Checking md5 hash of file: _ncbi_downloads/genomes/Candida_glabrata_md5checksums.txt ...
The md5 hash of file '_ncbi_downloads/genomes/Candida_glabrata_md5checksums.txt' matches!
The genome of 'Candida_glabrata' has been downloaded to '_ncbi_downloads/genomes' 
and has been named 'Candida_glabrata_genomic_genbank.fna.gz'.
[1] &quot;_ncbi_downloads/genomes/Candida_glabrata_genomic_genbank.fna.gz&quot;</code></pre>
</div>
</div>
<div id="example-ncbi-genbank-is.genome.available" class="section level3">
<h3>Example <code>NCBI Genbank</code> (?is.genome.available):</h3>
<p>Test whether or not the genome of <code>Homo sapiens</code> is present at NCBI Genbank.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="co"># checking whether or not the Homo sapiens </span></a>
<a class="sourceLine" id="cb21-2" data-line-number="2"><span class="co"># genome is avaialable for download</span></a>
<a class="sourceLine" id="cb21-3" data-line-number="3"><span class="kw">is.genome.available</span>(<span class="dt">db =</span> <span class="st">&quot;genbank&quot;</span>, <span class="dt">organism =</span> <span class="st">&quot;Homo sapiens&quot;</span>)</a></code></pre></div>
<pre><code>A reference or representative genome assembly is available for 'Homo sapiens'.
More than one entry was found for 'Homo sapiens'. 
Please consider to re-run this funtion and specify 'details = TRUE'. 
This will allow you to select the 'assembly_accession' identifier 
that can then be specified in all get*() functions.
[1] TRUE</code></pre>
<p>Now with <code>details = TRUE</code>.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="co"># checking whether or not the Homo sapiens </span></a>
<a class="sourceLine" id="cb23-2" data-line-number="2"><span class="co"># genome is avaialable for download</span></a>
<a class="sourceLine" id="cb23-3" data-line-number="3"><span class="kw">is.genome.available</span>(<span class="dt">db =</span> <span class="st">&quot;genbank&quot;</span>, <span class="dt">organism =</span> <span class="st">&quot;Homo sapiens&quot;</span>, <span class="dt">details =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code> assembly_accessi… bioproject biosample   wgs_master  refseq_category taxid
   &lt;chr&gt;             &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;       &lt;chr&gt;           &lt;int&gt;
 1 GCA_000001405.27  PRJNA31257 NA          NA          reference geno…  9606
 2 GCA_000002115.2   PRJNA1431  SAMN029812… AADD000000… na               9606
 3 GCA_000002125.2   PRJNA19621 SAMN029812… ABBA000000… na               9606
 4 GCA_000002135.3   PRJNA10793 NA          NA          na               9606
 5 GCA_000004845.2   PRJNA42199 SAMN000033… ADDF000000… na               9606
 6 GCA_000005465.1   PRJNA42201 NA          DAAB000000… na               9606
 7 GCA_000181135.1   PRJNA28335 SAMN000016… ABKV000000… na               9606
 8 GCA_000185165.1   PRJNA59877 SAMN029812… AEKP000000… na               9606
 9 GCA_000212995.1   PRJNA19621 SAMN029812… ABSL000000… na               9606
10 GCA_000252825.1   PRJNA19621 SAMN029812… ABBA000000… na               9606
# ... with 70 more rows, and 15 more variables: species_taxid &lt;int&gt;,
#   organism_name &lt;chr&gt;, infraspecific_name &lt;chr&gt;, isolate &lt;chr&gt;,
#   version_status &lt;chr&gt;, assembly_level &lt;chr&gt;, release_type &lt;chr&gt;,
#   genome_rep &lt;chr&gt;, seq_rel_date &lt;date&gt;, asm_name &lt;chr&gt;, submitter &lt;chr&gt;,
#   gbrs_paired_asm &lt;chr&gt;, paired_asm_comp &lt;chr&gt;, ftp_path &lt;chr&gt;,
#   excluded_from_refseq &lt;chr&gt;</code></pre>
<p>As you can see there are several versions of the <code>Homo sapiens</code> genome available for download from NCBI Genbank. Using the <code>assembly_accession</code> id will now allow to specify which version shall be retrieved.</p>
</div>
<div id="using-is.genome.available-with-ensembl" class="section level3">
<h3>Using <code>is.genome.available()</code> with ENSEMBL</h3>
<p>Users can also specify <code>db = &quot;ensembl&quot;</code> to retrieve available organisms provided by ENSEMBL. Again, users might experience a delay in the execution of this function when running it for the first time. This is due to the download of ENSEMBL information which is then stored internally to enable a much faster execution of this function in following runs. The corresponding information files are stored at <code>file.path(tempdir(), &quot;ensembl_summary.txt&quot;)</code>.</p>
</div>
<div id="example-ensembl-is.genome.available" class="section level3">
<h3>Example <code>ENSEMBL</code> (?is.genome.available):</h3>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1"><span class="co"># cheking whether Homo sapiens is available in the ENSEMBL database</span></a>
<a class="sourceLine" id="cb25-2" data-line-number="2"><span class="kw">is.genome.available</span>(<span class="dt">db =</span> <span class="st">&quot;ensembl&quot;</span>, <span class="dt">organism =</span> <span class="st">&quot;Homo sapiens&quot;</span>)</a></code></pre></div>
<pre><code>A reference or representative genome assembly is available for 'Homo sapiens'.
[1] TRUE</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1"><span class="co"># retrieve details for Homo sapiens</span></a>
<a class="sourceLine" id="cb27-2" data-line-number="2"><span class="kw">is.genome.available</span>(<span class="dt">db =</span> <span class="st">&quot;ensembl&quot;</span>, <span class="dt">organism =</span> <span class="st">&quot;Homo sapiens&quot;</span>, <span class="dt">details =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>  division taxon_id name    release display_name accession   strain_collecti…
  &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;     &lt;int&gt; &lt;chr&gt;        &lt;chr&gt;       &lt;chr&gt;           
1 Ensembl      9606 homo_s…      92 Human        GCA_000001… NA              
# ... with 3 more variables: common_name &lt;chr&gt;, strain &lt;chr&gt;, assembly &lt;chr&gt;</code></pre>
<p>Again, users can either specify the <code>taxid</code> or <code>accession id</code> when searching for organism entries.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1"><span class="co"># retrieve details for Homo sapiens using taxid</span></a>
<a class="sourceLine" id="cb29-2" data-line-number="2"><span class="kw">is.genome.available</span>(<span class="dt">db =</span> <span class="st">&quot;ensembl&quot;</span>, <span class="dt">organism =</span> <span class="st">&quot;9606&quot;</span>, <span class="dt">details =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>division taxon_id name    release display_name accession   strain_collecti…
  &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;     &lt;int&gt; &lt;chr&gt;        &lt;chr&gt;       &lt;chr&gt;           
1 Ensembl      9606 homo_s…      92 Human        GCA_000001… NA              
# ... with 3 more variables: common_name &lt;chr&gt;, strain &lt;chr&gt;, assembly &lt;chr&gt;
&gt; </code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1"><span class="co"># retrieve details for Homo sapiens using accession id</span></a>
<a class="sourceLine" id="cb31-2" data-line-number="2"><span class="kw">is.genome.available</span>(<span class="dt">organism =</span> <span class="st">&quot;GCA_000001405.27&quot;</span>, <span class="dt">db =</span> <span class="st">&quot;ensembl&quot;</span>, <span class="dt">details =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>  division taxon_id name    release display_name accession  strain_collecti…
  &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;     &lt;int&gt; &lt;chr&gt;        &lt;chr&gt;      &lt;chr&gt;           
1 Ensembl      9606 homo_s…      92 Human        GCA_00000… NA              
# ... with 3 more variables: common_name &lt;chr&gt;, strain &lt;chr&gt;, assembly &lt;chr&gt;</code></pre>
<p><strong>Please note that the <code>accession</code> id can change internally at ENSEMBL. E.g. in a recent case the <code>accession</code> id changed from <code>GCA_000001405.25</code> to <code>GCA_000001405.27</code>. Hence, please be careful and take this issue into account when you build automated retrieval scripts that are based on <code>accession</code> ids.</strong></p>
</div>
<div id="example-uniprot-is.genome.available" class="section level3">
<h3>Example <code>UniProt</code> (?is.genome.available):</h3>
<p>Users can also check the availability of proteomes in the <a href="http://www.uniprot.org">UniProt database</a> by specifying:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1"><span class="co"># retrieve information from UniProt</span></a>
<a class="sourceLine" id="cb33-2" data-line-number="2"><span class="kw">is.genome.available</span>(<span class="dt">db =</span> <span class="st">&quot;uniprot&quot;</span>, <span class="st">&quot;Homo sapiens&quot;</span>, <span class="dt">details =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<pre><code>A reference or representative genome assembly is available for 'Homo sapiens'.
[1] TRUE</code></pre>
<p>or with details:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1"><span class="co"># retrieve information from UniProt</span></a>
<a class="sourceLine" id="cb35-2" data-line-number="2"><span class="kw">is.genome.available</span>(<span class="dt">db =</span> <span class="st">&quot;uniprot&quot;</span>, <span class="st">&quot;Homo sapiens&quot;</span>, <span class="dt">details =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code> name   description isReferenceProt… isRepresentativ… dbReference component
* &lt;chr&gt;  &lt;chr&gt;       &lt;lgl&gt;            &lt;lgl&gt;            &lt;list&gt;      &lt;list&gt;   
1 Homo … Homo sapie… TRUE             TRUE             &lt;data.fram… &lt;data.fr…
# ... with 7 more variables: reference &lt;list&gt;, upid &lt;chr&gt;, modified &lt;dbl&gt;,
#   taxonomy &lt;int&gt;, source &lt;chr&gt;, sourceTaxonomy &lt;int&gt;, superregnum &lt;chr&gt;</code></pre>
<p>Users can also search available species at UniProt via <code>taxid</code> or <code>upid</code> id.</p>
<p>Here <code>9606</code> defines the taxonomy id for <code>Homo sapiens</code>.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1"><span class="co"># retrieve information from UniProt</span></a>
<a class="sourceLine" id="cb37-2" data-line-number="2"><span class="kw">is.genome.available</span>(<span class="dt">db =</span> <span class="st">&quot;uniprot&quot;</span>, <span class="st">&quot;9606&quot;</span>, <span class="dt">details =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code> name   description isReferenceProt… isRepresentativ… dbReference component
* &lt;chr&gt;  &lt;chr&gt;       &lt;lgl&gt;            &lt;lgl&gt;            &lt;list&gt;      &lt;list&gt;   
1 Homo … Homo sapie… TRUE             TRUE             &lt;data.fram… &lt;data.fr…
# ... with 7 more variables: reference &lt;list&gt;, upid &lt;chr&gt;, modified &lt;dbl&gt;,
#   taxonomy &lt;int&gt;, source &lt;chr&gt;, sourceTaxonomy &lt;int&gt;, superregnum &lt;chr&gt;</code></pre>
<p>Here <code>UP000005640</code> defines the <code>upid</code> for <code>Homo sapiens</code>.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1"><span class="co"># retrieve information from UniProt</span></a>
<a class="sourceLine" id="cb39-2" data-line-number="2"><span class="kw">is.genome.available</span>(<span class="dt">db =</span> <span class="st">&quot;uniprot&quot;</span>, <span class="st">&quot;UP000005640&quot;</span>, <span class="dt">details =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code> name   description isReferenceProt… isRepresentativ… dbReference component
* &lt;chr&gt;  &lt;chr&gt;       &lt;lgl&gt;            &lt;lgl&gt;            &lt;list&gt;      &lt;list&gt;   
1 Homo … Homo sapie… TRUE             TRUE             &lt;data.fram… &lt;data.fr…
# ... with 7 more variables: reference &lt;list&gt;, upid &lt;chr&gt;, modified &lt;dbl&gt;,
#   taxonomy &lt;int&gt;, source &lt;chr&gt;, sourceTaxonomy &lt;int&gt;, superregnum &lt;chr&gt;</code></pre>
<p>In general, the argument <code>db</code> specifies from which database (<code>refseq</code>, <code>genbank</code>, <code>ensembl</code> or <code>uniprot</code>) organism information shall be retrieved. Options are:</p>
<ul>
<li><code>db = 'refseq'</code></li>
<li><code>db = 'genbank'</code></li>
<li><code>db = 'ensembl'</code></li>
<li><code>db = 'uniprot'</code></li>
</ul>
</div>
<div id="listing-the-total-number-of-available-genomes" class="section level3">
<h3>Listing the total number of available genomes</h3>
<p>In some cases it might be useful to check how many genomes (in total) are available in the different databases.</p>
<p>Users can determine the total number of available genomes using the <code>listGenomes()</code> function.</p>
<p>Example <code>refseq</code>:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1"><span class="kw">length</span>(<span class="kw">listGenomes</span>(<span class="dt">db =</span> <span class="st">&quot;refseq&quot;</span>))</a></code></pre></div>
<pre><code>[1] 14264</code></pre>
<p>Example <code>genbank</code>:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1"><span class="kw">length</span>(<span class="kw">listGenomes</span>(<span class="dt">db =</span> <span class="st">&quot;genbank&quot;</span>))</a></code></pre></div>
<pre><code>[1] 21770</code></pre>
<p>Example <code>ensembl</code>:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" data-line-number="1"><span class="kw">length</span>(<span class="kw">listGenomes</span>(<span class="dt">db =</span> <span class="st">&quot;ensembl&quot;</span>))</a></code></pre></div>
<pre><code>[1] 113</code></pre>
<p>Hence, currently 14264 genomes (including all kingdoms of life) are stored on NCBI RefSeq (as of 31/05/2018).</p>
</div>
<div id="retrieving-kingdom-group-and-subgroup-information" class="section level3">
<h3>Retrieving kingdom, group and subgroup information</h3>
<p>Using this example users can retrieve the number of available species for each kingdom of life:</p>
<p>Example <code>refseq</code>:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" data-line-number="1"><span class="co"># the number of genomes available for each kingdom</span></a>
<a class="sourceLine" id="cb47-2" data-line-number="2"><span class="kw">listKingdoms</span>(<span class="dt">db =</span> <span class="st">&quot;refseq&quot;</span>)</a></code></pre></div>
<pre><code>    Archaea  Bacteria Eukaryota   Viroids   Viruses 
      169      6321       561        47      7166 </code></pre>
<p>Example <code>genbank</code>:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" data-line-number="1"><span class="co"># the number of genomes available for each kingdom</span></a>
<a class="sourceLine" id="cb49-2" data-line-number="2"><span class="kw">listKingdoms</span>(<span class="dt">db =</span> <span class="st">&quot;genbank&quot;</span>)</a></code></pre></div>
<pre><code>  Archaea  Bacteria Eukaryota 
     1249     18083      2438</code></pre>
<p>Example <code>ENSEMBL</code>:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" data-line-number="1"><span class="co"># the number of genomes available for each kingdom</span></a>
<a class="sourceLine" id="cb51-2" data-line-number="2"><span class="kw">listKingdoms</span>(<span class="dt">db =</span> <span class="st">&quot;ensembl&quot;</span>)</a></code></pre></div>
<pre><code>Ensembl 
    113</code></pre>
</div>
<div id="analogous-computations-can-be-performed-for-groups-and-subgroups" class="section level3">
<h3>Analogous computations can be performed for <code>groups</code> and <code>subgroups</code></h3>
<p>Unfortunately, <code>ENSEMBL</code> does not provide group or subgroup information. Therefore, group and subgroup listings are limited to <code>refseq</code> and <code>genbank</code>.</p>
<p>Example <code>refseq</code>:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" data-line-number="1"><span class="co"># the number of genomes available for each group</span></a>
<a class="sourceLine" id="cb53-2" data-line-number="2"><span class="kw">listGroups</span>(<span class="dt">db =</span> <span class="st">&quot;refseq&quot;</span>)</a></code></pre></div>
<pre><code>                 Abditibacteriota                                   Acidithiobacillia 
                                                  1                                                   5 
                                     Acidobacteriia                                    Ackermannviridae 
                                                 16                                                  21 
                                     Actinobacteria                                        Adenoviridae 
                                               1226                                                  62 
                                  Alloherpesviridae                                   Alphaflexiviridae 
                                                  8                                                  56 
                                Alphaproteobacteria                                   Alphasatellitidae 
                                                857                                                  67 
                                  Alphatetraviridae                                      Alvernaviridae 
                                                  3                                                   1 
                                      Amalgaviridae                                          Amphibians 
                                                 10                                                   3 
                                     Ampullaviridae                                       Anelloviridae 
                                                  3                                                  61 
                                      Apicomplexans                          Apple fruit crinkle viroid 
                                                 18                                                   1 
          Apple hammerhead viroid-like circular RNA                                         Apscaviroid 
                                                  1                                                  12 
                                          Aquificae                                        Archaeoglobi 
                                                  6                                                   3 
                                       Arenaviridae                                     Armatimonadetes 
                                                 37                                                   4 
                                      Arteriviridae                                         Ascomycetes 
                                                 13                                                  45 
                                        Ascoviridae                                        Asfarviridae 
                                                  4                                                   1 
                                        Aspiviridae                                        Astroviridae 
                                                  3                                                  40 
                                        Avsunviroid                                   Bacilladnaviridae 
                                                  1                                                   7 
                           Bacteria candidate phyla                        Bacteroidetes/Chlorobi group 
                                                  3                                                 654 
                                      Baculoviridae                                           Balneolia 
                                                 66                                                   4 
                                       Barnaviridae                                      Basidiomycetes 
                                                  1                                                   5 
                                        Benyviridae                                    Betaflexiviridae 
                                                  3                                                  92 
                                 Betaproteobacteria                                      Bicaudaviridae 
                                                407                                                   4 
                                              Birds                                        Birnaviridae 
                                                 54                                                   8 
                                     Blastocatellia                                        Bornaviridae 
                                                  1                                                   5 
                                       Bromoviridae                                       Caliciviridae 
                                                 35                                                  26 
                               Candidatus Kryptonia                            Candidatus Micrarchaeota 
                                                  3                                                   1 
                           Candidatus Tectomicrobia                                   Carmotetraviridae 
                                                  1                                                   1 
                                     Caulimoviridae Cherry leaf scorch small circular viroid-like RNA 1 
                                                 67                                                   1 
              Cherry small circular viroid-like RNA                                          Chlamydiae 
                                                  1                                                  19 
                                        Chloroflexi                                       Chrysoviridae 
                                                 23                                                   9 
                                       Circoviridae                                     Closteroviridae 
                                                148                                                  40 
                                        Cocadviroid                                          Coleviroid 
                                                  4                                                   6 
                               Coprothermobacterota                                       Coronaviridae 
                                                  1                                                  47 
                                     Corticoviridae                                       Crenarchaeota 
                                                  1                                                   9 
                Cyanobacteria/Melainabacteria group                                        Cystoviridae 
                                                 22                                                   5 
                                Deinococcus-Thermus                          delta/epsilon subdivisions 
                                                 23                                                 142 
                                  Deltaflexiviridae                                     Dicistroviridae 
                                                  1                                                  27 
                                          Elaviroid                                        Endomicrobia 
                                                  1                                                   2 
                                     Endornaviridae                                       Fibrobacteres 
                                                 29                                                   2 
                                        Filoviridae                                         Fimoviridae 
                                                  7                                                   6 
                                         Firmicutes                                              Fishes 
                                               1378                                                  52 
                                          Flatworms                                        Flaviviridae 
                                                  4                                                 107 
                                      Fusariviridae                                      Fuselloviridae 
                                                  7                                                  10 
                                      Fusobacteriia                                   Gammaflexiviridae 
                                                 20                                                   1 
                                Gammaproteobacteria                                       Geminiviridae 
                                               1285                                                 406 
                                   Gemmatimonadetes                                       Genomoviridae 
                                                  2                                                  62 
                                     Globuloviridae                             Grapevine latent viroid 
                                                  2                                                   1 
                                        Green Algae                                        Guttaviridae 
                                                  8                                                   1 
                                       Halobacteria                                        Hantaviridae 
                                                 80                                                  24 
                                     Hepadnaviridae                                         Hepeviridae 
                                                 16                                                   3 
                                      Herpesviridae                                         Hostuviroid 
                                                 72                                                   2 
                                  Hydrogenophilalia                                         Hypoviridae 
                                                  1                                                  15 
                                     Hytrosaviridae                                         Iflaviridae 
                                                  2                                                  34 
                                         Inoviridae                                             Insects 
                                                 42                                                 110 
                                       Iridoviridae                                        Kinetoplasts 
                                                 20                                                   5 
                                 Kiritimatiellaeota                                         Land Plants 
                                                  1                                                  80 
                                      Lavidaviridae                                       Lentisphaerae 
                                                  2                                                   1 
                                        Leviviridae                                    Lipothrixviridae 
                                                 11                                                   8 
                                       Luteoviridae                                 Malacoherpesviridae 
                                                 48                                                   2 
                                            Mammals                                        Marnaviridae 
                                                100                                                   1 
                                   Marseilleviridae                                    Megabirnaviridae 
                                                  6                                                   3 
                                      Mesoniviridae                                     Methanobacteria 
                                                  7                                                  18 
                                       Methanococci                                     Methanomicrobia 
                                                  2                                                  21 
                              Methanonatronarchaeia                                        Microviridae 
                                                  1                                                  42 
                                        Mimiviridae           Mulberry small circular viroid-like RNA 1 
                                                  5                                                   1 
                                      Mymonaviridae                                          Myoviridae 
                                                  1                                                 516 
                                       Nairoviridae                                         Nanoviridae 
                                                 13                                                   8 
                                       Narnaviridae                                         Nimaviridae 
                                                 39                                                   1 
                                         Nitrospira                                         Nodaviridae 
                                                 10                                                  15 
                                        Nudiviridae                                        Nyamiviridae 
                                                  5                                                   4 
                                        Oligoflexia                                    Orthomyxoviridae 
                                                  3                                                   6 
                                              Other                                       Other Animals 
                                                988                                                  35 
                                        Other Fungi                                      Other Protists 
                                                  3                                                  16 
                                   Papillomaviridae                                     Paramyxoviridae 
                                                134                                                  54 
                                     Partitiviridae                                        Parvoviridae 
                                                 55                                                  90 
                                       Pelamoviroid                                    Peribunyaviridae 
                                                  2                                                  32 
                                Permutotetraviridae                                    Persimmon viroid 
                                                  1                                                   1 
                                      Phasmaviridae                                       Phenuiviridae 
                                                  4                                                  28 
                                    Phycodnaviridae                                    Picobirnaviridae 
                                                 26                                                   5 
                                     Picornaviridae                                        Pithoviridae 
                                                104                                                   2 
                                     Planctomycetes                                       Plasmaviridae 
                                                 18                                                   1 
                                    Pleolipoviridae                                       Pneumoviridae 
                                                  8                                                   7 
                                        Podoviridae                                     Polycipiviridae 
                                                343                                                   6 
                                     Polydnaviridae                                      Polyomaviridae 
                                                  5                                                  83 
                                        Pospiviroid                                         Potyviridae 
                                                 11                                                 146 
                                         Poxviridae                                       Quadriviridae 
                                                 47                                                   1 
                                         Reoviridae                                            Reptiles 
                                                 67                                                  11 
                                       Retroviridae                                       Rhabdoviridae 
                                                 52                                                 150 
                                       Rhodothermia                                         Roniviridae 
                                                  4                                                   1 
                                         Roundworms                            Rubber viroid India/2009 
                                                  8                                                   1 
                                        Rudiviridae                                         Secoviridae 
                                                 15                                                  53 
                                       Siphoviridae                                       Solemoviridae 
                                               1061                                                  20 
                                       Solibacteres                                      Solinviviridae 
                                                  3                                                   2 
                                 Sphaerolipoviridae                                        Spirochaetia 
                                                  7                                                  39 
                                         Sunviridae                                         Synergistia 
                                                  1                                                   4 
                                       Tectiviridae                                         Tenericutes 
                                                  5                                                  69 
                                     Thaumarchaeota                                         Thermococci 
                                                  8                                                  19 
                              Thermodesulfobacteria                                      Thermoplasmata 
                                                  4                                                   7 
                                        Thermotogae                                         Togaviridae 
                                                 10                                                  24 
                                 Tolecusatellitidae                                       Tombusviridae 
                                                101                                                  68 
                                       Tospoviridae                                         Totiviridae 
                                                 17                                                  66 
                                   Tristromaviridae                                        Turriviridae 
                                                  1                                                   2 
                                        Tymoviridae                                        unclassified 
                                                 37                                                 606 
                         unclassified Acidobacteria               unclassified Bacteria (miscellaneous) 
                                                  1                                                  13 
                           unclassified Nitrospirae                         unclassified Proteobacteria 
                                                  1                                                   2 
                                    Verrucomicrobia                                        Virgaviridae 
                                                 25                                                  52 
                                 Zetaproteobacteria 
                                                  5 </code></pre>
<p>Example <code>genbank</code>:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" data-line-number="1"><span class="co"># the number of genomes available for each group</span></a>
<a class="sourceLine" id="cb55-2" data-line-number="2"><span class="kw">listGroups</span>(<span class="dt">db =</span> <span class="st">&quot;genbank&quot;</span>)</a></code></pre></div>
<pre><code>                       Abditibacteriota                       Acidithiobacillia 
                                      1                                       8 
                         Acidobacteriia                          Actinobacteria 
                                     24                                    1596 
                    Alphaproteobacteria                              Amphibians 
                                   1604                                       6 
                          Apicomplexans                               Aquificae 
                                     47                                       7 
                           Archaeoglobi                         Armatimonadetes 
                                      5                                      38 
                            Ascomycetes                Bacteria candidate phyla 
                                    689                                    3532 
           Bacteroidetes/Chlorobi group                               Balneolia 
                                   2247                                      44 
                         Basidiomycetes                      Betaproteobacteria 
                                    204                                     751 
                                  Birds                          Blastocatellia 
                                     80                                       2 
                           Caldisericia                  candidate division WS1 
                                      1                                       1 
        candidate division Zixibacteria               Candidatus Aegiribacteria 
                                     17                                       1 
             Candidatus Aenigmarchaeota               Candidatus Bathyarchaeota 
                                     14                                      42 
               Candidatus Cloacimonetes               Candidatus Diapherotrites 
                                     88                                      11 
            Candidatus Fermentibacteria            Candidatus Geothermarchaeota 
                                      8                                       3 
           Candidatus Heimdallarchaeota              Candidatus Hydrogenedentes 
                                      4                                      10 
                Candidatus Korarchaeota                    Candidatus Kryptonia 
                                      1                                       4 
        Candidatus Lambdaproteobacteria              Candidatus Latescibacteria 
                                      6                                      13 
               Candidatus Lokiarchaeota               Candidatus Marinimicrobia 
                                      2                                      92 
               Candidatus Marsarchaeota                Candidatus Micrarchaeota 
                                     15                                      35 
                Candidatus Moduliflexus             Candidatus Muproteobacteria 
                                      1                                      14 
           Candidatus Nanohaloarchaeota                Candidatus Odinarchaeota 
                                     16                                       1 
                Candidatus Omnitrophica                Candidatus Pacearchaeota 
                                    126                                      41 
               Candidatus Parvarchaeota                Candidatus Tectomicrobia 
                                     11                                       6 
               Candidatus Thorarchaeota                 Candidatus Vecturithrix 
                                      7                                       1 
         Candidatus Verstraetearchaeota               Candidatus Woesearchaeota 
                                      5                                      36 
                             Chlamydiae                             Chloroflexi 
                                     43                                     403 
                         Chrysiogenetes                    Coprothermobacterota 
                                      1                                       1 
                          Crenarchaeota     Cyanobacteria/Melainabacteria group 
                                     54                                     172 
                        Deferribacteres                     Deinococcus-Thermus 
                                      8                                      27 
             delta/epsilon subdivisions                            Dictyoglomia 
                                    615                                       1 
                          Elusimicrobia                            Endomicrobia 
                                      1                                       2 
                  environmental samples                           Fibrobacteres 
                                      3                                      15 
                             Firmicutes                                  Fishes 
                                   2663                                     168 
                              Flatworms                           Fusobacteriia 
                                     35                                      29 
                    Gammaproteobacteria                        Gemmatimonadetes 
                                   2041                                      82 
                            Green Algae                            Hadesarchaea 
                                     30                                       5 
                           Halobacteria                              Holophagae 
                                    162                                       9 
                      Hydrogenophilalia                                 Insects 
                                     32                                     280 
                           Kinetoplasts                      Kiritimatiellaeota 
                                     33                                       3 
                            Land Plants                           Lentisphaerae 
                                    282                                      32 
                                Mammals                         Methanobacteria 
                                    145                                      31 
                           Methanococci                         Methanomicrobia 
                                      2                                      77 
                  Methanonatronarchaeia                             Methanopyri 
                                      2                                       1 
                          Nanoarchaeota nitrifying bacterium enrichment culture 
                                     11                                       1 
                            Nitrospinae                              Nitrospira 
                                     19                                      31 
                            Oligoflexia                                   Other 
                                     87                                      15 
                          Other Animals                             Other Fungi 
                                    125                                      58 
                           Other Plants                          Other Protists 
                                      1                                     128 
                         Planctomycetes                                Reptiles 
                                    171                                      21 
                           Rhodothermia                              Roundworms 
                                      4                                      91 
                           Solibacteres                            Spirochaetia 
                                      7                                     115 
                            Synergistia                             Tenericutes 
                                     43                                     141 
                         Thaumarchaeota                           Theionarchaea 
                                     92                                       2 
                            Thermococci                   Thermodesulfobacteria 
                                     21                                       7 
                         Thermoplasmata                             Thermotogae 
                                    135                                      23 
             unclassified Acidobacteria    unclassified Archaea (miscellaneous) 
                                     94                                      52 
  unclassified Bacteria (miscellaneous)                unclassified Caldiserica 
                                    197                                      11 
           unclassified Calditrichaeota              unclassified Elusimicrobia 
                                      2                                     101 
             unclassified Euryarchaeota                unclassified Nitrospirae 
                                    348                                      90 
            unclassified Proteobacteria            unclassified Rhodothermaeota 
                                    130                                       4 
              unclassified Spirochaetes              unclassified Synergistetes 
                                     37                                       3 
               unclassified Thermotogae                     uncultured archaeon 
                                      1                                       1 
            uncultured archaeon A07HB70             uncultured archaeon A07HN63 
                                      1                                       1 
            uncultured archaeon A07HR60             uncultured archaeon A07HR67 
                                      1                                       1 
                   uncultured bacterium                         Verrucomicrobia 
                                      1                                     296 
                     Zetaproteobacteria 
                                     41 </code></pre>
<p><strong>Note</strong> that when running the <code>listGenomes()</code> function for the first time, it might take a while until the function returns any results, because necessary information need to be downloaded from NCBI and ENSEMBL databases. All subsequent executions of <code>listGenomes()</code> will then respond very fast, because they will access the corresponding files stored on your hard drive.</p>
</div>
</div>
<div id="downloading-biological-sequences-and-annotations" class="section level2">
<h2>Downloading Biological Sequences and Annotations</h2>
<p>After checking for the availability of sequence information for an organism of interest, the next step is to download the corresponding genome, proteome, CDS, or GFF file. The following functions allow users to download proteomes, genomes, CDS and GFF files from several database resources such as: <a href="http://www.ncbi.nlm.nih.gov/refseq/about/">NCBI RefSeq</a>, <a href="http://www.ncbi.nlm.nih.gov/genbank/about/">NCBI Genbank</a>, <a href="http://www.ensembl.org/index.html">ENSEMBL</a>. When a corresponding proteome, genome, CDS or GFF file was loaded to your hard-drive, a documentation <code>*.txt</code> file is generated storing <code>File Name</code>, <code>Organism</code>, <code>Database</code>, <code>URL</code>, <code>DATE</code>, <code>assembly_accession</code>, <code>bioproject</code>, <code>biosample</code>, <code>taxid</code>, <code>version_status</code>, <code>release_type</code>, <code>seq_rel_date</code> etc. information of the retrieved file. This way a better reproducibility of proteome, genome, CDS and GFF versions used for subsequent data analyses can be achieved.</p>
<div id="genome-retrieval" class="section level3">
<h3>Genome Retrieval</h3>
<p>The easiest way to download a genome is to use the <code>getGenome()</code> function.</p>
<p>In this example we will download the genome of <code>Homo sapiens</code>.</p>
<p>The <code>getGenome()</code> function is an interface function to the <a href="http://www.ncbi.nlm.nih.gov/refseq/about/">NCBI RefSeq</a>, <a href="http://www.ncbi.nlm.nih.gov/genbank/about/">NCBI Genbank</a>, <a href="http://www.ensembl.org/index.html">ENSEMBL</a> databases from which corresponding genomes can be retrieved.</p>
<p>The <code>db</code> argument specifies from which database genome assemblies in <code>*.fasta</code> file format shall be retrieved.</p>
<p>Options are:</p>
<ul>
<li><code>db = &quot;refseq&quot;</code> for retrieval from <a href="http://www.ncbi.nlm.nih.gov/refseq/about/">NCBI RefSeq</a></li>
<li><code>db = &quot;genbank&quot;</code> for retrieval from <a href="http://www.ncbi.nlm.nih.gov/genbank/about/">NCBI Genbank</a></li>
<li><code>db = &quot;ensembl&quot;</code> for retrieval from <a href="http://www.ensembl.org/index.html">ENSEMBL</a></li>
</ul>
<p>Furthermore, users need to specify the <code>scientific name</code>, the <code>taxid</code> (= <a href="https://www.ncbi.nlm.nih.gov/taxonomy">NCBI Taxnonomy</a> identifier), or the <code>accession identifier</code> of the organism of interest for which a genome assembly shall be downloaded, e.g. <code>organism = &quot;Homo sapiens&quot;</code> or <code>organism = &quot;9606&quot;</code> or <code>organism = &quot;GCF_000001405.37&quot;</code>. Finally, the <code>path</code> argument specifies the folder path in which the corresponding assembly shall be locally stored. In case users would like to store the genome file at a different location, they can specify the <code>path = file.path(&quot;put&quot;,&quot;your&quot;,&quot;path&quot;,&quot;here&quot;)</code> argument (e.g. <code>file.path(&quot;_ncbi_downloads&quot;,&quot;genomes&quot;)</code>).</p>
</div>
<div id="example-ncbi-refseq" class="section level3">
<h3>Example NCBI RefSeq:</h3>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" data-line-number="1"><span class="co"># download the genome of Homo sapiens from refseq</span></a>
<a class="sourceLine" id="cb57-2" data-line-number="2"><span class="co"># and store the corresponding genome file in '_ncbi_downloads/genomes'</span></a>
<a class="sourceLine" id="cb57-3" data-line-number="3">HS.genome.refseq &lt;-<span class="st"> </span><span class="kw">getGenome</span>( <span class="dt">db       =</span> <span class="st">&quot;refseq&quot;</span>, </a>
<a class="sourceLine" id="cb57-4" data-line-number="4">                               <span class="dt">organism =</span> <span class="st">&quot;Homo sapiens&quot;</span>,</a>
<a class="sourceLine" id="cb57-5" data-line-number="5">                               <span class="dt">path     =</span> <span class="kw">file.path</span>(<span class="st">&quot;_ncbi_downloads&quot;</span>,<span class="st">&quot;genomes&quot;</span>) )</a></code></pre></div>
<p>In this example, <code>getGenome()</code> creates a directory named <code>'_ncbi_downloads/genomes'</code> into which the corresponding genome named <code>GCF_000001405.34_GRCh38.p8_genomic.fna.gz</code> is downloaded. The return value of <code>getGenome()</code> is the folder path to the downloaded genome file that can then be used as input to the <code>read_genome()</code> function. The variable <code>HS.genome.refseq</code> stores the path to the downloaded genome.</p>
<p>Users can also omit the <code>path</code> argument if they wish to store the genome in their current working directory. E.g.:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" data-line-number="1"><span class="co"># download the genome of Homo sapiens from refseq</span></a>
<a class="sourceLine" id="cb58-2" data-line-number="2"><span class="co"># and store the corresponding genome file in '_ncbi_downloads/genomes'</span></a>
<a class="sourceLine" id="cb58-3" data-line-number="3">HS.genome.refseq &lt;-<span class="st"> </span><span class="kw">getGenome</span>( <span class="dt">db       =</span> <span class="st">&quot;refseq&quot;</span>, </a>
<a class="sourceLine" id="cb58-4" data-line-number="4">                               <span class="dt">organism =</span> <span class="st">&quot;Homo sapiens&quot;</span>)</a></code></pre></div>
<p>Subsequently, users can use the <code>read_genome()</code> function to import the genome into the R session. Users can choose to work with the genome sequence in R either as <a href="http://bioconductor.org/packages/release/bioc/html/Biostrings.html">Biostrings</a> object (<code>obj.type = &quot;Biostrings&quot;</code>) or <a href="https://github.com/Rdatatable/data.table/wiki">data.table</a> object (<code>obj.type = &quot;data.table&quot;</code>) by specifying the <code>obj.type</code> argument of the <code>read_genome()</code> function.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" data-line-number="1"><span class="co"># import downloaded genome as Biostrings object</span></a>
<a class="sourceLine" id="cb59-2" data-line-number="2">Human_Genome &lt;-<span class="st"> </span><span class="kw">read_genome</span>(<span class="dt">file =</span> HS.genome.refseq)</a></code></pre></div>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" data-line-number="1"><span class="co"># look at the Biostrings object</span></a>
<a class="sourceLine" id="cb60-2" data-line-number="2">Human_Genome</a></code></pre></div>
<pre><code>  A DNAStringSet instance of length 551
          width seq                                                names               
  [1] 248956422 NNNNNNNNNNNNNNNNNNNNNNNN...NNNNNNNNNNNNNNNNNNNNNNN NC_000001.11 Homo...
  [2]    175055 GAATTCAGCTGAGAAGAACAGGCA...TGTTTGTCAGTCACATAGAATTC NT_187361.1 Homo ...
  [3]     32032 AGGGGTCTGCTTAGAGAGGGTCTC...TGACTTACGTTGACGTGGAATTC NT_187362.1 Homo ...
  [4]    127682 GATCGAGACTATCCTGGCTAACAC...ATTGTCAATTGGGACCTTTGATC NT_187363.1 Homo ...
  [5]     66860 GAATTCATTCGATGACGATTCCAT...AAAAAACTCTCAGCCACGAATTC NT_187364.1 Homo ...
  ...       ... ...
[547]    170148 TTTCTTTCTTTTTTTTTTTTTTGT...GTCACAGGACTCATGGGGAATTC NT_187685.1 Homo ...
[548]    215732 TGTGGTGAGGACCCTTAAGATCTA...GTCACAGGACTCATGGGGAATTC NT_187686.1 Homo ...
[549]    170537 TCTACTCTCCCATGCTTGCCTCGG...GTCACAGGACTCATGGGGAATTC NT_187687.1 Homo ...
[550]    177381 GATCTATCTGTATCTCCACAGGTG...GTCACAGGACTCATGGGGAATTC NT_113949.2 Homo ...
[551]     16569 GATCACAGGTCTATCACCCTATTA...CCCTTAAATAAGACATCACGATG NC_012920.1 Homo ...</code></pre>
<p>Internally, a text file named <code>doc_Homo_sapiens_db_refseq.txt</code> is generated. The information stored in this log file is structured as follows:</p>
<pre><code>File Name: Homo_sapiens_genomic_refseq.fna.gz
Organism Name: Homo_sapiens
Database: NCBI refseq
URL: ftp://ftp.ncbi.nlm.nih.gov/genomes/all/GCF/000/001/405/
GCF_000001405.35_GRCh38.p9/GCF_000001405.35_GRCh38.p9_genomic.fna.gz
Download_Date: Sat Oct 22 12:41:07 2016
refseq_category: reference genome
assembly_accession: GCF_000001405.35
bioproject: PRJNA168
biosample: NA
taxid: 9606
infraspecific_name: NA
version_status: latest
release_type: Patch
genome_rep: Full
seq_rel_date: 2016-09-26
submitter: Genome Reference Consortium</code></pre>
<p>In addition, the genome summary statistics for the retrieved species is stored locally (<code>doc_Homo_sapiens_db_refseq_summary_statistics.tsv</code>) to provide users with insights regarding the genome assembly quality (see <code>?summary_genome()</code> for details). This file can be used as <code>Supplementary Information</code> file in publications to facilitate reproducible research. Most comparative genomics studies do not consider differences in genome assembly qualities when comparing the genomes of diverse species. This way, they expose themselves to technical artifacts that might generate patterns mistaken to be of biological relevance whereas in reality they just reflect the difference in genome assembly quality. Considering the quality of genome assemblies when downloading the genomic sequences will help researchers to avoid these pitfalls.</p>
<p>The summary statistics include:</p>
<ul>
<li><p><code>genome_size_mbp</code>: Genome size in mega base pairs</p></li>
<li><p><code>n50_mbp</code>: The N50 contig size of the genome assembly in mega base pairs</p></li>
<li><p><code>n_seqs</code>: The number of chromosomes/scaffolds/contigs of the genome assembly file</p></li>
<li><p><code>n_nnn</code>: The absolute number of NNNs (over all chromosomes or scaffolds or contigs) in the genome assembly file</p></li>
<li><p><code>rel_nnn</code>: The percentage (relative frequency) of NNNs (over all chromosomes or scaffolds or contigs) compared to the total number of nucleotides in the genome assembly file</p></li>
<li><p><code>genome_entropy</code>: The Shannon Entropy of the genome assembly file (median entropy over all individual chromosome entropies)</p></li>
<li><p><code>n_gc</code>: The total number of GCs (over all chromosomes or scaffolds or contigs) in the genome assembly file</p></li>
<li><p><code>rel_gc</code>: The (relative frequency) of GCs (over all chromosomes or scaffolds or contigs) compared to the total number of nucleotides in the genome assembly file</p></li>
</ul>
<p>In summary, the <code>getGenome()</code> and <code>read_genome()</code> functions allow users to retrieve genome assemblies by specifying the scientific name of the organism of interest and allow them to import the retrieved genome assembly e.g. as <code>Biostrings</code> object. Thus, users can then perform the <code>Biostrings notation</code> to work with downloaded genomes and can rely on the log file generated by <code>getGenome()</code> to better document the source and version of genome assemblies used for subsequent studies.</p>
<p>Alternatively, users can perform the pipeline logic of the <a href="https://github.com/smbache/magrittr">magrittr</a> package:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" data-line-number="1"><span class="co"># install.packages(&quot;magrittr&quot;)</span></a>
<a class="sourceLine" id="cb63-2" data-line-number="2"><span class="kw">library</span>(magrittr)</a>
<a class="sourceLine" id="cb63-3" data-line-number="3"><span class="co"># import genome as Biostrings object</span></a>
<a class="sourceLine" id="cb63-4" data-line-number="4">Human_Genome &lt;-<span class="st"> </span><span class="kw">getGenome</span>( <span class="dt">db       =</span> <span class="st">&quot;refseq&quot;</span>, </a>
<a class="sourceLine" id="cb63-5" data-line-number="5">                           <span class="dt">organism =</span> <span class="st">&quot;Homo sapiens&quot;</span>,</a>
<a class="sourceLine" id="cb63-6" data-line-number="6">                           <span class="dt">path     =</span> <span class="kw">file.path</span>(<span class="st">&quot;_ncbi_downloads&quot;</span>,<span class="st">&quot;genomes&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb63-7" data-line-number="7"><span class="st">    </span><span class="kw">read_genome</span>()</a></code></pre></div>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" data-line-number="1">Human_Genome</a></code></pre></div>
<pre><code>  A DNAStringSet instance of length 551
          width seq                                                names               
  [1] 248956422 NNNNNNNNNNNNNNNNNNNNNNNN...NNNNNNNNNNNNNNNNNNNNNNN NC_000001.11 Homo...
  [2]    175055 GAATTCAGCTGAGAAGAACAGGCA...TGTTTGTCAGTCACATAGAATTC NT_187361.1 Homo ...
  [3]     32032 AGGGGTCTGCTTAGAGAGGGTCTC...TGACTTACGTTGACGTGGAATTC NT_187362.1 Homo ...
  [4]    127682 GATCGAGACTATCCTGGCTAACAC...ATTGTCAATTGGGACCTTTGATC NT_187363.1 Homo ...
  [5]     66860 GAATTCATTCGATGACGATTCCAT...AAAAAACTCTCAGCCACGAATTC NT_187364.1 Homo ...
  ...       ... ...
[547]    170148 TTTCTTTCTTTTTTTTTTTTTTGT...GTCACAGGACTCATGGGGAATTC NT_187685.1 Homo ...
[548]    215732 TGTGGTGAGGACCCTTAAGATCTA...GTCACAGGACTCATGGGGAATTC NT_187686.1 Homo ...
[549]    170537 TCTACTCTCCCATGCTTGCCTCGG...GTCACAGGACTCATGGGGAATTC NT_187687.1 Homo ...
[550]    177381 GATCTATCTGTATCTCCACAGGTG...GTCACAGGACTCATGGGGAATTC NT_113949.2 Homo ...
[551]     16569 GATCACAGGTCTATCACCCTATTA...CCCTTAAATAAGACATCACGATG NC_012920.1 Homo ...</code></pre>
<div id="use-taxid-id-for-genome-retrieval" class="section level4">
<h4>Use <code>taxid</code> id for genome retrieval</h4>
<p>Alternatively, instead of specifying the scientific name in the argument <code>organism</code> users can specify the <code>taxonomy</code> id of the corresponding organism. Here, we specify the taxonomy id <code>559292</code> which encodes the species <code>Saccharomyces cerevisiae</code>.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" data-line-number="1"><span class="co"># install.packages(&quot;magrittr&quot;)</span></a>
<a class="sourceLine" id="cb66-2" data-line-number="2"><span class="kw">library</span>(magrittr)</a>
<a class="sourceLine" id="cb66-3" data-line-number="3"><span class="co"># import genome as Biostrings object</span></a>
<a class="sourceLine" id="cb66-4" data-line-number="4">Scerevisiae_Genome &lt;-<span class="st"> </span><span class="kw">getGenome</span>(</a>
<a class="sourceLine" id="cb66-5" data-line-number="5">            <span class="dt">db       =</span> <span class="st">&quot;refseq&quot;</span>,</a>
<a class="sourceLine" id="cb66-6" data-line-number="6">            <span class="dt">organism =</span> <span class="st">&quot;559292&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb66-7" data-line-number="7"><span class="st">    </span><span class="kw">read_genome</span>()</a></code></pre></div>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" data-line-number="1">Scerevisiae_Genome</a></code></pre></div>
<pre><code>A DNAStringSet instance of length 17
       width seq                                      names               
 [1]  230218 CCACACCACACCCACACAC...GGGTGTGGTGTGTGTGGG NC_001133.9 Sacch...
 [2]  813184 AAATAGCCCTCATGTACGT...TGTGGTGTGTGGGTGTGT NC_001134.8 Sacch...
 [3]  316620 CCCACACACCACACCCACA...GTGGGTGTGGTGTGTGTG NC_001135.5 Sacch...
 [4] 1531933 ACACCACACCCACACCACA...GTAGTAAGTAGCTTTTGG NC_001136.10 Sacc...
 [5]  576874 CGTCTCCTCCAAGCCCTGT...ATTTTCATTTTTTTTTTT NC_001137.3 Sacch...
 ...     ... ...
[13]  924431 CCACACACACACCACACCC...TGTGGTGTGTGTGTGGGG NC_001145.3 Sacch...
[14]  784333 CCGGCTTTCTGACCGAAAT...TGTGGGTGTGGTGTGGGT NC_001146.8 Sacch...
[15] 1091291 ACACCACACCCACACCACA...TGTGTGGGTGTGGTGTGT NC_001147.6 Sacch...
[16]  948066 AAATAGCCCTCATGTACGT...TTTAATTTCGGTCAGAAA NC_001148.4 Sacch...
[17]   85779 TTCATAATTAATTTTTTAT...TATAATATAATATCCATA NC_001224.1 Sacch...</code></pre>
</div>
<div id="use-assembly_accession-id-for-genome-retrieval" class="section level4">
<h4>Use <code>assembly_accession</code> id for genome retrieval</h4>
<p>Alternatively, instead of specifying the scientific name or taxonomy in the argument <code>organism</code> users can specify the <code>assembly_accession</code> id of the corresponding organism. Here, we specify the <code>assembly_accession</code> id <code>GCF_000146045.2</code> which encodes the species <code>Saccharomyces cerevisiae</code>.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" data-line-number="1"><span class="co"># install.packages(&quot;magrittr&quot;)</span></a>
<a class="sourceLine" id="cb69-2" data-line-number="2"><span class="kw">library</span>(magrittr)</a>
<a class="sourceLine" id="cb69-3" data-line-number="3"><span class="co"># import genome as Biostrings object</span></a>
<a class="sourceLine" id="cb69-4" data-line-number="4">Scerevisiae_Genome &lt;-<span class="st"> </span><span class="kw">getGenome</span>(</a>
<a class="sourceLine" id="cb69-5" data-line-number="5">            <span class="dt">db       =</span> <span class="st">&quot;refseq&quot;</span>,</a>
<a class="sourceLine" id="cb69-6" data-line-number="6">            <span class="dt">organism =</span> <span class="st">&quot;GCF_000146045.2&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb69-7" data-line-number="7"><span class="st">    </span><span class="kw">read_genome</span>()</a></code></pre></div>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" data-line-number="1">Scerevisiae_Genome</a></code></pre></div>
<pre><code> A DNAStringSet instance of length 17
       width seq                                                    names               
 [1]  230218 CCACACCACACCCACACACCCACACA...GTGGTGTGGGTGTGGTGTGTGTGGG NC_001133.9 Sacch...
 [2]  813184 AAATAGCCCTCATGTACGTCTCCTCC...GTGTGGGTGTGGTGTGTGGGTGTGT NC_001134.8 Sacch...
 [3]  316620 CCCACACACCACACCCACACCACACC...GGGTGTGGTGGGTGTGGTGTGTGTG NC_001135.5 Sacch...
 [4] 1531933 ACACCACACCCACACCACACCCACAC...AATAAAGGTAGTAAGTAGCTTTTGG NC_001136.10 Sacc...
 [5]  576874 CGTCTCCTCCAAGCCCTGTTGTCTCT...GGGTTTCATTTTCATTTTTTTTTTT NC_001137.3 Sacch...
 ...     ... ...
[13]  924431 CCACACACACACCACACCCACACCAC...GTGTGGGTGTGGTGTGTGTGTGGGG NC_001145.3 Sacch...
[14]  784333 CCGGCTTTCTGACCGAAATTAAAAAA...GGGTGTGTGTGGGTGTGGTGTGGGT NC_001146.8 Sacch...
[15] 1091291 ACACCACACCCACACCACACCCACAC...GAGAGAGTGTGTGGGTGTGGTGTGT NC_001147.6 Sacch...
[16]  948066 AAATAGCCCTCATGTACGTCTCCTCC...TTTTTTTTTTAATTTCGGTCAGAAA NC_001148.4 Sacch...
[17]   85779 TTCATAATTAATTTTTTATATATATA...GCTTAATTATAATATAATATCCATA NC_001224.1 Sacch...</code></pre>
</div>
</div>
<div id="example-ncbi-genbank" class="section level3">
<h3>Example NCBI Genbank:</h3>
<p>Genome retrieval from <code>NCBI Genbank</code>.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" data-line-number="1"><span class="co"># download the genome of Homo sapiens from Genbank</span></a>
<a class="sourceLine" id="cb72-2" data-line-number="2"><span class="co"># and store the corresponding genome file in '_ncbi_downloads/genomes'</span></a>
<a class="sourceLine" id="cb72-3" data-line-number="3">HS.genome.genbank &lt;-<span class="st"> </span><span class="kw">getGenome</span>( <span class="dt">db       =</span> <span class="st">&quot;genbank&quot;</span>, </a>
<a class="sourceLine" id="cb72-4" data-line-number="4">                                <span class="dt">organism =</span> <span class="st">&quot;Homo sapiens&quot;</span>,</a>
<a class="sourceLine" id="cb72-5" data-line-number="5">                                <span class="dt">path     =</span> <span class="kw">file.path</span>(<span class="st">&quot;_ncbi_downloads&quot;</span>,<span class="st">&quot;genomes&quot;</span>) )</a></code></pre></div>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" data-line-number="1"><span class="co"># import downloaded genome as Biostrings object</span></a>
<a class="sourceLine" id="cb73-2" data-line-number="2">Human_Genome &lt;-<span class="st"> </span><span class="kw">read_genome</span>(<span class="dt">file =</span> HS.genome.genbank)</a></code></pre></div>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" data-line-number="1"><span class="co"># look at the Biostrings object</span></a>
<a class="sourceLine" id="cb74-2" data-line-number="2">Human_Genome</a></code></pre></div>
<pre><code>  A DNAStringSet instance of length 551
          width seq                                                names               
  [1] 248956422 NNNNNNNNNNNNNNNNNNNNNNNN...NNNNNNNNNNNNNNNNNNNNNNN CM000663.2 Homo s...
  [2]    175055 GAATTCAGCTGAGAAGAACAGGCA...TGTTTGTCAGTCACATAGAATTC KI270706.1 Homo s...
  [3]     32032 AGGGGTCTGCTTAGAGAGGGTCTC...TGACTTACGTTGACGTGGAATTC KI270707.1 Homo s...
  [4]    127682 GATCGAGACTATCCTGGCTAACAC...ATTGTCAATTGGGACCTTTGATC KI270708.1 Homo s...
  [5]     66860 GAATTCATTCGATGACGATTCCAT...AAAAAACTCTCAGCCACGAATTC KI270709.1 Homo s...
  ...       ... ...
[547]    170148 TTTCTTTCTTTTTTTTTTTTTTGT...GTCACAGGACTCATGGGGAATTC KI270931.1 Homo s...
[548]    215732 TGTGGTGAGGACCCTTAAGATCTA...GTCACAGGACTCATGGGGAATTC KI270932.1 Homo s...
[549]    170537 TCTACTCTCCCATGCTTGCCTCGG...GTCACAGGACTCATGGGGAATTC KI270933.1 Homo s...
[550]    177381 GATCTATCTGTATCTCCACAGGTG...GTCACAGGACTCATGGGGAATTC GL000209.2 Homo s...
[551]     16569 GATCACAGGTCTATCACCCTATTA...CCCTTAAATAAGACATCACGATG J01415.2 Homo sap...</code></pre>
<div id="use-taxonomy-id-for-genome-retrieval" class="section level4">
<h4>Use <code>taxonomy</code> id for genome retrieval</h4>
<p>Alternatively, instead of specifying the scientific name in the argument <code>organism</code> users can specify the <code>taxonomy</code> id of the corresponding organism. Here, we specify the taxonomy id <code>559292</code> which encodes the species <code>Saccharomyces cerevisiae</code>.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" data-line-number="1"><span class="co"># install.packages(&quot;magrittr&quot;)</span></a>
<a class="sourceLine" id="cb76-2" data-line-number="2"><span class="kw">library</span>(magrittr)</a>
<a class="sourceLine" id="cb76-3" data-line-number="3"><span class="co"># import genome as Biostrings object</span></a>
<a class="sourceLine" id="cb76-4" data-line-number="4">Scerevisiae_Genome &lt;-<span class="st"> </span><span class="kw">getGenome</span>(</a>
<a class="sourceLine" id="cb76-5" data-line-number="5">            <span class="dt">db       =</span> <span class="st">&quot;genbank&quot;</span>,</a>
<a class="sourceLine" id="cb76-6" data-line-number="6">            <span class="dt">organism =</span> <span class="st">&quot;559292&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb76-7" data-line-number="7"><span class="st">    </span><span class="kw">read_genome</span>()</a></code></pre></div>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" data-line-number="1">Scerevisiae_Genome</a></code></pre></div>
<pre><code>A DNAStringSet instance of length 16
       width seq                                names               
 [1]  230218 CCACACCACACCCACA...TGTGGTGTGTGTGGG BK006935.2 TPA_in...
 [2]  813184 AAATAGCCCTCATGTA...GGTGTGTGGGTGTGT BK006936.2 TPA_in...
 [3]  316620 CCCACACACCACACCC...GGTGTGGTGTGTGTG BK006937.2 TPA_in...
 [4] 1531933 ACACCACACCCACACC...GTAAGTAGCTTTTGG BK006938.2 TPA_in...
 [5]  576874 CGTCTCCTCCAAGCCC...TTCATTTTTTTTTTT BK006939.2 TPA_in...
 ...     ... ...
[12] 1078177 CACACACACACACCAC...ACATGAGGGCTATTT BK006945.2 TPA_in...
[13]  924431 CCACACACACACCACA...GGTGTGTGTGTGGGG BK006946.2 TPA_in...
[14]  784333 CCGGCTTTCTGACCGA...GGGTGTGGTGTGGGT BK006947.3 TPA_in...
[15] 1091291 ACACCACACCCACACC...GTGGGTGTGGTGTGT BK006948.2 TPA_in...
[16]  948066 AAATAGCCCTCATGTA...AATTTCGGTCAGAAA BK006949.2 TPA_in...</code></pre>
</div>
<div id="use-assembly_accession-id-for-genome-retrieval-1" class="section level4">
<h4>Use <code>assembly_accession</code> id for genome retrieval</h4>
<p>Alternatively, instead of specifying the scientific name or taxonomy in the argument <code>organism</code> users can specify the <code>assembly_accession</code> id of the corresponding organism. Here, we specify the <code>assembly_accession</code> id <code>GCA_000146045.2</code> which encodes the species <code>Saccharomyces cerevisiae</code>.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" data-line-number="1"><span class="co"># install.packages(&quot;magrittr&quot;)</span></a>
<a class="sourceLine" id="cb79-2" data-line-number="2"><span class="kw">library</span>(magrittr)</a>
<a class="sourceLine" id="cb79-3" data-line-number="3"><span class="co"># import genome as Biostrings object</span></a>
<a class="sourceLine" id="cb79-4" data-line-number="4">Scerevisiae_Genome &lt;-<span class="st"> </span><span class="kw">getGenome</span>(</a>
<a class="sourceLine" id="cb79-5" data-line-number="5">            <span class="dt">db       =</span> <span class="st">&quot;genbank&quot;</span>,</a>
<a class="sourceLine" id="cb79-6" data-line-number="6">            <span class="dt">organism =</span> <span class="st">&quot;GCA_000146045.2&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb79-7" data-line-number="7"><span class="st">    </span><span class="kw">read_genome</span>()</a></code></pre></div>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" data-line-number="1">Scerevisiae_Genome</a></code></pre></div>
<pre><code>A DNAStringSet instance of length 16
       width seq                                  names               
 [1]  230218 CCACACCACACCCACAC...GTGTGGTGTGTGTGGG BK006935.2 TPA_in...
 [2]  813184 AAATAGCCCTCATGTAC...TGGTGTGTGGGTGTGT BK006936.2 TPA_in...
 [3]  316620 CCCACACACCACACCCA...GGGTGTGGTGTGTGTG BK006937.2 TPA_in...
 [4] 1531933 ACACCACACCCACACCA...AGTAAGTAGCTTTTGG BK006938.2 TPA_in...
 [5]  576874 CGTCTCCTCCAAGCCCT...TTTCATTTTTTTTTTT BK006939.2 TPA_in...
 ...     ... ...
[12] 1078177 CACACACACACACCACC...TACATGAGGGCTATTT BK006945.2 TPA_in...
[13]  924431 CCACACACACACCACAC...TGGTGTGTGTGTGGGG BK006946.2 TPA_in...
[14]  784333 CCGGCTTTCTGACCGAA...TGGGTGTGGTGTGGGT BK006947.3 TPA_in...
[15] 1091291 ACACCACACCCACACCA...TGTGGGTGTGGTGTGT BK006948.2 TPA_in...
[16]  948066 AAATAGCCCTCATGTAC...TAATTTCGGTCAGAAA BK006949.2 TPA_in...</code></pre>
<p>In addition, the genome summary statistics for the retrieved species is stored locally (<code>doc_saccharomyces_cerevisiae_db_genbank_summary_statistics.tsv</code>) to provide users with insights regarding the genome assembly quality (see <code>?summary_genome()</code> for details). This file can be used as <code>Supplementary Information</code> file in publications to facilitate reproducible research. Most comparative genomics studies do not consider differences in genome assembly qualities when comparing the genomes of diverse species. This way, they expose themselves to technical artifacts that might generate patterns mistaken to be of biological relevance whereas in reality they just reflect the difference in genome assembly quality. Considering the quality of genome assemblies when downloading the genomic sequences will help researchers to avoid these pitfalls.</p>
<p>The summary statistics include:</p>
<ul>
<li><p><code>genome_size_mbp</code>: Genome size in mega base pairs</p></li>
<li><p><code>n50_mbp</code>: The N50 contig size of the genome assembly in mega base pairs</p></li>
<li><p><code>n_seqs</code>: The number of chromosomes/scaffolds/contigs of the genome assembly file</p></li>
<li><p><code>n_nnn</code>: The absolute number of NNNs (over all chromosomes or scaffolds or contigs) in the genome assembly file</p></li>
<li><p><code>rel_nnn</code>: The percentage (relative frequency) of NNNs (over all chromosomes or scaffolds or contigs) compared to the total number of nucleotides in the genome assembly file</p></li>
<li><p><code>genome_entropy</code>: The Shannon Entropy of the genome assembly file (median entropy over all individual chromosome entropies)</p></li>
<li><p><code>n_gc</code>: The total number of GCs (over all chromosomes or scaffolds or contigs) in the genome assembly file</p></li>
<li><p><code>rel_gc</code>: The (relative frequency) of GCs (over all chromosomes or scaffolds or contigs) compared to the total number of nucleotides in the genome assembly file</p></li>
</ul>
</div>
</div>
<div id="example-ensembl" class="section level3">
<h3>Example ENSEMBL:</h3>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" data-line-number="1"><span class="co"># download the genome of Homo sapiens from ENSEMBL</span></a>
<a class="sourceLine" id="cb82-2" data-line-number="2"><span class="co"># and store the corresponding genome file in '_ncbi_downloads/genomes'</span></a>
<a class="sourceLine" id="cb82-3" data-line-number="3">HS.genome.ensembl &lt;-<span class="st"> </span><span class="kw">getGenome</span>( <span class="dt">db       =</span> <span class="st">&quot;ensembl&quot;</span>, </a>
<a class="sourceLine" id="cb82-4" data-line-number="4">                                <span class="dt">organism =</span> <span class="st">&quot;Homo sapiens&quot;</span>,</a>
<a class="sourceLine" id="cb82-5" data-line-number="5">                                <span class="dt">path     =</span> <span class="kw">file.path</span>(<span class="st">&quot;_ncbi_downloads&quot;</span>,<span class="st">&quot;genomes&quot;</span>) )</a></code></pre></div>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" data-line-number="1"><span class="co"># import downloaded genome as Biostrings object</span></a>
<a class="sourceLine" id="cb83-2" data-line-number="2">Human_Genome &lt;-<span class="st"> </span><span class="kw">read_genome</span>(<span class="dt">file =</span> HS.genome.ensembl)</a></code></pre></div>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" data-line-number="1"><span class="co"># look at the Biostrings object</span></a>
<a class="sourceLine" id="cb84-2" data-line-number="2">Human_Genome</a></code></pre></div>
<pre><code>  A DNAStringSet instance of length 524
          width seq                                                names               
  [1] 248956422 NNNNNNNNNNNNNNNNNNNNNNNN...NNNNNNNNNNNNNNNNNNNNNNN 1 dna:chromosome ...
  [2] 242193529 NNNNNNNNNNNNNNNNNNNNNNNN...NNNNNNNNNNNNNNNNNNNNNNN 2 dna:chromosome ...
  [3] 198295559 NNNNNNNNNNNNNNNNNNNNNNNN...NNNNNNNNNNNNNNNNNNNNNNN 3 dna:chromosome ...
  [4] 190214555 NNNNNNNNNNNNNNNNNNNNNNNN...NNNNNNNNNNNNNNNNNNNNNNN 4 dna:chromosome ...
  [5] 181538259 NNNNNNNNNNNNNNNNNNNNNNNN...NNNNNNNNNNNNNNNNNNNNNNN 5 dna:chromosome ...
  ...       ... ...
[520]       993 GCCCCACGTCCGGGAGGGAGGTGG...GAGGGAGGTGGGGGGTCAGCCCT KI270539.1 dna:sc...
[521]       990 TTTCATAGAGCATGTTTGAAACAC...TCAGAAACTTGTTGTGATGTGTG KI270385.1 dna:sc...
[522]       981 AGATTTCGTTGGAACGGGATAAAC...TCAGCTTTCAAACACTCTTTTTG KI270423.1 dna:sc...
[523]       971 ATTTGCGATGTGTGTTCTCAACTA...TTGGATAGCTTTGAAGTTTTCGT KI270392.1 dna:sc...
[524]       970 AAGTGGATATTTGGATAGCTTTGA...TCCTCAATAACAGAGTTGAACCT KI270394.1 dna:sc...</code></pre>
<p>Users can also specify the <code>release</code> argument which denotes the database release version of ENSEMBL (<code>db = &quot;ensembl&quot;</code>) in case they wish to download archived vgenome versions. Default is release = NULL meaning that the most recent database version is used.</p>
<p>In addition, the genome summary statistics for the retrieved species is stored locally (<code>doc_homo_sapiens_db_ensembl_summary_statistics.tsv</code>) to provide users with insights regarding the genome assembly quality (see <code>?summary_genome()</code> for details). This file can be used as <code>Supplementary Information</code> file in publications to facilitate reproducible research. Most comparative genomics studies do not consider differences in genome assembly qualities when comparing the genomes of diverse species. This way, they expose themselves to technical artifacts that might generate patterns mistaken to be of biological relevance whereas in reality they just reflect the difference in genome assembly quality. Considering the quality of genome assemblies when downloading the genomic sequences will help researchers to avoid these pitfalls.</p>
<p>The summary statistics include:</p>
<ul>
<li><p><code>genome_size_mbp</code>: Genome size in mega base pairs</p></li>
<li><p><code>n50_mbp</code>: The N50 contig size of the genome assembly in mega base pairs</p></li>
<li><p><code>n_seqs</code>: The number of chromosomes/scaffolds/contigs of the genome assembly file</p></li>
<li><p><code>n_nnn</code>: The absolute number of NNNs (over all chromosomes or scaffolds or contigs) in the genome assembly file</p></li>
<li><p><code>rel_nnn</code>: The percentage (relative frequency) of NNNs (over all chromosomes or scaffolds or contigs) compared to the total number of nucleotides in the genome assembly file</p></li>
<li><p><code>genome_entropy</code>: The Shannon Entropy of the genome assembly file (median entropy over all individual chromosome entropies)</p></li>
<li><p><code>n_gc</code>: The total number of GCs (over all chromosomes or scaffolds or contigs) in the genome assembly file</p></li>
<li><p><code>rel_gc</code>: The (relative frequency) of GCs (over all chromosomes or scaffolds or contigs) compared to the total number of nucleotides in the genome assembly file</p></li>
</ul>
<div id="use-taxonomy-id-for-genome-retrieval-1" class="section level4">
<h4>Use <code>taxonomy</code> id for genome retrieval</h4>
<p>Alternatively, instead of specifying the scientific name in the argument <code>organism</code> users can specify the <code>taxonomy</code> id of the corresponding organism. Here, we specify the taxonomy id <code>4932</code> which encodes the species <code>Saccharomyces cerevisiae</code>.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" data-line-number="1"><span class="co"># install.packages(&quot;magrittr&quot;)</span></a>
<a class="sourceLine" id="cb86-2" data-line-number="2"><span class="kw">library</span>(magrittr)</a>
<a class="sourceLine" id="cb86-3" data-line-number="3"><span class="co"># import genome as Biostrings object</span></a>
<a class="sourceLine" id="cb86-4" data-line-number="4">Scerevisiae_Genome &lt;-<span class="st"> </span><span class="kw">getGenome</span>(</a>
<a class="sourceLine" id="cb86-5" data-line-number="5">            <span class="dt">db       =</span> <span class="st">&quot;ensembl&quot;</span>,</a>
<a class="sourceLine" id="cb86-6" data-line-number="6">            <span class="dt">organism =</span> <span class="st">&quot;4932&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb86-7" data-line-number="7"><span class="st">    </span><span class="kw">read_genome</span>()</a></code></pre></div>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" data-line-number="1">Scerevisiae_Genome</a></code></pre></div>
<pre><code>  A DNAStringSet instance of length 17
       width seq                            names               
 [1]  230218 CCACACCACACCCA...TGGTGTGTGTGGG I dna:chromosome ...
 [2]  813184 AAATAGCCCTCATG...TGTGTGGGTGTGT II dna:chromosome...
 [3]  316620 CCCACACACCACAC...TGTGGTGTGTGTG III dna:chromosom...
 [4] 1531933 ACACCACACCCACA...AAGTAGCTTTTGG IV dna:chromosome...
 [5]  576874 CGTCTCCTCCAAGC...CATTTTTTTTTTT V dna:chromosome ...
 ...     ... ...
[13]  924431 CCACACACACACCA...TGTGTGTGTGGGG XIII dna:chromoso...
[14]  784333 CCGGCTTTCTGACC...GTGTGGTGTGGGT XIV dna:chromosom...
[15] 1091291 ACACCACACCCACA...GGGTGTGGTGTGT XV dna:chromosome...
[16]  948066 AAATAGCCCTCATG...TTTCGGTCAGAAA XVI dna:chromosom...
[17]   85779 TTCATAATTAATTT...TATAATATCCATA Mito dna:chromoso...</code></pre>
</div>
<div id="use-assembly_accession-id-for-genome-retrieval-2" class="section level4">
<h4>Use <code>assembly_accession</code> id for genome retrieval</h4>
<p>Alternatively, instead of specifying the scientific name or taxonomy in the argument <code>organism</code> users can specify the <code>assembly_accession</code> id of the corresponding organism. Here, we specify the <code>assembly_accession</code> id <code>GCA_000146045.2</code> which encodes the species <code>Saccharomyces cerevisiae</code>.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" data-line-number="1"><span class="co"># install.packages(&quot;magrittr&quot;)</span></a>
<a class="sourceLine" id="cb89-2" data-line-number="2"><span class="kw">library</span>(magrittr)</a>
<a class="sourceLine" id="cb89-3" data-line-number="3"><span class="co"># import genome as Biostrings object</span></a>
<a class="sourceLine" id="cb89-4" data-line-number="4">Scerevisiae_Genome &lt;-<span class="st"> </span><span class="kw">getGenome</span>(</a>
<a class="sourceLine" id="cb89-5" data-line-number="5">            <span class="dt">db       =</span> <span class="st">&quot;ensembl&quot;</span>,</a>
<a class="sourceLine" id="cb89-6" data-line-number="6">            <span class="dt">organism =</span> <span class="st">&quot;GCA_000146045.2&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb89-7" data-line-number="7"><span class="st">    </span><span class="kw">read_genome</span>()</a></code></pre></div>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" data-line-number="1">Scerevisiae_Genome</a></code></pre></div>
<pre><code>  A DNAStringSet instance of length 17
       width seq                                names               
 [1]  230218 CCACACCACACCCACA...TGTGGTGTGTGTGGG I dna:chromosome ...
 [2]  813184 AAATAGCCCTCATGTA...GGTGTGTGGGTGTGT II dna:chromosome...
 [3]  316620 CCCACACACCACACCC...GGTGTGGTGTGTGTG III dna:chromosom...
 [4] 1531933 ACACCACACCCACACC...GTAAGTAGCTTTTGG IV dna:chromosome...
 [5]  439888 CACACACACCACACCC...GTGTGGTGTGTGTGT IX dna:chromosome...
 ...     ... ...
[13] 1078177 CACACACACACACCAC...ACATGAGGGCTATTT XII dna:chromosom...
[14]  924431 CCACACACACACCACA...GGTGTGTGTGTGGGG XIII dna:chromoso...
[15]  784333 CCGGCTTTCTGACCGA...GGGTGTGGTGTGGGT XIV dna:chromosom...
[16] 1091291 ACACCACACCCACACC...GTGGGTGTGGTGTGT XV dna:chromosome...
[17]  948066 AAATAGCCCTCATGTA...AATTTCGGTCAGAAA XVI dna:chromosom...</code></pre>
</div>
</div>
<div id="genomeset-retrieval" class="section level3">
<h3>GenomeSet Retrieval</h3>
<p>The <code>getGenomeSet()</code> function enables users to retrieve genome files for multiple species. This is convenient when users wish to bulk download a particular set of species. Internally, a folder named <code>set_genomes</code> is generated in which genomes and genome info files are stored. In addition, users can specify the arguments: <code>clean_retrieval</code> and <code>gunzip</code> (both are <code>TRUE</code> by default) to clean file names and automatically unzip downloaded files.</p>
<p>Example:</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" data-line-number="1"><span class="co"># specify the species names</span></a>
<a class="sourceLine" id="cb92-2" data-line-number="2">download_species &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Arabidopsis thaliana&quot;</span>, </a>
<a class="sourceLine" id="cb92-3" data-line-number="3">                      <span class="st">&quot;Arabidopsis lyrata&quot;</span>, </a>
<a class="sourceLine" id="cb92-4" data-line-number="4">                      <span class="st">&quot;Capsella rubella&quot;</span>)</a>
<a class="sourceLine" id="cb92-5" data-line-number="5"><span class="co"># retrieve these three species from NCBI RefSeq                       </span></a>
<a class="sourceLine" id="cb92-6" data-line-number="6">biomartr<span class="op">::</span><span class="kw">getGenomeSet</span>(<span class="st">&quot;refseq&quot;</span>, <span class="dt">organisms =</span> download_species, <span class="dt">path =</span> <span class="st">&quot;set_genomes&quot;</span>)</a></code></pre></div>
<p>If the download process was interrupted, users can re-run the function and it will only download missing genomes. In cases users wish to download everything again and updating existing genomes, they may specify the argument <code>update = TRUE</code>.</p>
</div>
<div id="proteome-retrieval" class="section level3">
<h3>Proteome Retrieval</h3>
<p>The <code>getProteome()</code> function is an interface function to the <a href="http://www.ncbi.nlm.nih.gov/refseq/about/">NCBI RefSeq</a>, <a href="http://www.ncbi.nlm.nih.gov/genbank/about/">NCBI Genbank</a>, <a href="http://www.ensembl.org/index.html">ENSEMBL</a>, and <a href="http://uniprot.org/">UniProt</a> databases from which corresponding proteomes can be retrieved. It works analogous to <code>getGenome()</code>.</p>
<p>The <code>db</code> argument specifies from which database proteomes in <code>*.fasta</code> file format shall be retrieved.</p>
<p>Options are:</p>
<ul>
<li><code>db = &quot;refseq&quot;</code> for retrieval from <a href="http://www.ncbi.nlm.nih.gov/refseq/about/">NCBI RefSeq</a></li>
<li><code>db = &quot;genbank&quot;</code> for retrieval from <a href="http://www.ncbi.nlm.nih.gov/genbank/about/">NCBI Genbank</a></li>
<li><code>db = &quot;ensembl&quot;</code> for retrieval from <a href="http://www.ensembl.org/index.html">ENSEMBL</a></li>
<li><code>db = &quot;uniprot&quot;</code> for retrieval from <a href="http://uniprot.org/">UniProt</a></li>
</ul>
<p>Furthermore, again users need to specify the scientific name of the organism of interest for which a proteomes shall be downloaded, e.g. <code>organism = &quot;Homo sapiens&quot;</code>. Finally, the <code>path</code> argument specifies the folder path in which the corresponding proteome shall be locally stored. In case users would like to store the proteome file at a different location, they can specify the <code>path = file.path(&quot;put&quot;,&quot;your&quot;,&quot;path&quot;,&quot;here&quot;)</code> argument.</p>
</div>
<div id="example-ncbi-refseq-1" class="section level3">
<h3>Example <code>NCBI RefSeq</code>:</h3>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" data-line-number="1"><span class="co"># download the proteome of Homo sapiens from refseq</span></a>
<a class="sourceLine" id="cb93-2" data-line-number="2"><span class="co"># and store the corresponding proteome file in '_ncbi_downloads/proteomes'</span></a>
<a class="sourceLine" id="cb93-3" data-line-number="3">HS.proteome.refseq &lt;-<span class="st"> </span><span class="kw">getProteome</span>( <span class="dt">db       =</span> <span class="st">&quot;refseq&quot;</span>, </a>
<a class="sourceLine" id="cb93-4" data-line-number="4">                                   <span class="dt">organism =</span> <span class="st">&quot;Homo sapiens&quot;</span>,</a>
<a class="sourceLine" id="cb93-5" data-line-number="5">                                   <span class="dt">path     =</span> <span class="kw">file.path</span>(<span class="st">&quot;_ncbi_downloads&quot;</span>,<span class="st">&quot;proteomes&quot;</span>))</a></code></pre></div>
<p>In this example, <code>getProteome()</code> creates a directory named <code>'_ncbi_downloads/proteomes'</code> into which the corresponding genome named <code>GCF_000001405.34_GRCh38.p8_protein.faa.gz</code> is downloaded. The return value of <code>getProteome()</code> is the folder path to the downloaded proteome file that can then be used as input to the <code>read_proteome()</code> function. The variable <code>HS.proteome.refseq</code> stores the path to the downloaded proteome. Subsequently, users can use the <code>read_proteome()</code> function to import the proteome into the R session. Users can choose to work with the proteome sequence in R either as <a href="http://bioconductor.org/packages/release/bioc/html/Biostrings.html">Biostrings</a> object (<code>obj.type = &quot;Biostrings&quot;</code>) or <a href="https://github.com/Rdatatable/data.table/wiki">data.table</a> object (<code>obj.type = &quot;data.table&quot;</code>) by specifying the <code>obj.type</code> argument of the <code>read_proteome()</code> function.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" data-line-number="1"><span class="co"># import proteome as Biostrings object</span></a>
<a class="sourceLine" id="cb94-2" data-line-number="2">Human_Proteome &lt;-<span class="st"> </span><span class="kw">read_proteome</span>(<span class="dt">file =</span> HS.proteome.refseq)</a></code></pre></div>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" data-line-number="1">Human_Proteome</a></code></pre></div>
<pre><code>A AAStringSet instance of length 113620
         width seq                          names               
     [1]  1474 MGKNKLLHPSLVL...YNAPCSKDLGNA NP_000005.2 alpha...
     [2]   290 MDIEAYFERIGYK...LVPKPGDGSLTI NP_000006.2 aryla...
     [3]   421 MAAGFGRCCRVLR...IVAREHIDKYKN NP_000007.1 mediu...
     [4]   412 MAAALLARASGPA...VIAGHLLRSYRS NP_000008.1 short...
     [5]   655 MQAARMAASLGRQ...RGGVVTSNPLGF NP_000009.1 very ...
     ...   ... ...
[113616]    98 MPLIYMNIMLAFT...LDYVHNLNLLQC YP_003024034.1 NA...
[113617]   459 MLKLIVPTIMLLP...SLNPDIITGFSS YP_003024035.1 NA...
[113618]   603 MTMHTTMTTLTLT...FFPLILTLLLIT YP_003024036.1 NA...
[113619]   174 MMYALFLLSVGLV...GVYIVIEIARGN YP_003024037.1 NA...
[113620]   380 MTPMRKTNPLMKL...ISLIENKMLKWA YP_003024038.1 cy...</code></pre>
<p>Alternatively, users can perform the pipeline logic of the <a href="https://github.com/smbache/magrittr">magrittr</a> package:</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" data-line-number="1"><span class="co"># install.packages(&quot;magrittr&quot;)</span></a>
<a class="sourceLine" id="cb97-2" data-line-number="2"><span class="kw">library</span>(magrittr)</a>
<a class="sourceLine" id="cb97-3" data-line-number="3"><span class="co"># import proteome as Biostrings object</span></a>
<a class="sourceLine" id="cb97-4" data-line-number="4">Human_Proteome &lt;-<span class="st"> </span><span class="kw">getProteome</span>( <span class="dt">db       =</span> <span class="st">&quot;refseq&quot;</span>, </a>
<a class="sourceLine" id="cb97-5" data-line-number="5">                               <span class="dt">organism =</span> <span class="st">&quot;Homo sapiens&quot;</span>,</a>
<a class="sourceLine" id="cb97-6" data-line-number="6">                               <span class="dt">path     =</span> <span class="kw">file.path</span>(<span class="st">&quot;_ncbi_downloads&quot;</span>,<span class="st">&quot;proteomes&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb97-7" data-line-number="7"><span class="st">    </span><span class="kw">read_proteome</span>()</a></code></pre></div>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" data-line-number="1">Human_Proteome</a></code></pre></div>
<pre><code> A AAStringSet instance of length 113620
         width seq                          names               
     [1]  1474 MGKNKLLHPSLVL...YNAPCSKDLGNA NP_000005.2 alpha...
     [2]   290 MDIEAYFERIGYK...LVPKPGDGSLTI NP_000006.2 aryla...
     [3]   421 MAAGFGRCCRVLR...IVAREHIDKYKN NP_000007.1 mediu...
     [4]   412 MAAALLARASGPA...VIAGHLLRSYRS NP_000008.1 short...
     [5]   655 MQAARMAASLGRQ...RGGVVTSNPLGF NP_000009.1 very ...
     ...   ... ...
[113616]    98 MPLIYMNIMLAFT...LDYVHNLNLLQC YP_003024034.1 NA...
[113617]   459 MLKLIVPTIMLLP...SLNPDIITGFSS YP_003024035.1 NA...
[113618]   603 MTMHTTMTTLTLT...FFPLILTLLLIT YP_003024036.1 NA...
[113619]   174 MMYALFLLSVGLV...GVYIVIEIARGN YP_003024037.1 NA...
[113620]   380 MTPMRKTNPLMKL...ISLIENKMLKWA YP_003024038.1 cy...</code></pre>
</div>
<div id="example-ncbi-genbank-1" class="section level3">
<h3>Example <code>NCBI Genbank</code>:</h3>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb100-1" data-line-number="1"><span class="co"># download the proteome of Homo sapiens from genbank</span></a>
<a class="sourceLine" id="cb100-2" data-line-number="2"><span class="co"># and store the corresponding proteome file in '_ncbi_downloads/proteomes'</span></a>
<a class="sourceLine" id="cb100-3" data-line-number="3">HS.proteome.genbank &lt;-<span class="st"> </span><span class="kw">getProteome</span>( <span class="dt">db       =</span> <span class="st">&quot;genbank&quot;</span>, </a>
<a class="sourceLine" id="cb100-4" data-line-number="4">                                   <span class="dt">organism =</span> <span class="st">&quot;Homo sapiens&quot;</span>,</a>
<a class="sourceLine" id="cb100-5" data-line-number="5">                                   <span class="dt">path     =</span> <span class="kw">file.path</span>(<span class="st">&quot;_ncbi_downloads&quot;</span>,<span class="st">&quot;proteomes&quot;</span>))</a></code></pre></div>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" data-line-number="1"><span class="co"># import proteome as Biostrings object</span></a>
<a class="sourceLine" id="cb101-2" data-line-number="2">Human_Proteome &lt;-<span class="st"> </span><span class="kw">read_proteome</span>(<span class="dt">file =</span> HS.proteome.genbank)</a></code></pre></div>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" data-line-number="1">Human_Proteome</a></code></pre></div>
<pre><code>A AAStringSet instance of length 13
     width seq                              names               
 [1]   318 MPMANLLLLIVPILI...VSMPITISSIPPQT AAB58943.1 NADH d...
 [2]   347 MNPLAQPVIYSTIFA...TLLLPISPFMLMIL AAB58944.1 NADH d...
 [3]   513 MFADRWLFSTNHKDI...PPYHTFEEPVYMKS AAB58945.1 cytoch...
 [4]   227 MAHAAQVGLQDATSP...IPLKIFEMGPVFTL AAB58946.1 cytoch...
 [5]    68 MPQLNTTVWPTMITP...WTKICSLHSLPPQS AAB58947.1 ATPase...
 ...   ... ...
 [9]    98 MPLIYMNIMLAFTIS...YGLDYVHNLNLLQC AAB58951.1 NADH d...
[10]   459 MLKLIVPTIMLLPLT...LLSLNPDIITGFSS AAB58952.1 NADH d...
[11]   603 MTMHTTMTTLTLTSL...SFFFPLILTLLLIT AAB58953.1 NADH d...
[12]   174 MMYALFLLSVGLVMG...FVGVYIVIEIARGN AAB58954.1 NADH d...
[13]   380 MTPMRKTNPLMKLIN...PTISLIENKMLKWA AAB58955.3 cytoch...</code></pre>
</div>
<div id="example-ensembl-1" class="section level3">
<h3>Example <code>ENSEMBL</code>:</h3>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb104-1" data-line-number="1"><span class="co"># download the proteome of Homo sapiens from ENSEMBL</span></a>
<a class="sourceLine" id="cb104-2" data-line-number="2"><span class="co"># and store the corresponding proteome file in '_ncbi_downloads/proteomes'</span></a>
<a class="sourceLine" id="cb104-3" data-line-number="3">HS.proteome.ensembl &lt;-<span class="st"> </span><span class="kw">getProteome</span>( <span class="dt">db       =</span> <span class="st">&quot;ensembl&quot;</span>, </a>
<a class="sourceLine" id="cb104-4" data-line-number="4">                                   <span class="dt">organism =</span> <span class="st">&quot;Homo sapiens&quot;</span>,</a>
<a class="sourceLine" id="cb104-5" data-line-number="5">                                   <span class="dt">path     =</span> <span class="kw">file.path</span>(<span class="st">&quot;_ncbi_downloads&quot;</span>,<span class="st">&quot;proteomes&quot;</span>))</a></code></pre></div>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb105-1" data-line-number="1"><span class="co"># import proteome as Biostrings object</span></a>
<a class="sourceLine" id="cb105-2" data-line-number="2">Human_Proteome &lt;-<span class="st"> </span><span class="kw">read_proteome</span>(<span class="dt">file =</span> HS.proteome.ensembl)</a></code></pre></div>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb106-1" data-line-number="1">Human_Proteome</a></code></pre></div>
<pre><code>  A AAStringSet instance of length 107844
         width seq                          names               
     [1]     3 PSY                          ENSP00000451515.1...
     [2]     4 TGGY                         ENSP00000452494.1...
     [3]     2 EI                           ENSP00000451042.1...
     [4]     4 GTGG                         ENSP00000487941.1...
     [5]     4 GTGG                         ENSP00000488240.1...
     ...   ... ...
[107840]   135 MLQKKIEEKDLKV...LNHICKVPLAIK ENSP00000495237.1...
[107841]   166 MEHAFTPLEPLLS...IIQEESLIYLLQ ENSP00000496198.1...
[107842]    42 MEVPTAYMISPKE...GLKSENTMLLRC ENSP00000495723.1...
[107843]   508 MPSMLERISKNLV...GTLSLLQQLAEA ENSP00000496548.1...
[107844]   508 MPSMLERISKNLV...GTLSLLQQLAEA ENSP00000494855.1...</code></pre>
<p>Users can also specify the <code>release</code> argument which denotes the database release version of ENSEMBL (<code>db = &quot;ensembl&quot;</code>) in case they wish to download archived vgenome versions. Default is release = NULL meaning that the most recent database version is used.</p>
</div>
<div id="example-retrieval-uniprot" class="section level3">
<h3>Example Retrieval <code>Uniprot</code>:</h3>
<p>Another way of retrieving proteome sequences is from the <a href="http://www.uniprot.org/">UniProt</a> database.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb108-1" data-line-number="1"><span class="co"># download the proteome of Mus musculus from UniProt</span></a>
<a class="sourceLine" id="cb108-2" data-line-number="2"><span class="co"># and store the corresponding proteome file in '_uniprot_downloads/proteomes'</span></a>
<a class="sourceLine" id="cb108-3" data-line-number="3">Mm.proteome.uniprot&lt;-<span class="st"> </span><span class="kw">getProteome</span>( <span class="dt">db       =</span> <span class="st">&quot;uniprot&quot;</span>, </a>
<a class="sourceLine" id="cb108-4" data-line-number="4">                                   <span class="dt">organism =</span> <span class="st">&quot;Mus musculus&quot;</span>,</a>
<a class="sourceLine" id="cb108-5" data-line-number="5">                                   <span class="dt">path     =</span> <span class="kw">file.path</span>(<span class="st">&quot;_uniprot_downloads&quot;</span>,<span class="st">&quot;proteomes&quot;</span>))</a></code></pre></div>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb109-1" data-line-number="1"><span class="co"># import proteome as Biostrings object</span></a>
<a class="sourceLine" id="cb109-2" data-line-number="2">Mouse_Proteome &lt;-<span class="st"> </span><span class="kw">read_proteome</span>(<span class="dt">file =</span> Mm.proteome.uniprot)</a></code></pre></div>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb110-1" data-line-number="1">Mouse_Proteome</a></code></pre></div>
<pre><code>A AAStringSet instance of length 84522
        width seq                                  names               
    [1]   781 MATQADLMELDMAMEPD...LPPGDSNQLAWFDTDL sp|Q02248|CTNB1_M...
    [2]  2531 MPRLLTPLLCLTLLPAL...PTTMPSQITHIPEAFK sp|Q01705|NOTC1_M...
    [3]   437 MLLLLARCFLVILASSL...LDSETMHPLGMAVKSS sp|Q62226|SHH_MOU...
    [4]   380 MKKPIGILSPGVALGTA...VKCKKCTEIVDQFVCK sp|P22725|WNT5A_M...
    [5]   387 MEESQSDISLELPLSQE...SRHKKTMVKKVGPDSD sp|P02340|P53_MOU...
    ...   ... ...
[84518]   459 MLKIILPSLMLLPLTWL...LILLTTSPKLITGLTM tr|A0A0F6PZ84|A0A...
[84519]   380 MTNMRKTHPLFKIINHS...LMPISGIIEDKMLKLY tr|U3TEV9|U3TEV9_...
[84520]   381 MTNMRKTHPLFKIINHS...MPISGIIEDKMLKLYP tr|A0A0F6PXN8|A0A...
[84521]   172 MNNYIFVLSSLFLVGCL...WSLFAGIFIIIEITRD tr|A0A0F6PXK9|A0A...
[84522]   381 MTNMRKTHPLFKIINHS...MPISGIIEDKMLKLYP tr|A0A0F6PYR5|A0A...</code></pre>
</div>
<div id="proteomeset-retrieval" class="section level3">
<h3>ProteomeSet Retrieval</h3>
<p>The <code>getProteomeSet()</code> function enables users to retrieve proteome files for multiple species. This is convenient when users wish to bulk download a particular set of species. Internally, a folder named <code>set_proteomes</code> is generated in which proteomes and proteome info files are stored. In addition, users can specify the arguments: <code>clean_retrieval</code> and <code>gunzip</code> (both are <code>TRUE</code> by default) to clean file names and automatically unzip downloaded files.</p>
<p>Example:</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb112-1" data-line-number="1"><span class="co"># specify the species names</span></a>
<a class="sourceLine" id="cb112-2" data-line-number="2">download_species &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Arabidopsis thaliana&quot;</span>, </a>
<a class="sourceLine" id="cb112-3" data-line-number="3">                      <span class="st">&quot;Arabidopsis lyrata&quot;</span>, </a>
<a class="sourceLine" id="cb112-4" data-line-number="4">                      <span class="st">&quot;Capsella rubella&quot;</span>)</a>
<a class="sourceLine" id="cb112-5" data-line-number="5"><span class="co"># retrieve these three species from NCBI RefSeq                       </span></a>
<a class="sourceLine" id="cb112-6" data-line-number="6">biomartr<span class="op">::</span><span class="kw">getProteomeSet</span>(<span class="st">&quot;refseq&quot;</span>, <span class="dt">organisms =</span> download_species, <span class="dt">path =</span> <span class="st">&quot;set_proteomes&quot;</span>)</a></code></pre></div>
<p>If the download process was interrupted, users can re-run the function and it will only download missing genomes. In cases users wish to download everything again and updating existing genomes, they may specify the argument <code>update = TRUE</code>.</p>
</div>
<div id="cds-retrieval" class="section level3">
<h3>CDS Retrieval</h3>
<p>The <code>getCDS()</code> function is an interface function to the <a href="http://www.ncbi.nlm.nih.gov/refseq/about/">NCBI RefSeq</a>, <a href="http://www.ncbi.nlm.nih.gov/genbank/about/">NCBI Genbank</a>, <a href="http://www.ensembl.org/index.html">ENSEMBL</a> databases from which corresponding CDS files can be retrieved. It works analogous to <code>getGenome()</code> and <code>getProteome()</code>.</p>
<p>The <code>db</code> argument specifies from which database proteomes in <code>*.fasta</code> file format shall be retrieved.</p>
<p>Options are:</p>
<ul>
<li><code>db = &quot;refseq&quot;</code> for retrieval from <a href="http://www.ncbi.nlm.nih.gov/refseq/about/">NCBI RefSeq</a></li>
<li><code>db = &quot;genbank&quot;</code> for retrieval from <a href="http://www.ncbi.nlm.nih.gov/genbank/about/">NCBI Genbank</a></li>
<li><code>db = &quot;ensembl&quot;</code> for retrieval from <a href="http://www.ensembl.org/index.html">ENSEMBL</a></li>
</ul>
<p>Furthermore, again users need to specify the scientific name of the organism of interest for which a proteomes shall be downloaded, e.g. <code>organism = &quot;Homo sapiens&quot;</code>. Finally, the <code>path</code> argument specifies the folder path in which the corresponding CDS file shall be locally stored. In case users would like to store the CDS file at a different location, they can specify the <code>path = file.path(&quot;put&quot;,&quot;your&quot;,&quot;path&quot;,&quot;here&quot;)</code> argument.</p>
</div>
<div id="example-ncbi-refseq-2" class="section level3">
<h3>Example <code>NCBI RefSeq</code>:</h3>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb113-1" data-line-number="1"><span class="co"># download the genome of Homo sapiens from refseq</span></a>
<a class="sourceLine" id="cb113-2" data-line-number="2"><span class="co"># and store the corresponding genome CDS file in '_ncbi_downloads/CDS'</span></a>
<a class="sourceLine" id="cb113-3" data-line-number="3">HS.cds.refseq &lt;-<span class="st"> </span><span class="kw">getCDS</span>( <span class="dt">db       =</span> <span class="st">&quot;refseq&quot;</span>, </a>
<a class="sourceLine" id="cb113-4" data-line-number="4">                         <span class="dt">organism =</span> <span class="st">&quot;Homo sapiens&quot;</span>,</a>
<a class="sourceLine" id="cb113-5" data-line-number="5">                         <span class="dt">path     =</span> <span class="kw">file.path</span>(<span class="st">&quot;_ncbi_downloads&quot;</span>,<span class="st">&quot;CDS&quot;</span>))</a></code></pre></div>
<p>In this example, <code>getCDS()</code> creates a directory named <code>'_ncbi_downloads/CDS'</code> into which the corresponding genome named <code>Homo_sapiens_cds_from_genomic_refseq.fna.gz</code> is downloaded. The return value of <code>getCDS()</code> is the folder path to the downloaded genome file that can then be used as input to the <code>read_cds()</code> function. The variable <code>HS.cds.refseq</code> stores the path to the downloaded CDS file. Subsequently, users can use the <code>read_cds()</code> function to import the genome into the R session. Users can choose to work with the genome sequence in R either as <a href="http://bioconductor.org/packages/release/bioc/html/Biostrings.html">Biostrings</a> object (<code>obj.type = &quot;Biostrings&quot;</code>) or <a href="https://github.com/Rdatatable/data.table/wiki">data.table</a> object (<code>obj.type = &quot;data.table&quot;</code>) by specifying the <code>obj.type</code> argument of the <code>read_cds()</code> function.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb114-1" data-line-number="1"><span class="co"># import downloaded CDS as Biostrings object</span></a>
<a class="sourceLine" id="cb114-2" data-line-number="2">Human_CDS &lt;-<span class="st"> </span><span class="kw">read_cds</span>(<span class="dt">file     =</span> HS.cds.refseq, </a>
<a class="sourceLine" id="cb114-3" data-line-number="3">                      <span class="dt">obj.type =</span> <span class="st">&quot;Biostrings&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb115-1" data-line-number="1"><span class="co"># look at the Biostrings object</span></a>
<a class="sourceLine" id="cb115-2" data-line-number="2">Human_CDS</a></code></pre></div>
<pre><code> A BStringSet instance of length 114967
          width seq                                                names               
     [1]    918 ATGGTGACTGAATTCATTTTTCTG...CACATTCTAGTGTAAAGTTTTAG lcl|NC_000001.11_...
     [2]    402 ATGAGTGACAGCATCAACTTCTCT...CAGGACCCAGGCACAGGCATTAG lcl|NC_000001.11_...
     [3]    402 ATGAGTGACAGCATCAACTTCTCT...CAGGACCCAGGCACAGGCATTAG lcl|NC_000001.11_...
     [4]    402 ATGAGTGACAGCATCAACTTCTCT...CAGGACCCAGGCACAGGCATTAG lcl|NC_000001.11_...
     [5]    402 ATGAGTGACAGCATCAACTTCTCT...CAGGACCCAGGCACAGGCATTAG lcl|NC_000001.11_...
     ...    ... ...
[114963]    297 ATGCCCCTCATTTACATAAATATT...ACCTAAACCTACTCCAATGCTAA lcl|NC_012920.1_c...
[114964]   1378 ATGCTAAAACTAATCGTCCCAACA...CATCATTACCGGGTTTTCCTCTT lcl|NC_012920.1_c...
[114965]   1812 ATAACCATGCACACTACTATAACC...TAACCCTACTCCTAATCACATAA lcl|NC_012920.1_c...
[114966]    525 ATGATGTATGCTTTGTTTCTGTTG...TTGAGATTGCTCGGGGGAATAGG lcl|NC_012920.1_c...
[114967]   1141 ATGACCCCAATACGCAAAACTAAC...AAACAAAATACTCAAATGGGCCT lcl|NC_012920.1_c...</code></pre>
<p>Internally, a text file named <code>doc_Homo_sapiens_db_refseq.txt</code> is generated. The information stored in this log file is structured as follows:</p>
<pre><code>File Name: Homo_sapiens_cds_from_genomic_refseq.fna.gz
Organism Name: Homo_sapiens
Database: NCBI refseq
URL: ftp://ftp.ncbi.nlm.nih.gov/genomes/all/GCF/000/001/405/
GCF_000001405.35_GRCh38.p9/GCF_000001405.35_GRCh38.p9_cds_from_genomic.fna.gz
Download_Date: Sun Oct 23 17:19:05 2016
refseq_category: reference genome
assembly_accession: GCF_000001405.35
bioproject: PRJNA168
biosample: NA
taxid: 9606
infraspecific_name: NA
version_status: latest
release_type: Patch
genome_rep: Full
seq_rel_date: 2016-09-26
submitter: Genome Reference Consortium</code></pre>
<p>In summary, the <code>getCDS()</code> and <code>read_cds()</code> functions allow users to retrieve CDS files by specifying the scientific name of the organism of interest and allow them to import the retrieved CDS file e.g. as <code>Biostrings</code> object. Thus, users can then perform the <code>Biostrings notation</code> to work with downloaded CDS and can rely on the log file generated by <code>getCDS()</code> to better document the source and version of CDS used for subsequent studies.</p>
<p>Alternatively, users can perform the pipeline logic of the <a href="https://github.com/smbache/magrittr">magrittr</a> package:</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb118-1" data-line-number="1"><span class="co"># install.packages(&quot;magrittr&quot;)</span></a>
<a class="sourceLine" id="cb118-2" data-line-number="2"><span class="kw">library</span>(magrittr)</a>
<a class="sourceLine" id="cb118-3" data-line-number="3"><span class="co"># import CDS as Biostrings object</span></a>
<a class="sourceLine" id="cb118-4" data-line-number="4">Human_CDS &lt;-<span class="st"> </span><span class="kw">getCDS</span>( <span class="dt">db       =</span> <span class="st">&quot;refseq&quot;</span>, </a>
<a class="sourceLine" id="cb118-5" data-line-number="5">                     <span class="dt">organism =</span> <span class="st">&quot;Homo sapiens&quot;</span>,</a>
<a class="sourceLine" id="cb118-6" data-line-number="6">                     <span class="dt">path     =</span> <span class="kw">file.path</span>(<span class="st">&quot;_ncbi_downloads&quot;</span>,<span class="st">&quot;CDS&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb118-7" data-line-number="7"><span class="st">    </span><span class="kw">read_cds</span>(<span class="dt">obj.type =</span> <span class="st">&quot;Biostrings&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb119-1" data-line-number="1">Human_CDS</a></code></pre></div>
<pre><code> A BStringSet instance of length 114967
          width seq                                                names               
     [1]    918 ATGGTGACTGAATTCATTTTTCTG...CACATTCTAGTGTAAAGTTTTAG lcl|NC_000001.11_...
     [2]    402 ATGAGTGACAGCATCAACTTCTCT...CAGGACCCAGGCACAGGCATTAG lcl|NC_000001.11_...
     [3]    402 ATGAGTGACAGCATCAACTTCTCT...CAGGACCCAGGCACAGGCATTAG lcl|NC_000001.11_...
     [4]    402 ATGAGTGACAGCATCAACTTCTCT...CAGGACCCAGGCACAGGCATTAG lcl|NC_000001.11_...
     [5]    402 ATGAGTGACAGCATCAACTTCTCT...CAGGACCCAGGCACAGGCATTAG lcl|NC_000001.11_...
     ...    ... ...
[114963]    297 ATGCCCCTCATTTACATAAATATT...ACCTAAACCTACTCCAATGCTAA lcl|NC_012920.1_c...
[114964]   1378 ATGCTAAAACTAATCGTCCCAACA...CATCATTACCGGGTTTTCCTCTT lcl|NC_012920.1_c...
[114965]   1812 ATAACCATGCACACTACTATAACC...TAACCCTACTCCTAATCACATAA lcl|NC_012920.1_c...
[114966]    525 ATGATGTATGCTTTGTTTCTGTTG...TTGAGATTGCTCGGGGGAATAGG lcl|NC_012920.1_c...
[114967]   1141 ATGACCCCAATACGCAAAACTAAC...AAACAAAATACTCAAATGGGCCT lcl|NC_012920.1_c...</code></pre>
</div>
<div id="example-ncbi-genbank-2" class="section level3">
<h3>Example <code>NCBI Genbank</code>:</h3>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb121-1" data-line-number="1"><span class="co"># download the genome of Homo sapiens from genbank</span></a>
<a class="sourceLine" id="cb121-2" data-line-number="2"><span class="co"># and store the corresponding genome CDS file in '_ncbi_downloads/CDS'</span></a>
<a class="sourceLine" id="cb121-3" data-line-number="3">HS.cds.genbank &lt;-<span class="st"> </span><span class="kw">getCDS</span>( <span class="dt">db       =</span> <span class="st">&quot;genbank&quot;</span>, </a>
<a class="sourceLine" id="cb121-4" data-line-number="4">                         <span class="dt">organism =</span> <span class="st">&quot;Homo sapiens&quot;</span>,</a>
<a class="sourceLine" id="cb121-5" data-line-number="5">                         <span class="dt">path     =</span> <span class="kw">file.path</span>(<span class="st">&quot;_ncbi_downloads&quot;</span>,<span class="st">&quot;CDS&quot;</span>))</a></code></pre></div>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb122-1" data-line-number="1"><span class="co"># import downloaded CDS as Biostrings object</span></a>
<a class="sourceLine" id="cb122-2" data-line-number="2">Human_CDS &lt;-<span class="st"> </span><span class="kw">read_cds</span>(<span class="dt">file     =</span> HS.cds.genbank, </a>
<a class="sourceLine" id="cb122-3" data-line-number="3">                      <span class="dt">obj.type =</span> <span class="st">&quot;Biostrings&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb123-1" data-line-number="1"><span class="co"># look at the Biostrings object</span></a>
<a class="sourceLine" id="cb123-2" data-line-number="2">Human_CDS</a></code></pre></div>
<pre><code>  A BStringSet instance of length 13
     width seq                                                     names               
 [1]   956 ATACCCATGGCCAACCTCCTACTCCT...ATCTCCAGCATTCCCCCTCAAACCTA lcl|J01415.2_cds_...
 [2]  1042 ATTAATCCCCTGGCCCAACCCGTCAT...CTCCCCTTTTATACTAATAATCTTAT lcl|J01415.2_cds_...
 [3]  1542 ATGTTCGCCGACCGTTGACTATTCTC...AAGAACCCGTATACATAAAATCTAGA lcl|J01415.2_cds_...
 [4]   684 ATGGCACATGCAGCGCAAGTAGGTCT...AAATAGGGCCCGTATTTACCCTATAG lcl|J01415.2_cds_...
 [5]   207 ATGCCCCAACTAAATACTACCGTATG...TTCATTCATTGCCCCCACAATCCTAG lcl|J01415.2_cds_...
 ...   ... ...
 [9]   297 ATGCCCCTCATTTACATAAATATTAT...ATAACCTAAACCTACTCCAATGCTAA lcl|J01415.2_cds_...
[10]  1378 ATGCTAAAACTAATCGTCCCAACAAT...CGACATCATTACCGGGTTTTCCTCTT lcl|J01415.2_cds_...
[11]  1812 ATAACCATGCACACTACTATAACCAC...TCCTAACCCTACTCCTAATCACATAA lcl|J01415.2_cds_...
[12]   525 ATGATGTATGCTTTGTTTCTGTTGAG...TAATTGAGATTGCTCGGGGGAATAGG lcl|J01415.2_cds_...
[13]  1141 ATGACCCCAATACGCAAAACTAACCC...TGAAAACAAAATACTCAAATGGGCCT lcl|J01415.2_cds_...</code></pre>
</div>
<div id="example-ensembl-2" class="section level3">
<h3>Example <code>ENSEMBL</code>:</h3>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb125-1" data-line-number="1"><span class="co"># download the genome of Homo sapiens from ensembl</span></a>
<a class="sourceLine" id="cb125-2" data-line-number="2"><span class="co"># and store the corresponding genome CDS file in '_ncbi_downloads/CDS'</span></a>
<a class="sourceLine" id="cb125-3" data-line-number="3">HS.cds.ensembl &lt;-<span class="st"> </span><span class="kw">getCDS</span>( <span class="dt">db       =</span> <span class="st">&quot;ensembl&quot;</span>, </a>
<a class="sourceLine" id="cb125-4" data-line-number="4">                         <span class="dt">organism =</span> <span class="st">&quot;Homo sapiens&quot;</span>,</a>
<a class="sourceLine" id="cb125-5" data-line-number="5">                         <span class="dt">path     =</span> <span class="kw">file.path</span>(<span class="st">&quot;_ncbi_downloads&quot;</span>,<span class="st">&quot;CDS&quot;</span>))</a></code></pre></div>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb126-1" data-line-number="1"><span class="co"># import downloaded CDS as Biostrings object</span></a>
<a class="sourceLine" id="cb126-2" data-line-number="2">Human_CDS &lt;-<span class="st"> </span><span class="kw">read_cds</span>(<span class="dt">file     =</span> HS.cds.ensembl, </a>
<a class="sourceLine" id="cb126-3" data-line-number="3">                      <span class="dt">obj.type =</span> <span class="st">&quot;Biostrings&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb127-1" data-line-number="1"><span class="co"># look at the Biostrings object</span></a>
<a class="sourceLine" id="cb127-2" data-line-number="2">Human_CDS</a></code></pre></div>
<pre><code>  A BStringSet instance of length 102915
          width seq                                                names               
     [1]     13 ACTGGGGGATACG                                      ENST00000448914.1...
     [2]     12 GGGACAGGGGGC                                       ENST00000631435.1...
     [3]     12 GGGACAGGGGGC                                       ENST00000632684.1...
     [4]      9 CCTTCCTAC                                          ENST00000434970.2...
     [5]      8 GAAATAGT                                           ENST00000415118.1...
     ...    ... ...
[102911]   1665 ATGCTACTGCCACTGCTGCTGTCC...ATGCAGAAGTCAAGTTCCAATGA ENST00000436984.6...
[102912]   1920 ATGCTACTGCCACTGCTGCTGTCC...ATGCAGAAGTCAAGTTCCAATGA ENST00000439889.6...
[102913]   2094 ATGCTACTGCCACTGCTGCTGTCC...ATGCAGAAGTCAAGTTCCAATGA ENST00000339313.9...
[102914]    466 ATGCTACTGCCACTGCTGCTGTCC...AGCCCTGGACCTCTCTGTGCAGT ENST00000529627.1...
[102915]    559 ATGCGGAGATGCTACTGCCACTGC...CCTCACCTGCCATGTGGACTTCT ENST00000530476.1...</code></pre>
<p>Users can also specify the <code>release</code> argument which denotes the database release version of ENSEMBL (<code>db = &quot;ensembl&quot;</code>) in case they wish to download archived vgenome versions. Default is release = NULL meaning that the most recent database version is used.</p>
</div>
<div id="cdsset-retrieval" class="section level3">
<h3>CDSSet Retrieval</h3>
<p>The <code>getCDSSet()</code> function enables users to retrieve CDS files for multiple species. This is convenient when users wish to bulk download a particular set of species. Internally, a folder named <code>set_cds</code> is generated in which CDS and CDS info files are stored. In addition, users can specify the arguments: <code>clean_retrieval</code> and <code>gunzip</code> (both are <code>TRUE</code> by default) to clean file names and automatically unzip downloaded files.</p>
<p>Example:</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb129-1" data-line-number="1"><span class="co"># specify the species names</span></a>
<a class="sourceLine" id="cb129-2" data-line-number="2">download_species &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Arabidopsis thaliana&quot;</span>, </a>
<a class="sourceLine" id="cb129-3" data-line-number="3">                      <span class="st">&quot;Arabidopsis lyrata&quot;</span>, </a>
<a class="sourceLine" id="cb129-4" data-line-number="4">                      <span class="st">&quot;Capsella rubella&quot;</span>)</a>
<a class="sourceLine" id="cb129-5" data-line-number="5"><span class="co"># retrieve these three species from NCBI RefSeq                       </span></a>
<a class="sourceLine" id="cb129-6" data-line-number="6">biomartr<span class="op">::</span><span class="kw">getCDSSet</span>(<span class="st">&quot;refseq&quot;</span>, <span class="dt">organisms =</span> download_species, <span class="dt">path =</span> <span class="st">&quot;set_cds&quot;</span>)</a></code></pre></div>
<p>If the download process was interrupted, users can re-run the function and it will only download missing genomes. In cases users wish to download everything again and updating existing genomes, they may specify the argument <code>update = TRUE</code>.</p>
</div>
<div id="rna-retrieval" class="section level3">
<h3>RNA Retrieval</h3>
<p>The <code>getRNA()</code> function is an interface function to the <a href="http://www.ncbi.nlm.nih.gov/refseq/about/">NCBI RefSeq</a>, <a href="http://www.ncbi.nlm.nih.gov/genbank/about/">NCBI Genbank</a>, <a href="http://www.ensembl.org/index.html">ENSEMBL</a> databases from which corresponding RNA files can be retrieved. It works analogous to <code>getGenome()</code>, <code>getProteome()</code>, and <code>getCDS()</code>.</p>
<p>The <code>db</code> argument specifies from which database proteomes in <code>*.fasta</code> file format shall be retrieved.</p>
<p>Options are:</p>
<ul>
<li><code>db = &quot;refseq&quot;</code> for retrieval from <a href="http://www.ncbi.nlm.nih.gov/refseq/about/">NCBI RefSeq</a></li>
<li><code>db = &quot;genbank&quot;</code> for retrieval from <a href="http://www.ncbi.nlm.nih.gov/genbank/about/">NCBI Genbank</a></li>
<li><code>db = &quot;ensembl&quot;</code> for retrieval from <a href="http://www.ensembl.org/index.html">ENSEMBL</a></li>
</ul>
<p>Furthermore, again users need to specify the scientific name of the organism of interest for which a proteomes shall be downloaded, e.g. <code>organism = &quot;Homo sapiens&quot;</code>. Finally, the <code>path</code> argument specifies the folder path in which the corresponding RNA file shall be locally stored. In case users would like to store the RNA file at a different location, they can specify the <code>path = file.path(&quot;put&quot;,&quot;your&quot;,&quot;path&quot;,&quot;here&quot;)</code> argument.</p>
</div>
<div id="example-ncbi-refseq-3" class="section level3">
<h3>Example <code>NCBI RefSeq</code>:</h3>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb130-1" data-line-number="1"><span class="co"># download the RNA of Homo sapiens from refseq</span></a>
<a class="sourceLine" id="cb130-2" data-line-number="2"><span class="co"># and store the corresponding RNA file in '_ncbi_downloads/RNA'</span></a>
<a class="sourceLine" id="cb130-3" data-line-number="3">HS.rna.refseq &lt;-<span class="st"> </span><span class="kw">getRNA</span>( <span class="dt">db       =</span> <span class="st">&quot;refseq&quot;</span>, </a>
<a class="sourceLine" id="cb130-4" data-line-number="4">                         <span class="dt">organism =</span> <span class="st">&quot;Homo sapiens&quot;</span>,</a>
<a class="sourceLine" id="cb130-5" data-line-number="5">                         <span class="dt">path     =</span> <span class="kw">file.path</span>(<span class="st">&quot;_ncbi_downloads&quot;</span>,<span class="st">&quot;RNA&quot;</span>))</a></code></pre></div>
<p>In this example, <code>getRNA()</code> creates a directory named <code>'_ncbi_downloads/RNA'</code> into which the corresponding RNA file named <code>Homo_sapiens_rna_from_genomic_refseq.fna.gz</code> is downloaded. The return value of <code>getRNA()</code> is the folder path to the downloaded genome file that can then be used as input to the <code>read_rna()</code> function. The variable <code>HS.rna.refseq</code> stores the path to the downloaded RNA file. Subsequently, users can use the <code>read_cds()</code> function to import the genome into the R session. Users can choose to work with the genome sequence in R either as <a href="http://bioconductor.org/packages/release/bioc/html/Biostrings.html">Biostrings</a> object (<code>obj.type = &quot;Biostrings&quot;</code>) or <a href="https://github.com/Rdatatable/data.table/wiki">data.table</a> object (<code>obj.type = &quot;data.table&quot;</code>) by specifying the <code>obj.type</code> argument of the <code>read_rna()</code> function.</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb131-1" data-line-number="1"><span class="co"># import downloaded RNA as Biostrings object</span></a>
<a class="sourceLine" id="cb131-2" data-line-number="2">Human_rna &lt;-<span class="st"> </span><span class="kw">read_rna</span>(<span class="dt">file     =</span> HS.rna.refseq, </a>
<a class="sourceLine" id="cb131-3" data-line-number="3">                      <span class="dt">obj.type =</span> <span class="st">&quot;Biostrings&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb132-1" data-line-number="1"><span class="co"># look at the Biostrings object</span></a>
<a class="sourceLine" id="cb132-2" data-line-number="2">Human_rna</a></code></pre></div>
<pre><code>   A BStringSet instance of length 164136
          width seq                                                                                       names               
     [1]   1652 CTTGCCGTCAGCCTTTTCTTTGACCTCTTCTTTCTGTTCATGT...CACAGCTAGAGATCCTTTATTAAAAGCACACTGTTGGTTTCTG lcl|NC_000001.11_...
     [2]   1769 TCCGGCAGAGCGGAAGCGGCGGCGGGAGCTTCCGGGAGGGCGG...ACCAACAGTGTGCTTTTAATAAAGGATCTCTAGCTGTGCAGGA lcl|NC_000001.11_...
     [3]     68 TGTGGGAGAGGAACATGGGCTCAGGACAGCGGGTGTCAGCTTGCCTGACCCCCATGTCGCCTCTGTAG                      lcl|NC_000001.11_...
     [4]     23 TGACCCCCATGTCGCCTCTGTAG                                                                   lcl|NC_000001.11_...
     [5]     23 GAGAGGAACATGGGCTCAGGACA                                                                   lcl|NC_000001.11_...
     ...    ... ...
[164132]     59 GAGAAAGCTCACAAGAACTGCTAACTCATGCCCCCATGTCTAACAACATGGCTTTCTCA                               lcl|NC_012920.1_t...
[164133]     71 ACTTTTAAAGGATAACAGCTATCCATTGGTCTTAGGCCCCAAAAATTTTGGTGCAACTCCAAATAAAAGTA                   lcl|NC_012920.1_t...
[164134]     69 GTTCTTGTAGTTGAAATACAACGATGGTTTTTCATATCATTGGTCGTGGTTGTAGTCCGTGCGAGAATA                     lcl|NC_012920.1_t...
[164135]     66 GTCCTTGTAGTATAAACTAATACACCAGTCTTGTAAACCGGAGATGAAAACCTTTTTCCAAGGACA                        lcl|NC_012920.1_t...
[164136]     68 CAGAGAATAGTTTAAATTAGAATCTTAGCTTTGGGTGCTAATGGTGGAGTTAAAGACTTTTTCTCTGA                      lcl|NC_012920.1_t...</code></pre>
<p>Internally, a text file named <code>doc_Homo_sapiens_db_refseq.txt</code> is generated. The information stored in this log file is structured as follows:</p>
<pre><code>File Name: Homo_sapiens_rna_from_genomic_refseq.fna.gz
Organism Name: Homo_sapiens
Database: NCBI refseq
URL: ftp://ftp.ncbi.nlm.nih.gov/genomes/all/GCF/000/001/405/GCF_000001405.36_GRCh38.p10/GCF_000001405.36_GRCh38.p10_rna_from_genomic.fna.gz
Download_Date: Wed Mar 15 16:46:45 2017
refseq_category: reference genome
assembly_accession: GCF_000001405.36
bioproject: PRJNA168
biosample: NA
taxid: 9606
infraspecific_name: NA
version_status: latest
release_type: Patch
genome_rep: Full
seq_rel_date: 2017-01-06
submitter: Genome Reference Consortium</code></pre>
<p>In summary, the <code>getRNA()</code> and <code>read_rna()</code> functions allow users to retrieve RNA files by specifying the scientific name of the organism of interest and allow them to import the retrieved RNA file e.g. as <code>Biostrings</code> object. Thus, users can then perform the <code>Biostrings notation</code> to work with downloaded RNA and can rely on the log file generated by <code>getRNA()</code> to better document the source and version of RNA used for subsequent studies.</p>
<p>Alternatively, users can perform the pipeline logic of the <a href="https://github.com/smbache/magrittr">magrittr</a> package:</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb135-1" data-line-number="1"><span class="co"># install.packages(&quot;magrittr&quot;)</span></a>
<a class="sourceLine" id="cb135-2" data-line-number="2"><span class="kw">library</span>(magrittr)</a>
<a class="sourceLine" id="cb135-3" data-line-number="3"><span class="co"># import RNA as Biostrings object</span></a>
<a class="sourceLine" id="cb135-4" data-line-number="4">Human_rna &lt;-<span class="st"> </span><span class="kw">getRNA</span>( <span class="dt">db       =</span> <span class="st">&quot;refseq&quot;</span>, </a>
<a class="sourceLine" id="cb135-5" data-line-number="5">                     <span class="dt">organism =</span> <span class="st">&quot;Homo sapiens&quot;</span>,</a>
<a class="sourceLine" id="cb135-6" data-line-number="6">                     <span class="dt">path     =</span> <span class="kw">file.path</span>(<span class="st">&quot;_ncbi_downloads&quot;</span>,<span class="st">&quot;RNA&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb135-7" data-line-number="7"><span class="st">    </span><span class="kw">read_cds</span>(<span class="dt">obj.type =</span> <span class="st">&quot;Biostrings&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb136-1" data-line-number="1">Human_rna</a></code></pre></div>
<pre><code>   A BStringSet instance of length 164136
          width seq                                                                                       names               
     [1]   1652 CTTGCCGTCAGCCTTTTCTTTGACCTCTTCTTTCTGTTCATGT...CACAGCTAGAGATCCTTTATTAAAAGCACACTGTTGGTTTCTG lcl|NC_000001.11_...
     [2]   1769 TCCGGCAGAGCGGAAGCGGCGGCGGGAGCTTCCGGGAGGGCGG...ACCAACAGTGTGCTTTTAATAAAGGATCTCTAGCTGTGCAGGA lcl|NC_000001.11_...
     [3]     68 TGTGGGAGAGGAACATGGGCTCAGGACAGCGGGTGTCAGCTTGCCTGACCCCCATGTCGCCTCTGTAG                      lcl|NC_000001.11_...
     [4]     23 TGACCCCCATGTCGCCTCTGTAG                                                                   lcl|NC_000001.11_...
     [5]     23 GAGAGGAACATGGGCTCAGGACA                                                                   lcl|NC_000001.11_...
     ...    ... ...
[164132]     59 GAGAAAGCTCACAAGAACTGCTAACTCATGCCCCCATGTCTAACAACATGGCTTTCTCA                               lcl|NC_012920.1_t...
[164133]     71 ACTTTTAAAGGATAACAGCTATCCATTGGTCTTAGGCCCCAAAAATTTTGGTGCAACTCCAAATAAAAGTA                   lcl|NC_012920.1_t...
[164134]     69 GTTCTTGTAGTTGAAATACAACGATGGTTTTTCATATCATTGGTCGTGGTTGTAGTCCGTGCGAGAATA                     lcl|NC_012920.1_t...
[164135]     66 GTCCTTGTAGTATAAACTAATACACCAGTCTTGTAAACCGGAGATGAAAACCTTTTTCCAAGGACA                        lcl|NC_012920.1_t...
[164136]     68 CAGAGAATAGTTTAAATTAGAATCTTAGCTTTGGGTGCTAATGGTGGAGTTAAAGACTTTTTCTCTGA                      lcl|NC_012920.1_t...</code></pre>
</div>
<div id="example-ncbi-genbank-3" class="section level3">
<h3>Example <code>NCBI Genbank</code>:</h3>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb138-1" data-line-number="1"><span class="co"># download the RNA of Homo sapiens from genbank</span></a>
<a class="sourceLine" id="cb138-2" data-line-number="2"><span class="co"># and store the corresponding genome RNA file in '_ncbi_downloads/RNA'</span></a>
<a class="sourceLine" id="cb138-3" data-line-number="3">HS.rna.genbank &lt;-<span class="st"> </span><span class="kw">getRNA</span>( <span class="dt">db       =</span> <span class="st">&quot;genbank&quot;</span>, </a>
<a class="sourceLine" id="cb138-4" data-line-number="4">                         <span class="dt">organism =</span> <span class="st">&quot;Homo sapiens&quot;</span>,</a>
<a class="sourceLine" id="cb138-5" data-line-number="5">                         <span class="dt">path     =</span> <span class="kw">file.path</span>(<span class="st">&quot;_ncbi_downloads&quot;</span>,<span class="st">&quot;RNA&quot;</span>))</a></code></pre></div>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb139-1" data-line-number="1"><span class="co"># import downloaded RNA as Biostrings object</span></a>
<a class="sourceLine" id="cb139-2" data-line-number="2">Human_rna &lt;-<span class="st"> </span><span class="kw">read_cds</span>(<span class="dt">file     =</span> HS.rna.genbank, </a>
<a class="sourceLine" id="cb139-3" data-line-number="3">                      <span class="dt">obj.type =</span> <span class="st">&quot;Biostrings&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb140-1" data-line-number="1"><span class="co"># look at the Biostrings object</span></a>
<a class="sourceLine" id="cb140-2" data-line-number="2">Human_rna</a></code></pre></div>
<pre><code>  A BStringSet instance of length 24
     width seq                                                                                            names               
 [1]    71 GTTTATGTAGCTTACCTCCTCAAAGCAATACACTGAAAATGTTTAGACGGGCTCACATCACCCCATAAACA                        lcl|J01415.2_trna...
 [2]   954 AATAGGTTTGGTCCTAGCCTTTCTATTAGCTCTTAGTAAGATTACA...AAGTCGTAACATGGTAAGTGTACTGGAAAGTGCACTTGGACGAAC lcl|J01415.2_rrna...
 [3]    69 CAGAGTGTAGCTTAACACAAAGCACCCAACTTACACTTAGGAGATTTCAACTTAACTTGACCGCTCTGA                          lcl|J01415.2_trna...
 [4]  1559 GCTAAACCTAGCCCCAAACCCACTCCACCTTACTACCAGACAACCT...ATCTCAACTTAGTATTATACCCACACCCACCCAAGAACAGGGTTT lcl|J01415.2_rrna...
 [5]    75 GTTAAGATGGCAGAGCCCGGTAATCGCATAAAACTTAAAACTTTACAGTCAGAGGTTCAATTCCTCTTCTTAACA                    lcl|J01415.2_trna...
 ...   ... ...
[20]    59 GAGAAAGCTCACAAGAACTGCTAACTCATGCCCCCATGTCTAACAACATGGCTTTCTCA                                    lcl|J01415.2_trna...
[21]    71 ACTTTTAAAGGATAACAGCTATCCATTGGTCTTAGGCCCCAAAAATTTTGGTGCAACTCCAAATAAAAGTA                        lcl|J01415.2_trna...
[22]    69 GTTCTTGTAGTTGAAATACAACGATGGTTTTTCATATCATTGGTCGTGGTTGTAGTCCGTGCGAGAATA                          lcl|J01415.2_trna...
[23]    66 GTCCTTGTAGTATAAACTAATACACCAGTCTTGTAAACCGGAGATGAAAACCTTTTTCCAAGGACA                             lcl|J01415.2_trna...
[24]    68 CAGAGAATAGTTTAAATTAGAATCTTAGCTTTGGGTGCTAATGGTGGAGTTAAAGACTTTTTCTCTGA                           lcl|J01415.2_trna...</code></pre>
</div>
<div id="example-ensembl-3" class="section level3">
<h3>Example <code>ENSEMBL</code>:</h3>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb142-1" data-line-number="1"><span class="co"># download the RNA of Homo sapiens from ensembl</span></a>
<a class="sourceLine" id="cb142-2" data-line-number="2"><span class="co"># and store the corresponding genome RNA file in '_ncbi_downloads/RNA'</span></a>
<a class="sourceLine" id="cb142-3" data-line-number="3">HS.rna.ensembl &lt;-<span class="st"> </span><span class="kw">getRNA</span>( <span class="dt">db       =</span> <span class="st">&quot;ensembl&quot;</span>, </a>
<a class="sourceLine" id="cb142-4" data-line-number="4">                          <span class="dt">organism =</span> <span class="st">&quot;Homo sapiens&quot;</span>,</a>
<a class="sourceLine" id="cb142-5" data-line-number="5">                          <span class="dt">path     =</span> <span class="kw">file.path</span>(<span class="st">&quot;_ncbi_downloads&quot;</span>,<span class="st">&quot;RNA&quot;</span>))</a></code></pre></div>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb143-1" data-line-number="1"><span class="co"># import downloaded RNA as Biostrings object</span></a>
<a class="sourceLine" id="cb143-2" data-line-number="2">Human_rna &lt;-<span class="st"> </span><span class="kw">read_cds</span>(<span class="dt">file     =</span> HS.rna.ensembl, </a>
<a class="sourceLine" id="cb143-3" data-line-number="3">                      <span class="dt">obj.type =</span> <span class="st">&quot;Biostrings&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb144-1" data-line-number="1"><span class="co"># look at the Biostrings object</span></a>
<a class="sourceLine" id="cb144-2" data-line-number="2">Human_rna</a></code></pre></div>
<pre><code>  A BStringSet instance of length 36701
         width seq                                                                                        names               
    [1]    104 GTGCTCACTTTGGCAACATACATACTAAAATTGGACGGATACAG...GCACAAGGATGACATGCAAATTCATGAAGCATTCCATATTTTT ENST00000516494.2...
    [2]    164 TTAACTACCTGACAGAGGAGATACTGTGATCATGAAAGTGGTTT...CATAATTTCTGGTGGTAGGGGACTGCGTTCATGTTCTCCCCTA ENST00000627793.1...
    [3]    114 ACACTGGTTTCTCTTCAGATCGAATAAATCTTTCGCCTTTTACT...AGTTATAAGCTAATTTTTTGTAAGCCTTGCCCTGGGGAGGCAG ENST00000629478.1...
    [4]     64 CAGTGTTACACCTCTTTTAGAATTTATCTATCAGGTTTTCCAGTGTTCACTGAAATTTGTCTCT                           ENST00000629187.1...
    [5]    107 GTGTTGGCCTGGGCAGCACGTATACTAAAGTTGGAATGACACAG...GCGCAAGGATGATGTGCAAATTCGTGACAAGTTCCATATTTTT ENST00000631612.1...
    ...    ... ...
[36697]     90 GGCTAGTCCAAATGTAGTGGTGTTCCAAACTAATTAATCACAACCAGTTACAGATTTCTTGTTTTCTTTTCCACTCACACTTAGCCTTAA ENST00000410951.1...
[36698]    109 GGCTGATCTGAAGATGATGAGTTATCTCAATTGATTGTTCAGCC...TCTATTCTTTCCTCTCTTCTCACTACTGCACTTGGCTAGGAAA ENST00000410462.2...
[36699]    109 GGTGGGTCCAAAGGTAGCAAGTTATCTCAATTGATCACAGTCAG...CATTCTATCACCCCTTCTCATTACTGTACTTGACTAGTCTTTT ENST00000364501.1...
[36700]    293 GGATATGAGGGCGATCTGGCAGGGACATCTGTCACCCCACTGAT...AAAATTAGCTGGGCATAGTGGCGTGCACCTGTCGTCCTAGCTA ENST00000365097.1...
[36701]    172 TTGAAGGCGTGGAGACTGAAGTCCTCTCTATATCCACAGAACAG...AAGAGGGCTGTTCAGTCTCCATGCCCTTCAATCCTTGGCTACT ENST00000615087.1...</code></pre>
<p>Users can also specify the <code>release</code> argument which denotes the database release version of ENSEMBL (<code>db = &quot;ensembl&quot;</code>) in case they wish to download archived vgenome versions. Default is release = NULL meaning that the most recent database version is used.</p>
</div>
<div id="rnaset-retrieval" class="section level3">
<h3>RNASet Retrieval</h3>
<p>The <code>getRNASet()</code> function enables users to retrieve RNA files for multiple species. This is convenient when users wish to bulk download a particular set of species. Internally, a folder named <code>set_rna</code> is generated in which RNA and RNA info files are stored. In addition, users can specify the arguments: <code>clean_retrieval</code> and <code>gunzip</code> (both are <code>TRUE</code> by default) to clean file names and automatically unzip downloaded files.</p>
<p>Example:</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb146-1" data-line-number="1"><span class="co"># specify the species names</span></a>
<a class="sourceLine" id="cb146-2" data-line-number="2">download_species &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Arabidopsis thaliana&quot;</span>, </a>
<a class="sourceLine" id="cb146-3" data-line-number="3">                      <span class="st">&quot;Arabidopsis lyrata&quot;</span>, </a>
<a class="sourceLine" id="cb146-4" data-line-number="4">                      <span class="st">&quot;Capsella rubella&quot;</span>)</a>
<a class="sourceLine" id="cb146-5" data-line-number="5"><span class="co"># retrieve these three species from NCBI RefSeq                       </span></a>
<a class="sourceLine" id="cb146-6" data-line-number="6">biomartr<span class="op">::</span><span class="kw">getRNASet</span>(<span class="st">&quot;refseq&quot;</span>, <span class="dt">organisms =</span> download_species, <span class="dt">path =</span> <span class="st">&quot;set_rna&quot;</span>)</a></code></pre></div>
<p>If the download process was interrupted, users can re-run the function and it will only download missing genomes. In cases users wish to download everything again and updating existing genomes, they may specify the argument <code>update = TRUE</code>.</p>
</div>
<div id="retrieve-the-annotation-file-of-a-particular-genome" class="section level3">
<h3>Retrieve the annotation file of a particular genome</h3>
<p>Finally, users can download the corresponding annotation <code>.gff</code> files for particular genomes of interest using the <code>getGFF()</code> or alternatively for <code>ensembl</code> the <code>getGTF()</code> function.</p>
</div>
<div id="example-ncbi-refseq-4" class="section level3">
<h3>Example <code>NCBI RefSeq</code>:</h3>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb147-1" data-line-number="1"><span class="co"># download the GFF file of Homo sapiens from refseq</span></a>
<a class="sourceLine" id="cb147-2" data-line-number="2"><span class="co"># and store the corresponding file in '_ncbi_downloads/annotation'</span></a>
<a class="sourceLine" id="cb147-3" data-line-number="3">HS.gff.refseq &lt;-<span class="st"> </span><span class="kw">getGFF</span>( <span class="dt">db       =</span> <span class="st">&quot;refseq&quot;</span>, </a>
<a class="sourceLine" id="cb147-4" data-line-number="4">                         <span class="dt">organism =</span> <span class="st">&quot;Homo sapiens&quot;</span>, </a>
<a class="sourceLine" id="cb147-5" data-line-number="5">                         <span class="dt">path =</span> <span class="kw">file.path</span>(<span class="st">&quot;_ncbi_downloads&quot;</span>,<span class="st">&quot;annotation&quot;</span>))</a></code></pre></div>
<p>After downloading the <code>.gff</code> file, users can import the <code>.gff</code> file with <code>read_gff()</code>.</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb148-1" data-line-number="1"><span class="co"># import downloaded GFF file</span></a>
<a class="sourceLine" id="cb148-2" data-line-number="2">Human_GFF &lt;-<span class="st"> </span><span class="kw">read_gff</span>(<span class="dt">file =</span> HS.gff.refseq)</a></code></pre></div>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb149-1" data-line-number="1">Human_GFF</a></code></pre></div>
<pre><code>          seqid     source       type start       end score strand phase
          &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt; &lt;int&gt;     &lt;int&gt; &lt;dbl&gt;  &lt;chr&gt; &lt;dbl&gt;
1  NC_000001.11     RefSeq     region     1 248956422     0      +     0
2  NC_000001.11 BestRefSeq       gene 11874     14409     0      +     0
3  NC_000001.11 BestRefSeq transcript 11874     14409     0      +     0
4  NC_000001.11 BestRefSeq       exon 11874     12227     0      +     0
5  NC_000001.11 BestRefSeq       exon 12613     12721     0      +     0
6  NC_000001.11 BestRefSeq       exon 13221     14409     0      +     0
7  NC_000001.11 BestRefSeq       gene 14362     29370     0      -     0
8  NC_000001.11 BestRefSeq transcript 14362     29370     0      -     0
9  NC_000001.11 BestRefSeq       exon 29321     29370     0      -     0
10 NC_000001.11 BestRefSeq       exon 24738     24891     0      -     0</code></pre>
</div>
<div id="example-ncbi-genbank-4" class="section level3">
<h3>Example <code>NCBI Genbank</code>:</h3>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb151-1" data-line-number="1"><span class="co"># download the GFF file of Homo sapiens from genbank</span></a>
<a class="sourceLine" id="cb151-2" data-line-number="2"><span class="co"># and store the corresponding file in '_ncbi_downloads/annotation'</span></a>
<a class="sourceLine" id="cb151-3" data-line-number="3">HS.gff.genbank &lt;-<span class="st"> </span><span class="kw">getGFF</span>( <span class="dt">db       =</span> <span class="st">&quot;genbank&quot;</span>, </a>
<a class="sourceLine" id="cb151-4" data-line-number="4">                         <span class="dt">organism =</span> <span class="st">&quot;Homo sapiens&quot;</span>, </a>
<a class="sourceLine" id="cb151-5" data-line-number="5">                         <span class="dt">path =</span> <span class="kw">file.path</span>(<span class="st">&quot;_ncbi_downloads&quot;</span>,<span class="st">&quot;annotation&quot;</span>))</a></code></pre></div>
<p>After downloading the <code>.gff</code> file, users can import the <code>.gff</code> file with <code>read_gff()</code>.</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb152-1" data-line-number="1"><span class="co"># import downloaded GFF file</span></a>
<a class="sourceLine" id="cb152-2" data-line-number="2">Human_GFF &lt;-<span class="st"> </span><span class="kw">read_gff</span>(<span class="dt">file =</span> HS.gff.genbank)</a></code></pre></div>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb153-1" data-line-number="1"><span class="co"># show all elements of the data.frame</span></a>
<a class="sourceLine" id="cb153-2" data-line-number="2"><span class="co"># options(tibble.print_max = Inf)</span></a>
<a class="sourceLine" id="cb153-3" data-line-number="3">Human_GFF</a></code></pre></div>
<pre><code>        seqid  source       type     start       end score strand phase
        &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;     &lt;int&gt;     &lt;int&gt; &lt;dbl&gt;  &lt;chr&gt; &lt;dbl&gt;
1  CM000663.2 Genbank     region         1 248956422     0      +     0
2  CM000663.2 Genbank centromere 122026460 125184587     0      +     0
3  KI270706.1 Genbank     region         1    175055     0      +     0
4  KI270707.1 Genbank     region         1     32032     0      +     0
5  KI270708.1 Genbank     region         1    127682     0      +     0
6  KI270709.1 Genbank     region         1     66860     0      +     0
7  KI270710.1 Genbank     region         1     40176     0      +     0
8  KI270711.1 Genbank     region         1     42210     0      +     0
9  KI270712.1 Genbank     region         1    176043     0      +     0
10 KI270713.1 Genbank     region         1     40745     0      +     0</code></pre>
</div>
<div id="example-ensembl-4" class="section level3">
<h3>Example <code>ENSEMBL</code>:</h3>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb155-1" data-line-number="1"><span class="co"># download the GFF file of Homo sapiens from ENSEMBL</span></a>
<a class="sourceLine" id="cb155-2" data-line-number="2"><span class="co"># and store the corresponding file in 'ensembl/annotation'</span></a>
<a class="sourceLine" id="cb155-3" data-line-number="3">HS.gff.ensembl &lt;-<span class="st"> </span><span class="kw">getGFF</span>( <span class="dt">db       =</span> <span class="st">&quot;ensembl&quot;</span>, </a>
<a class="sourceLine" id="cb155-4" data-line-number="4">                         <span class="dt">organism =</span> <span class="st">&quot;Homo sapiens&quot;</span>, </a>
<a class="sourceLine" id="cb155-5" data-line-number="5">                         <span class="dt">path =</span> <span class="kw">file.path</span>(<span class="st">&quot;ensembl&quot;</span>,<span class="st">&quot;annotation&quot;</span>))</a></code></pre></div>
<p>After downloading the <code>.gff</code> file, users can import the <code>.gff</code> file with <code>read_gff()</code>.</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb156-1" data-line-number="1"><span class="co"># import downloaded GFF file</span></a>
<a class="sourceLine" id="cb156-2" data-line-number="2">Human_GFF &lt;-<span class="st"> </span><span class="kw">read_gff</span>(<span class="dt">file =</span> HS.gff.ensembl)</a></code></pre></div>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb157-1" data-line-number="1"><span class="co"># show all elements of the data.frame</span></a>
<a class="sourceLine" id="cb157-2" data-line-number="2"><span class="co"># options(tibble.print_max = Inf)</span></a>
<a class="sourceLine" id="cb157-3" data-line-number="3">Human_GFF</a></code></pre></div>
<pre><code>   seqid source              type start       end   score strand phase
   &lt;int&gt;  &lt;chr&gt;             &lt;chr&gt; &lt;int&gt;     &lt;int&gt;   &lt;chr&gt;  &lt;chr&gt; &lt;dbl&gt;
1      1 GRCh38        chromosome     1 248956422       .      .     0
2      1      . biological_region 10469     11240 1.3e+03      .     0
3      1      . biological_region 10650     10657   0.999      +     0
4      1      . biological_region 10655     10657   0.999      -     0
5      1      . biological_region 10678     10687   0.999      +     0
6      1      . biological_region 10681     10688   0.999      -     0
7      1      . biological_region 10707     10716   0.999      +     0
8      1      . biological_region 10708     10718   0.999      -     0
9      1      . biological_region 10735     10747   0.999      -     0
10     1      . biological_region 10737     10744   0.999      +     0</code></pre>
<p>Users can also specify the <code>release</code> argument which denotes the database release version of ENSEMBL (<code>db = &quot;ensembl&quot;</code>) in case they wish to download archived vgenome versions. Default is release = NULL meaning that the most recent database version is used.</p>
<p>Alternatively for <code>getGTF()</code>:</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb159-1" data-line-number="1"><span class="co"># download the GTF file of Homo sapiens from ENSEMBL</span></a>
<a class="sourceLine" id="cb159-2" data-line-number="2"><span class="co"># and store the corresponding file in 'ensembl/annotation'</span></a>
<a class="sourceLine" id="cb159-3" data-line-number="3">HS.gtf.ensembl &lt;-<span class="st"> </span><span class="kw">getGTF</span>( <span class="dt">db       =</span> <span class="st">&quot;ensembl&quot;</span>, </a>
<a class="sourceLine" id="cb159-4" data-line-number="4">                         <span class="dt">organism =</span> <span class="st">&quot;Homo sapiens&quot;</span>, </a>
<a class="sourceLine" id="cb159-5" data-line-number="5">                         <span class="dt">path =</span> <span class="kw">file.path</span>(<span class="st">&quot;ensembl&quot;</span>,<span class="st">&quot;annotation&quot;</span>))</a></code></pre></div>
<p>Taken together, <code>getGFF()</code> or <code>getGTF()</code> in combination with <code>getGenome()</code>, <code>getProteome()</code>, <code>getRNA()</code> and <code>getCDS()</code> allows users to retrieve the genome information together with the corresponding <code>.gff</code> or <code>gtf</code> annotation file to make sure that they both have the same version and origin.</p>
</div>
<div id="gffset-retrieval" class="section level3">
<h3>GFFSet Retrieval</h3>
<p>The <code>getGFFSet()</code> function enables users to retrieve GFF files for multiple species. This is convenient when users wish to bulk download a particular set of species. Internally, a folder named <code>set_gff</code> is generated in which GFF and GFF info files are stored. In addition, users can specify the arguments: <code>clean_retrieval</code> and <code>gunzip</code> (both are <code>TRUE</code> by default) to clean file names and automatically unzip downloaded files.</p>
<p>Example:</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb160-1" data-line-number="1"><span class="co"># specify the species names</span></a>
<a class="sourceLine" id="cb160-2" data-line-number="2">download_species &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Arabidopsis thaliana&quot;</span>, </a>
<a class="sourceLine" id="cb160-3" data-line-number="3">                      <span class="st">&quot;Arabidopsis lyrata&quot;</span>, </a>
<a class="sourceLine" id="cb160-4" data-line-number="4">                      <span class="st">&quot;Capsella rubella&quot;</span>)</a>
<a class="sourceLine" id="cb160-5" data-line-number="5"><span class="co"># retrieve these three species from NCBI RefSeq                       </span></a>
<a class="sourceLine" id="cb160-6" data-line-number="6">biomartr<span class="op">::</span><span class="kw">getGFFSet</span>(<span class="st">&quot;refseq&quot;</span>, <span class="dt">organisms =</span> download_species, <span class="dt">path =</span> <span class="st">&quot;set_gff&quot;</span>)</a></code></pre></div>
<p>If the download process was interrupted, users can re-run the function and it will only download missing genomes. In cases users wish to download everything again and updating existing genomes, they may specify the argument <code>update = TRUE</code>.</p>
</div>
</div>
<div id="repeat-masker-retrieval" class="section level2">
<h2>Repeat Masker Retrieval</h2>
<p><a href="http://www.repeatmasker.org">Repeat Masker</a> is a tool for screening DNA sequences for interspersed repeats and low complexity DNA sequences. NCBI stores the <code>Repeat Masker</code> for sevel species in their databases and can be retrieved using <code>getRepeatMasker()</code> and imported via <code>read_rm()</code>.</p>
<div id="example-ncbi-refseq-5" class="section level3">
<h3>Example <code>NCBI RefSeq</code>:</h3>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb161-1" data-line-number="1"><span class="co"># download repeat masker annotation file for Homo sapiens</span></a>
<a class="sourceLine" id="cb161-2" data-line-number="2">Hsapiens_rm &lt;-<span class="st"> </span><span class="kw">getRepeatMasker</span>( <span class="dt">db       =</span> <span class="st">&quot;refseq&quot;</span>, </a>
<a class="sourceLine" id="cb161-3" data-line-number="3">                                 <span class="dt">organism =</span> <span class="st">&quot;Homo sapiens&quot;</span>, </a>
<a class="sourceLine" id="cb161-4" data-line-number="4">                                 <span class="dt">path =</span> <span class="kw">file.path</span>(<span class="st">&quot;refseq&quot;</span>,<span class="st">&quot;TEannotation&quot;</span>))</a></code></pre></div>
<p>Now users can import the TE annotation file using <code>read_rm()</code>.</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb162-1" data-line-number="1"><span class="co"># import TE annotation file</span></a>
<a class="sourceLine" id="cb162-2" data-line-number="2">Hsapiens_rm_import &lt;-<span class="st"> </span><span class="kw">read_rm</span>(<span class="st">&quot;refseq/TEannotation/Homo_sapiens_rm_refseq.out.gz&quot;</span>)</a>
<a class="sourceLine" id="cb162-3" data-line-number="3"><span class="co"># look at data</span></a>
<a class="sourceLine" id="cb162-4" data-line-number="4">Hsapiens_rm_import</a></code></pre></div>
</div>
</div>
<div id="genome-assembly-stats-retrieval" class="section level2">
<h2>Genome Assembly Stats Retrieval</h2>
<p>By specifying the scientific name of an organism of interest the corresponding genome assembly stats file storing the assembly statistics of the organism of interest can be downloaded and stored locally.</p>
<div id="example-ncbi-refseq-6" class="section level3">
<h3>Example <code>NCBI RefSeq</code>:</h3>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb163-1" data-line-number="1"><span class="co"># download genome assembly stats file for Homo sapiens</span></a>
<a class="sourceLine" id="cb163-2" data-line-number="2">Hsapiens_stats &lt;-<span class="st"> </span><span class="kw">getAssemblyStats</span>( <span class="dt">db       =</span> <span class="st">&quot;refseq&quot;</span>, </a>
<a class="sourceLine" id="cb163-3" data-line-number="3">                                 <span class="dt">organism =</span> <span class="st">&quot;Homo sapiens&quot;</span>, </a>
<a class="sourceLine" id="cb163-4" data-line-number="4">                                 <span class="dt">path =</span> <span class="kw">file.path</span>(<span class="st">&quot;refseq&quot;</span>,<span class="st">&quot;AssemblyStats&quot;</span>))</a></code></pre></div>
<p>Now users can import the TE annotation file using <code>read_rm()</code>.</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb164-1" data-line-number="1"><span class="co"># import TE annotation file</span></a>
<a class="sourceLine" id="cb164-2" data-line-number="2">Hsapiens_stats_import &lt;-<span class="st"> </span><span class="kw">read_assemblystats</span>(Hsapiens_stats)</a>
<a class="sourceLine" id="cb164-3" data-line-number="3"><span class="co"># look at data</span></a>
<a class="sourceLine" id="cb164-4" data-line-number="4">Hsapiens_stats_import</a></code></pre></div>
<pre><code> A tibble: 1,196 x 6
   unit_name molecule_name molecule_type sequence_type statistic         value
   &lt;chr&gt;     &lt;chr&gt;         &lt;chr&gt;         &lt;chr&gt;         &lt;chr&gt;             &lt;int&gt;
 1 all       all           all           all           total-length         NA
 2 all       all           all           all           spanned-gaps        661
 3 all       all           all           all           unspanned-gaps      349
 4 all       all           all           all           region-count        317
 5 all       all           all           all           scaffold-count      875
 6 all       all           all           all           scaffold-N50   59364414
 7 all       all           all           all           scaffold-L50         17
 8 all       all           all           all           scaffold-N75   31699399
 9 all       all           all           all           scaffold-N90    7557127
10 all       all           all           all           contig-count       1536</code></pre>
</div>
<div id="example-ncbi-genbank-5" class="section level3">
<h3>Example <code>NCBI Genbank</code>:</h3>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb166-1" data-line-number="1"><span class="co"># download genome assembly stats file for Homo sapiens</span></a>
<a class="sourceLine" id="cb166-2" data-line-number="2">Hsapiens_stats &lt;-<span class="st"> </span><span class="kw">getAssemblyStats</span>( <span class="dt">db       =</span> <span class="st">&quot;genbank&quot;</span>, </a>
<a class="sourceLine" id="cb166-3" data-line-number="3">                                 <span class="dt">organism =</span> <span class="st">&quot;Homo sapiens&quot;</span>, </a>
<a class="sourceLine" id="cb166-4" data-line-number="4">                                 <span class="dt">path =</span> <span class="kw">file.path</span>(<span class="st">&quot;genbank&quot;</span>,<span class="st">&quot;AssemblyStats&quot;</span>))</a></code></pre></div>
<p>Now users can import the TE annotation file using <code>read_rm()</code>.</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb167-1" data-line-number="1"><span class="co"># import TE annotation file</span></a>
<a class="sourceLine" id="cb167-2" data-line-number="2">Hsapiens_stats_import &lt;-<span class="st"> </span><span class="kw">read_assemblystats</span>(Hsapiens_stats)</a>
<a class="sourceLine" id="cb167-3" data-line-number="3"><span class="co"># look at data</span></a>
<a class="sourceLine" id="cb167-4" data-line-number="4">Hsapiens_stats_import</a></code></pre></div>
<pre><code> A tibble: 1,196 x 6
   unit_name molecule_name molecule_type sequence_type statistic         value
   &lt;chr&gt;     &lt;chr&gt;         &lt;chr&gt;         &lt;chr&gt;         &lt;chr&gt;             &lt;int&gt;
 1 all       all           all           all           total-length         NA
 2 all       all           all           all           spanned-gaps        661
 3 all       all           all           all           unspanned-gaps      349
 4 all       all           all           all           region-count        317
 5 all       all           all           all           scaffold-count      875
 6 all       all           all           all           scaffold-N50   59364414
 7 all       all           all           all           scaffold-L50         17
 8 all       all           all           all           scaffold-N75   31699399
 9 all       all           all           all           scaffold-N90    7557127
10 all       all           all           all           contig-count       1536</code></pre>
</div>
</div>
<div id="collection-retrieval" class="section level2">
<h2>Collection Retrieval</h2>
<p>The automated retrieval of collections (= Genome, Proteome, CDS, RNA, GFF, Repeat Masker, AssemblyStats) will make sure that the genome file of an organism will match the CDS, proteome, RNA, GFF, etc file and was generated using the same genome assembly version. One aspect of why genomics studies fail in computational and biological reproducibility is that it is not clear whether CDS, proteome, RNA, GFF, etc files used in a proposed analysis were generated using the same genome assembly file denoting the same genome assembly version. To avoid this seemingly trivial mistake we encourage users to retrieve genome file collections using the <code>biomartr</code> function <code>getCollection()</code> and attach the corresponding output as Supplementary Data to the respective genomics study to ensure computational and biological reproducibility.</p>
<p>By specifying the scientific name of an organism of interest a collection consisting of the genome file, proteome file, CDS file, RNA file, GFF file, Repeat Masker file, AssemblyStats file of the organism of interest can be downloaded and stored locally.</p>
<div id="example-ncbi-refseq-7" class="section level3">
<h3>Example <code>NCBI RefSeq</code>:</h3>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb169-1" data-line-number="1"><span class="co"># download collection for Saccharomyces cerevisiae</span></a>
<a class="sourceLine" id="cb169-2" data-line-number="2"><span class="kw">getCollection</span>( <span class="dt">db =</span> <span class="st">&quot;refseq&quot;</span>, </a>
<a class="sourceLine" id="cb169-3" data-line-number="3">               <span class="dt">organism =</span> <span class="st">&quot;Saccharomyces cerevisiae&quot;</span>, </a>
<a class="sourceLine" id="cb169-4" data-line-number="4">               <span class="dt">path =</span> <span class="kw">file.path</span>(<span class="st">&quot;refseq&quot;</span>,<span class="st">&quot;Collections&quot;</span>))</a></code></pre></div>
<p>Internally, the <code>getCollection()</code> function will now generate a folder named <code>refseq/Collection/Saccharomyces_erevisiae</code> and will store all genome and annotation files for <code>Saccharomyces cerevisiae</code> in the same folder. In addition, the exact genoem and annotation version will be logged in the <code>doc</code> folder.</p>
<pre><code>Genome download is completed!
Checking md5 hash of file: refseq/Collections/Saccharomyces_cerevisiae_md5checksums.txt ...
The md5 hash of file 'refseq/Collections/Saccharomyces_cerevisiae_md5checksums.txt' matches!
The genome of 'Saccharomyces_cerevisiae' has been downloaded to 'refseq/Collections' and has been named 'Saccharomyces_cerevisiae_genomic_refseq.fna.gz'.
Starting proteome retrieval of 'Saccharomyces cerevisiae' from refseq ...


Proteome download is completed!
Checking md5 hash of file: refseq/Collections/Saccharomyces_cerevisiae_md5checksums.txt ...
The md5 hash of file 'refseq/Collections/Saccharomyces_cerevisiae_md5checksums.txt' matches!
The proteome of 'Saccharomyces_cerevisiae' has been downloaded to 'refseq/Collections' and has been named 'Saccharomyces_cerevisiae_protein_refseq.faa.gz' .
Starting CDS retrieval of 'Saccharomyces cerevisiae' from refseq ...


CDS download is completed!
Checking md5 hash of file: refseq/Collections/Saccharomyces_cerevisiae_md5checksums.txt ...
The md5 hash of file 'refseq/Collections/Saccharomyces_cerevisiae_md5checksums.txt' matches!
The genomic CDS of 'Saccharomyces_cerevisiae' has been downloaded to 'refseq/Collections' and has been named 'Saccharomyces_cerevisiae_cds_from_genomic_refseq.fna.gz' .
Starting GFF retrieval of 'Saccharomyces cerevisiae' from refseq ...


GFF download is completed!
Checking md5 hash of file: refseq/Collections/Saccharomyces_cerevisiae_md5checksums.txt ...
The md5 hash of file 'refseq/Collections/Saccharomyces_cerevisiae_md5checksums.txt' matches!
The *.gff annotation file of 'Saccharomyces_cerevisiae' has been downloaded to 'refseq/Collections' and has been named 'Saccharomyces_cerevisiae_genomic_refseq.gff.gz'.
Starting RNA retrieval of 'Saccharomyces cerevisiae' from refseq ...


RNA download is completed!
Checking md5 hash of file: refseq/Collections/Saccharomyces_cerevisiae_md5checksums.txt ...
The md5 hash of file 'refseq/Collections/Saccharomyces_cerevisiae_md5checksums.txt' matches!
The genomic RNA of 'Saccharomyces_cerevisiae' has been downloaded to 'refseq/Collections' and has been named 'Saccharomyces_cerevisiae_rna_from_genomic_refseq.fna.gz' .
Starting Repeat Masker retrieval of 'Saccharomyces cerevisiae' from refseq ...


RepeatMasker download is completed!
Checking md5 hash of file: refseq/Collections/Saccharomyces_cerevisiae_md5checksums.txt ...
The md5 hash of file 'refseq/Collections/Saccharomyces_cerevisiae_md5checksums.txt' matches!
The Repeat Masker output file of 'Saccharomyces_cerevisiae' has been downloaded to 'refseq/Collections' and has been named 'Saccharomyces_cerevisiae_rm_refseq.out.gz'.
Starting assembly quality stats retrieval of 'Saccharomyces cerevisiae' from refseq ...

Genome assembly quality stats file download completed!
The assembly statistics file of 'Saccharomyces_cerevisiae' has been downloaded to 'refseq/Collections' and has been named 'Saccharomyces_cerevisiae_assembly_stats_refseq.txt'.
Collection retrieval finished successfully!


We retrieved the genome assembly and checked the annotation for 'Saccharomyces cerevisiae' (taxid: 559292, strain=S288C) from 'ftp://ftp.ncbi.nlm.nih.gov/genomes/all/GCF/000/146/045/GCF_000146045.2_R64/GCF_000146045.2_R64_assembly_stats.txt' (accession: GCF_000146045.2, bioproject: PRJNA128, biosample: NA) using the biomartr R package (Drost and Paszkowski, 2017).</code></pre>
<p>Users can now simply attach the output folder `` as supplementary data in their study and state in the materials sections. This way, computational and biological reproducibility can be standardized and indeed will become trivial in the context of genome version and annotation version.</p>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
