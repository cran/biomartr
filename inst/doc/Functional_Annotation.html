<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="date" content="2016-12-15" />

<title>Functional Annotation with BioMart, GO, and KeGG</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Functional Annotation with BioMart, GO, and KeGG</h1>
<h4 class="date"><em>2016-12-15</em></h4>



<div id="functional-annotation-with-biomart" class="section level2">
<h2>Functional Annotation with BioMart</h2>
<p>The <a href="http://biomart.org/">BioMart</a> project enables users to retrieve a vast diversity of annotation data for specific organisms. Steffen Durinck and Wolfgang Huber provide an powerful interface between the R language and <a href="http://biomart.org/">BioMart</a> by providing the R package <a href="http://www.bioconductor.org/packages/release/bioc/html/biomaRt.html">biomaRt</a>. The following sections will introduce users to the functionality and data retrieval precedures using the <code>biomaRt</code> package and will then introduce them to the interface functions <code>biomart()</code> and <code>biomart_organisms()</code> implemented in <code>biomartr</code> that are based on the <code>biomaRt</code> methodology but aim to introduce an more intuitive way of interacting with BioMart.</p>
<div id="getting-started-with-biomart" class="section level3">
<h3>Getting Started with biomaRt</h3>
<p>The best way to get started with the methodology presented by the established <a href="http://www.bioconductor.org/packages/release/bioc/html/biomaRt.html">biomaRt</a> package is to understand the workflow of data retrieval. The database provided by <a href="http://biomart.org/">BioMart</a> is organized in so called: <code>marts</code>, <code>datasets</code>, and <code>attributes</code>. So when users want to retrieve information for a specific organism of interest, first they need to specify the <code>marts</code> and <code>datasets</code> in which the information of the corresponding organism can be found. Subsequently they can specify the <code>attributes</code> argument that is ought to be returned for the corresponding organism.</p>
<p>The availability of <code>marts</code>, <code>datasets</code>, and <code>attributes</code> can be checked by the following functions:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># install the biomaRt package</span>
<span class="kw">source</span>(<span class="st">&quot;http://bioconductor.org/biocLite.R&quot;</span>)
<span class="kw">biocLite</span>(<span class="st">&quot;biomaRt&quot;</span>)

<span class="co"># load biomaRt</span>
<span class="kw">library</span>(biomaRt)

<span class="co"># look at top 10 databases</span>
<span class="kw">head</span>(<span class="kw">listMarts</span>(<span class="dt">host =</span> <span class="st">&quot;www.ensembl.org&quot;</span>), <span class="dv">10</span>)</code></pre></div>
<pre><code>               biomart               version
1 ENSEMBL_MART_ENSEMBL      Ensembl Genes 83
2     ENSEMBL_MART_SNP  Ensembl Variation 83
3 ENSEMBL_MART_FUNCGEN Ensembl Regulation 83
4    ENSEMBL_MART_VEGA               Vega 63
5                pride        PRIDE (EBI UK)</code></pre>
<p>Users will observe that several <code>marts</code> providing annotation for specific classes of organisms or groups of organisms are available.</p>
<p>For our example, we will choose the <code>hsapiens_gene_ensembl</code> <code>mart</code> and list all available datasets that are element of this <code>mart</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(<span class="kw">listDatasets</span>(<span class="kw">useMart</span>(<span class="st">&quot;ENSEMBL_MART_ENSEMBL&quot;</span>, <span class="dt">host =</span> <span class="st">&quot;www.ensembl.org&quot;</span>)), <span class="dv">10</span>)</code></pre></div>
<pre><code>                          dataset                                description         version
1          oanatinus_gene_ensembl     Ornithorhynchus anatinus genes (OANA5)           OANA5
2         cporcellus_gene_ensembl            Cavia porcellus genes (cavPor3)         cavPor3
3         gaculeatus_gene_ensembl     Gasterosteus aculeatus genes (BROADS1)         BROADS1
4          lafricana_gene_ensembl         Loxodonta africana genes (loxAfr3)         loxAfr3
5  itridecemlineatus_gene_ensembl Ictidomys tridecemlineatus genes (spetri2)         spetri2
6         choffmanni_gene_ensembl        Choloepus hoffmanni genes (choHof1)         choHof1
7          csavignyi_gene_ensembl             Ciona savignyi genes (CSAV2.0)         CSAV2.0
8             fcatus_gene_ensembl        Felis catus genes (Felis_catus_6.2) Felis_catus_6.2
9        rnorvegicus_gene_ensembl         Rattus norvegicus genes (Rnor_6.0)        Rnor_6.0
10         psinensis_gene_ensembl     Pelodiscus sinensis genes (PelSin_1.0)      PelSin_1.0</code></pre>
<p>The <code>useMart()</code> function is a wrapper function provided by <code>biomaRt</code> to connect a selected BioMart database (<code>mart</code>) with a corresponding dataset stored within this <code>mart</code>.</p>
<p>We select dataset <code>hsapiens_gene_ensembl</code> and now check for available attributes (annotation data) that can be accessed for <code>Homo sapiens</code> genes.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(<span class="kw">listAttributes</span>(<span class="kw">useDataset</span>(<span class="dt">dataset =</span> <span class="st">&quot;hsapiens_gene_ensembl&quot;</span>, 
                               <span class="dt">mart    =</span> <span class="kw">useMart</span>(<span class="st">&quot;ENSEMBL_MART_ENSEMBL&quot;</span>,
                               <span class="dt">host    =</span> <span class="st">&quot;www.ensembl.org&quot;</span>))), <span class="dv">10</span>)</code></pre></div>
<pre><code>                    name           description         page
1        ensembl_gene_id       Ensembl Gene ID feature_page
2  ensembl_transcript_id Ensembl Transcript ID feature_page
3     ensembl_peptide_id    Ensembl Protein ID feature_page
4        ensembl_exon_id       Ensembl Exon ID feature_page
5            description           Description feature_page
6        chromosome_name       Chromosome Name feature_page
7         start_position       Gene Start (bp) feature_page
8           end_position         Gene End (bp) feature_page
9                 strand                Strand feature_page
10                  band                  Band feature_page</code></pre>
<p>Please note the nested structure of this attribute query. For an attribute query procedure an additional wrapper function named <code>useDataset()</code> is needed in which <code>useMart()</code> and a corresponding dataset needs to be specified. The result is a table storing the name of available attributes for <em>Homo sapiens</em> as well as a short description.</p>
<p>Furthermore, users can retrieve all filters for <em>Homo sapiens</em> that can be specified by the actual BioMart query process.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(<span class="kw">listFilters</span>(<span class="kw">useDataset</span>(<span class="dt">dataset =</span> <span class="st">&quot;hsapiens_gene_ensembl&quot;</span>, 
                            <span class="dt">mart    =</span> <span class="kw">useMart</span>(<span class="st">&quot;ENSEMBL_MART_ENSEMBL&quot;</span>,
                            <span class="dt">host    =</span> <span class="st">&quot;www.ensembl.org&quot;</span>))), <span class="dv">10</span>)</code></pre></div>
<pre><code>                 name                                               description
1     chromosome_name                                           Chromosome name
2               start                                           Gene Start (bp)
3                 end                                             Gene End (bp)
4          band_start                                                Band Start
5            band_end                                                  Band End
6        marker_start                                              Marker Start
7          marker_end                                                Marker End
8       encode_region                                             Encode region
9              strand                                                    Strand
10 chromosomal_region Chromosome Regions (e.g 1:100:10000:-1,1:100000:200000:1)</code></pre>
<p>After accumulating all this information, it is now possible to perform an actual BioMart query by using the <code>getBM()</code> function.</p>
<p>In this example we will retrieve attributes: <code>start_position</code>,<code>end_position</code> and <code>description</code> for the <em>Homo sapiens</em> gene <code>&quot;GUCA2A&quot;</code>.</p>
<p>Since the input genes are <code>ensembl gene ids</code>, we need to specify the <code>filters</code> argument <code>filters = &quot;hgnc_symbol&quot;</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 1) select a mart and data set</span>
mart &lt;-<span class="st"> </span><span class="kw">useDataset</span>(<span class="dt">dataset =</span> <span class="st">&quot;hsapiens_gene_ensembl&quot;</span>, 
                   <span class="dt">mart    =</span> <span class="kw">useMart</span>(<span class="st">&quot;ENSEMBL_MART_ENSEMBL&quot;</span>,
                   <span class="dt">host    =</span> <span class="st">&quot;www.ensembl.org&quot;</span>))

<span class="co"># 2) run a biomart query using the getBM() function</span>
<span class="co"># and specify the attributes and filter arguments</span>
geneSet &lt;-<span class="st"> &quot;GUCA2A&quot;</span>

resultTable &lt;-<span class="st"> </span><span class="kw">getBM</span>(<span class="dt">attributes =</span> <span class="kw">c</span>(<span class="st">&quot;start_position&quot;</span>,<span class="st">&quot;end_position&quot;</span>,<span class="st">&quot;description&quot;</span>),
                     <span class="dt">filters    =</span> <span class="st">&quot;hgnc_symbol&quot;</span>, 
                     <span class="dt">values     =</span> geneSet, 
                     <span class="dt">mart       =</span> mart)

resultTable </code></pre></div>
<pre><code>  start_position end_position
1       42162691     42164718
                                                                   description
1 guanylate cyclase activator 2A (guanylin) [Source:HGNC Symbol;Acc:HGNC:4682]</code></pre>
<p>When using <code>getBM()</code> users can pass all attributes retrieved by <code>listAttributes()</code> to the <code>attributes</code> argument of the <code>getBM()</code> function.</p>
</div>
</div>
<div id="getting-started-with-biomartr" class="section level1">
<h1>Getting Started with <code>biomartr</code></h1>
<p>This query methodology provided by <code>BioMart</code> and the <code>biomaRt</code> package is a very well defined approach for accurate annotation retrieval. Nevertheless, when learning this query methodology it (subjectively) seems non-intuitive from the user perspective. Therefore, the <code>biomartr</code> package provides another query methodology that aims to be more organism centric.</p>
<p>Taken together, the following workflow allows users to perform fast BioMart queries for attributes using the <code>biomart()</code> function implemented in this <code>biomartr</code> package:</p>
<ol style="list-style-type: decimal">
<li><p>get attributes, datasets, and marts via : <code>organismAttributes()</code></p></li>
<li><p>choose available biological features (filters) via: <code>organismFilters()</code></p></li>
<li><p>specify a set of query genes: e.g. retrieved with <code>getGenome()</code>, <code>getProteome()</code> or <code>getCDS()</code></p></li>
<li><p>specify all arguments of the <code>biomart()</code> function using steps 1) - 3) and perform a BioMart query</p></li>
</ol>
<p><strong>Note that dataset names change very frequently due to the update of dataset versions. So in case some query functions do not work properly, users should check with <code>organismAttributes(update = TRUE)</code> whether or not their dataset name has been changed. For example, <code>organismAttributes(&quot;Homo sapiens&quot;, topic = &quot;id&quot;, update = TRUE)</code> might reveal that the dataset <code>ENSEMBL_MART_ENSEMBL</code> has changed.</strong></p>
<div id="retrieve-marts-datasets-attributes-and-filters-with-biomartr" class="section level2">
<h2>Retrieve marts, datasets, attributes, and filters with biomartr</h2>
<div id="retrieve-available-marts" class="section level3">
<h3>Retrieve Available Marts</h3>
<p>The <code>getMarts()</code> function allows users to list all available databases that can be accessed through BioMart interfaces.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># load the biomartr package</span>
<span class="kw">library</span>(biomartr)

<span class="co"># list all available databases</span>
<span class="kw">getMarts</span>()</code></pre></div>
<pre><code>                   mart               version
1  ENSEMBL_MART_ENSEMBL      Ensembl Genes 87
2    ENSEMBL_MART_MOUSE      Mouse strains 87
3 ENSEMBL_MART_SEQUENCE              Sequence
4 ENSEMBL_MART_ONTOLOGY              Ontology
5  ENSEMBL_MART_GENOMIC   Genomic features 87
6      ENSEMBL_MART_SNP  Ensembl Variation 87
7  ENSEMBL_MART_FUNCGEN Ensembl Regulation 87
8     ENSEMBL_MART_VEGA               Vega 67</code></pre>
</div>
<div id="retrieve-available-datasets-from-a-specific-mart" class="section level3">
<h3>Retrieve Available Datasets from a Specific Mart</h3>
<p>Now users can select a specific database to list all available datasets that can be accessed through this database. In this example we choose the <code>ENSEMBL_MART_ENSEMBL</code> database.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(<span class="kw">getDatasets</span>(<span class="dt">mart =</span> <span class="st">&quot;ENSEMBL_MART_ENSEMBL&quot;</span>) , <span class="dv">5</span>)</code></pre></div>
<pre><code>                         dataset                  description   version
1         oanatinus_gene_ensembl       Platypus genes (OANA5)     OANA5
2        cporcellus_gene_ensembl   Guinea Pig genes (cavPor3)   cavPor3
3        gaculeatus_gene_ensembl Stickleback genes (BROAD S1)  BROAD S1
4         lafricana_gene_ensembl   Elephant genes (Loxafr3.0) Loxafr3.0
5 itridecemlineatus_gene_ensembl     Squirrel genes (spetri2)   spetri2</code></pre>
<p>Now you can select the dataset <code>hsapiens_gene_ensembl</code> and list all available attributes that can be retrieved from this dataset.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tail</span>(<span class="kw">getDatasets</span>(<span class="dt">mart =</span> <span class="st">&quot;ENSEMBL_MART_ENSEMBL&quot;</span>) , <span class="dv">38</span>)</code></pre></div>
<pre><code>                       dataset
32       hsapiens_gene_ensembl
33       pformosa_gene_ensembl
34     tbelangeri_gene_ensembl
35          mfuro_gene_ensembl
36        ggallus_gene_ensembl
37    xtropicalis_gene_ensembl
38      ecaballus_gene_ensembl
39        pabelii_gene_ensembl
40     xmaculatus_gene_ensembl
41         drerio_gene_ensembl
42  tnigroviridis_gene_ensembl
43     lchalumnae_gene_ensembl
44   amelanoleuca_gene_ensembl
45       mmulatta_gene_ensembl
46      pvampyrus_gene_ensembl
47        panubis_gene_ensembl
48     mdomestica_gene_ensembl
49  acarolinensis_gene_ensembl
50         vpacos_gene_ensembl
51      tsyrichta_gene_ensembl
52     ogarnettii_gene_ensembl
53  dmelanogaster_gene_ensembl
54      loculatus_gene_ensembl
55       mmurinus_gene_ensembl
56       olatipes_gene_ensembl
57      oprinceps_gene_ensembl
58       ggorilla_gene_ensembl
59         dordii_gene_ensembl
60         oaries_gene_ensembl
61      mmusculus_gene_ensembl
62     mgallopavo_gene_ensembl
63        gmorhua_gene_ensembl
64       saraneus_gene_ensembl
65 aplatyrhynchos_gene_ensembl
66      sharrisii_gene_ensembl
67        btaurus_gene_ensembl
68       meugenii_gene_ensembl
69    cfamiliaris_gene_ensembl
                                   description                version
32                     Human genes (GRCh38.p7)              GRCh38.p7
33 Amazon molly genes (Poecilia_formosa-5.1.2) Poecilia_formosa-5.1.2
34                  Tree Shrew genes (tupBel1)                tupBel1
35                 Ferret genes (MusPutFur1.0)           MusPutFur1.0
36           Chicken genes (Gallus_gallus-5.0)      Gallus_gallus-5.0
37                     Xenopus genes (JGI 4.2)                JGI 4.2
38                     Horse genes (Equ Cab 2)              Equ Cab 2
39                     Orangutan genes (PPYG2)                  PPYG2
40               Platyfish genes (Xipmac4.4.2)            Xipmac4.4.2
41                    Zebrafish genes (GRCz10)                 GRCz10
42             Tetraodon genes (TETRAODON 8.0)          TETRAODON 8.0
43                  Coelacanth genes (LatCha1)                LatCha1
44                       Panda genes (ailMel1)                ailMel1
45                  Macaque genes (Mmul_8.0.1)             Mmul_8.0.1
46                     Megabat genes (pteVam1)                pteVam1
47              Olive baboon genes (PapAnu2.0)              PapAnu2.0
48                     Opossum genes (monDom5)                monDom5
49              Anole lizard genes (AnoCar2.0)              AnoCar2.0
50                      Alpaca genes (vicPac1)                vicPac1
51                     Tarsier genes (tarSyr1)                tarSyr1
52                    Bushbaby genes (OtoGar3)                OtoGar3
53                      Fruitfly genes (BDGP6)                  BDGP6
54                 Spotted gar genes (LepOcu1)                LepOcu1
55                Mouse Lemur genes (Mmur_2.0)               Mmur_2.0
56                         Medaka genes (HdrR)                   HdrR
57                      Pika genes (OchPri2.0)              OchPri2.0
58                   Gorilla genes (gorGor3.1)              gorGor3.1
59                Kangaroo rat genes (dipOrd1)                dipOrd1
60                      Sheep genes (Oar_v3.1)               Oar_v3.1
61                     Mouse genes (GRCm38.p5)              GRCm38.p5
62                  Turkey genes (Turkey_2.01)            Turkey_2.01
63                         Cod genes (gadMor1)                gadMor1
64                       Shrew genes (sorAra1)                sorAra1
65                   Duck genes (BGI_duck_1.0)           BGI_duck_1.0
66      Tasmanian devil genes (Devil_ref v7.0)         Devil_ref v7.0
67                          Cow genes (UMD3.1)                 UMD3.1
68                    Wallaby genes (Meug_1.0)               Meug_1.0
69                       Dog genes (CanFam3.1)              CanFam3.1</code></pre>
</div>
<div id="retrieve-available-attributes-from-a-specific-dataset" class="section level3">
<h3>Retrieve Available Attributes from a Specific Dataset</h3>
<p>Now that you have selected a database (<code>hsapiens_gene_ensembl</code>) and a dataset (<code>hsapiens_gene_ensembl</code>), users can list all available attributes for this dataset using the <code>getAttributes()</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># list all available attributes for dataset: hsapiens_gene_ensembl</span>
<span class="kw">head</span>( <span class="kw">getAttributes</span>(<span class="dt">mart    =</span> <span class="st">&quot;ENSEMBL_MART_ENSEMBL&quot;</span>, 
                    <span class="dt">dataset =</span> <span class="st">&quot;hsapiens_gene_ensembl&quot;</span>), <span class="dv">10</span> )</code></pre></div>
<pre><code>                    name              description
1        ensembl_gene_id                  Gene ID
2  ensembl_transcript_id            Transcript ID
3     ensembl_peptide_id               Protein ID
4        ensembl_exon_id                  Exon ID
5            description              Description
6        chromosome_name Chromosome/scaffold name
7         start_position          Gene Start (bp)
8           end_position            Gene End (bp)
9                 strand                   Strand
10                  band                     Band</code></pre>
</div>
<div id="retrieve-available-filters-from-a-specific-dataset" class="section level3">
<h3>Retrieve Available Filters from a Specific Dataset</h3>
<p>Finally, the <code>getFilters()</code> function allows users to list available filters for a specific dataset that can be used for a <code>biomart()</code> query.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># list all available filters for dataset: hsapiens_gene_ensembl</span>
<span class="kw">head</span>( <span class="kw">getFilters</span>(<span class="dt">mart    =</span> <span class="st">&quot;ENSEMBL_MART_ENSEMBL&quot;</span>, 
                 <span class="dt">dataset =</span> <span class="st">&quot;hsapiens_gene_ensembl&quot;</span>), <span class="dv">10</span> )</code></pre></div>
<pre><code>                 name                                               description
1     chromosome_name                                           Chromosome name
2               start                                           Gene Start (bp)
3                 end                                             Gene End (bp)
4          band_start                                                Band Start
5            band_end                                                  Band End
6        marker_start                                              Marker Start
7          marker_end                                                Marker End
8       encode_region                                             Encode region
9              strand                                                    Strand
10 chromosomal_region Chromosome Regions (e.g 1:100:10000:-1,1:100000:200000:1)</code></pre>
</div>
</div>
<div id="organism-specific-retrieval-of-information" class="section level2">
<h2>Organism Specific Retrieval of Information</h2>
<p>In most use cases, users will work with a single or a set of model organisms. In this process they will mostly be interested in specific annotations for this particular model organism. The <code>organismBM()</code> function addresses this issue and provides users with an organism centric query to <code>marts</code> and <code>datasets</code> which are available for a particular organism of interest.</p>
<p><strong>Note</strong> that when running the following functions for the first time, the data retrieval procedure will take some time, due to the remote access to BioMart. The corresponding result is then saved in a <code>*.txt</code> file named <code>_biomart/listDatasets.txt</code> within the <code>tempdir()</code> folder, allowing subsequent queries to be performed much faster. The <code>tempdir()</code> folder, however, will be deleted after a new R session was established. In this case the inital call of the subsequent functions again will take time to retrieve all organism specific data from the BioMart database.</p>
<p>This concept of locally storing all organism specific database linking information available in BioMart into an internal file allows users to significantly speed up subsequent retrieval queries for that particular organism.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># retrieving all available datasets and biomart connections for</span>
<span class="co"># a specific query organism (scientific name)</span>
<span class="kw">organismBM</span>(<span class="dt">organism =</span> <span class="st">&quot;Homo sapiens&quot;</span>)</code></pre></div>
<pre><code>   organism_name                                                                           description
           &lt;chr&gt;                                                                                 &lt;chr&gt;
1       hsapiens                                                               Human genes (GRCh38.p7)
2       hsapiens                                                    homo_sapiens sequences (GRCh38.p7)
3       hsapiens         Human Short Variants (SNPs and indels excluding flagged variants) (GRCh38.p7)
4       hsapiens                                                 Human Structural Variants (GRCh38.p7)
5       hsapiens                                         Human Somatic Structural Variants (GRCh38.p7)
6       hsapiens Human Somatic Short Variants (SNPs and indels excluding flagged variants) (GRCh38.p7)
7       hsapiens                                                 Human Regulatory Evidence (GRCh38.p7)
8       hsapiens                                                      Human Binding Motifs (GRCh38.p7)
9       hsapiens                                                 Human Regulatory Features (GRCh38.p7)
10      hsapiens                                                Human miRNA Target Regions (GRCh38.p7)
11      hsapiens                                            Human Other Regulatory Regions (GRCh38.p7)
12      hsapiens                                                               Human genes (GRCh38.p7)
 with 3 more variables: mart &lt;chr&gt;, dataset &lt;chr&gt;, version &lt;chr&gt;</code></pre>
<p>The result is a table storing all <code>marts</code> and <code>datasets</code> from which annotations can be retrieved for <em>Homo sapiens</em>. Furthermore, a short description as well as the version of the dataset being accessed (very useful for publications) is returned.</p>
<p>Users will observe that 3 different <code>marts</code> provide 6 different <code>datasets</code> storing annotation information for <em>Homo sapiens</em>.</p>
<p><strong>Please note, however, that scientific names of organisms must be written correctly! For ex. “Homo Sapiens” will be treated differently (not recognized) than “Homo sapiens” (recognized).</strong></p>
<p>Similar to the <code>biomaRt</code> package query methodology, users need to specify <code>attributes</code> and <code>filters</code> to be able to perform accurate BioMart queries. Here the functions <code>organismAttributes()</code> and <code>organismFilters()</code> provide useful and intuitive concepts to obtain this information.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># return available attributes for &quot;Homo sapiens&quot;</span>
<span class="kw">head</span>(<span class="kw">organismAttributes</span>(<span class="st">&quot;Homo sapiens&quot;</span>), <span class="dv">20</span>)</code></pre></div>
<pre><code>                       name                                description
                      &lt;chr&gt;                                      &lt;chr&gt;
1           ensembl_gene_id                                    Gene ID
2     ensembl_transcript_id                              Transcript ID
3        ensembl_peptide_id                                 Protein ID
4           ensembl_exon_id                                    Exon ID
5               description                                Description
6           chromosome_name                   Chromosome/scaffold name
7            start_position                            Gene Start (bp)
8              end_position                              Gene End (bp)
9                    strand                                     Strand
10                     band                                       Band
11         transcript_start                      Transcript Start (bp)
12           transcript_end                        Transcript End (bp)
13 transcription_start_site             Transcription Start Site (TSS)
14        transcript_length Transcript length (including UTRs and CDS)
15           transcript_tsl             Transcript Support Level (TSL)
16 transcript_gencode_basic                   GENCODE basic annotation
17        transcript_appris                          APPRIS annotation
18       external_gene_name                       Associated Gene Name
19     external_gene_source                     Associated Gene Source
20 external_transcript_name                 Associated Transcript Name
 with 2 more variables: dataset &lt;chr&gt;, mart &lt;chr&gt;
Warning messages:
1: No attributes were available for mart = ENSEMBL_MART_SEQUENCE and dataset = hsapiens_genomic_sequence. 
2: No attributes were available for mart = ENSEMBL_MART_SEQUENCE and dataset = hsapiens_genomic_sequence. 
3: No attributes were available for mart = ENSEMBL_MART_SEQUENCE and dataset = hsapiens_genomic_sequence. 
4: No attributes were available for mart = ENSEMBL_MART_SEQUENCE and dataset = hsapiens_genomic_sequence. 
5: No attributes were available for mart = ENSEMBL_MART_SEQUENCE and dataset = hsapiens_genomic_sequence.</code></pre>
<p>Users will observe that the <code>organismAttributes()</code> function returns a data.frame storing attribute names, datasets, and marts which are available for <code>Homo sapiens</code>. After the ENSEMBL release 87 the <code>ENSEMBL_MART_SEQUENCE</code> service provided by Ensembl does not work properly and thus the <code>organismAttributes()</code> function prints out warning messages to make the user aware when certain marts provided bt Ensembl do not work properly, yet.</p>
<p>An additional feature provided by <code>organismAttributes()</code> is the <code>topic</code> argument. The <code>topic</code> argument allows users to to search for specific attributes, topics, or categories for faster filtering.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># search for attribute topic &quot;id&quot;</span>
<span class="kw">head</span>(<span class="kw">organismAttributes</span>(<span class="st">&quot;Homo sapiens&quot;</span>, <span class="dt">topic =</span> <span class="st">&quot;id&quot;</span>), <span class="dv">20</span>)</code></pre></div>
<pre><code>                       name                                       description               dataset
                      &lt;chr&gt;                                             &lt;chr&gt;                 &lt;chr&gt;
1           ensembl_gene_id                                           Gene ID hsapiens_gene_ensembl
2     ensembl_transcript_id                                     Transcript ID hsapiens_gene_ensembl
3        ensembl_peptide_id                                        Protein ID hsapiens_gene_ensembl
4           ensembl_exon_id                                           Exon ID hsapiens_gene_ensembl
5         study_external_id                          Study External Reference hsapiens_gene_ensembl
6                     go_id                                 GO Term Accession hsapiens_gene_ensembl
7                 dbass3_id Database of Aberrant 3 Splice Sites (DBASS3) IDs hsapiens_gene_ensembl
8                 dbass5_id Database of Aberrant 5 Splice Sites (DBASS5) IDs hsapiens_gene_ensembl
9                   hgnc_id                                        HGNC ID(s) hsapiens_gene_ensembl
10               mirbase_id                                     miRBase ID(s) hsapiens_gene_ensembl
11               mim_morbid                                        MIM MORBID hsapiens_gene_ensembl
12               protein_id              Protein (Genbank) ID [e.g. AAA02487] hsapiens_gene_ensembl
13           refseq_peptide             RefSeq Protein ID [e.g. NP_001005353] hsapiens_gene_ensembl
14 refseq_peptide_predicted   RefSeq Predicted Protein ID [e.g. XP_001720922] hsapiens_gene_ensembl
15              wikigene_id                                       WikiGene ID hsapiens_gene_ensembl
16          ensembl_gene_id                                           Gene ID hsapiens_gene_ensembl
17    ensembl_transcript_id                                     Transcript ID hsapiens_gene_ensembl
18       ensembl_peptide_id                                        Protein ID hsapiens_gene_ensembl
19          ensembl_exon_id                                           Exon ID hsapiens_gene_ensembl
20          ensembl_gene_id                                           Gene ID hsapiens_gene_ensembl
with 1 more variables: mart &lt;chr&gt;</code></pre>
<p>Now, all <code>attribute names</code> having <code>id</code> as part of their <code>name</code> are being returned.</p>
<p>Another example is <code>topic = &quot;homolog&quot;</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># search for attribute topic &quot;homolog&quot;</span>
<span class="kw">head</span>(<span class="kw">organismAttributes</span>(<span class="st">&quot;Homo sapiens&quot;</span>, <span class="dt">topic =</span> <span class="st">&quot;homolog&quot;</span>), <span class="dv">20</span>)</code></pre></div>
<pre><code>                                          name
                                         &lt;chr&gt;
1                  vpacos_homolog_ensembl_gene
2          vpacos_homolog_associated_gene_name
3               vpacos_homolog_ensembl_peptide
4                    vpacos_homolog_chromosome
5                   vpacos_homolog_chrom_start
6                     vpacos_homolog_chrom_end
7  vpacos_homolog_canonical_transcript_protein
8                       vpacos_homolog_subtype
9                vpacos_homolog_orthology_type
10                      vpacos_homolog_perc_id
11                   vpacos_homolog_perc_id_r1
12                    vpacos_homolog_goc_score
13                 vpacos_homolog_wga_coverage
14                           vpacos_homolog_dn
15                           vpacos_homolog_ds
16         vpacos_homolog_orthology_confidence
17               pformosa_homolog_ensembl_gene
18       pformosa_homolog_associated_gene_name
19            pformosa_homolog_ensembl_peptide
20                 pformosa_homolog_chromosome
  with 3 more variables: description &lt;chr&gt;, dataset &lt;chr&gt;, mart &lt;chr&gt;</code></pre>
<p>Or <code>topic = &quot;dn&quot;</code> and <code>topic = &quot;ds&quot;</code> for <code>dn</code> and <code>ds</code> value retrieval.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># search for attribute topic &quot;dn&quot;</span>
<span class="kw">head</span>(<span class="kw">organismAttributes</span>(<span class="st">&quot;Homo sapiens&quot;</span>, <span class="dt">topic =</span> <span class="st">&quot;dn&quot;</span>))</code></pre></div>
<pre><code>A tibble: 6 × 4
                                name              description               dataset                 mart
                               &lt;chr&gt;                    &lt;chr&gt;                 &lt;chr&gt;                &lt;chr&gt;
1                  cdna_coding_start        cDNA coding start hsapiens_gene_ensembl ENSEMBL_MART_ENSEMBL
2                    cdna_coding_end          cDNA coding end hsapiens_gene_ensembl ENSEMBL_MART_ENSEMBL
3                  vpacos_homolog_dn           dN with Alpaca hsapiens_gene_ensembl ENSEMBL_MART_ENSEMBL
4                pformosa_homolog_dn     dN with Amazon molly hsapiens_gene_ensembl ENSEMBL_MART_ENSEMBL
5           acarolinensis_homolog_dn     dN with Anole lizard hsapiens_gene_ensembl ENSEMBL_MART_ENSEMBL
6 dnovemcinctus_homolog_ensembl_gene Armadillo gene stable ID hsapiens_gene_ensembl ENSEMBL_MART_ENSEMBL</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># search for attribute topic &quot;ds&quot;</span>
<span class="kw">head</span>(<span class="kw">organismAttributes</span>(<span class="st">&quot;Homo sapiens&quot;</span>, <span class="dt">topic =</span> <span class="st">&quot;ds&quot;</span>))</code></pre></div>
<pre><code>                 name          description               dataset                 mart
                &lt;chr&gt;                &lt;chr&gt;                 &lt;chr&gt;                &lt;chr&gt;
1                ccds              CCDS ID hsapiens_gene_ensembl ENSEMBL_MART_ENSEMBL
2          cds_length           CDS Length hsapiens_gene_ensembl ENSEMBL_MART_ENSEMBL
3           cds_start            CDS Start hsapiens_gene_ensembl ENSEMBL_MART_ENSEMBL
4             cds_end              CDS End hsapiens_gene_ensembl ENSEMBL_MART_ENSEMBL
5   vpacos_homolog_ds       dS with Alpaca hsapiens_gene_ensembl ENSEMBL_MART_ENSEMBL
6 pformosa_homolog_ds dS with Amazon molly hsapiens_gene_ensembl ENSEMBL_MART_ENSEMBL</code></pre>
<p>Analogous to the <code>organismAttributes()</code> function, the <code>organismFilters()</code> function returns all filters that are available for a query organism of interest.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># return available filters for &quot;Homo sapiens&quot;</span>
<span class="kw">head</span>(<span class="kw">organismFilters</span>(<span class="st">&quot;Homo sapiens&quot;</span>), <span class="dv">20</span>)</code></pre></div>
<pre><code>                                     name                                               description
                                    &lt;chr&gt;                                                     &lt;chr&gt;
1                         chromosome_name                                           Chromosome name
2                                   start                                           Gene Start (bp)
3                                     end                                             Gene End (bp)
4                              band_start                                                Band Start
5                                band_end                                                  Band End
6                            marker_start                                              Marker Start
7                              marker_end                                                Marker End
8                           encode_region                                             Encode region
9                                  strand                                                    Strand
10                     chromosomal_region Chromosome Regions (e.g 1:100:10000:-1,1:100000:200000:1)
11                              with_hgnc                                           with HGNC ID(s)
12              with_hgnc_transcript_name                              with HGNC transcript name(s)
13                   with_ox_arrayexpress                                   with ArrayExpress ID(s)
14                              with_ccds                                           with CCDS ID(s)
15                            with_chembl                                         with ChEMBL ID(s)
16       with_ox_clone_based_ensembl_gene                       with clone based Ensembl gene ID(s)
17 with_ox_clone_based_ensembl_transcript                 with clone based Ensembl transcript ID(s)
18          with_ox_clone_based_vega_gene                          with clone based VEGA gene ID(s)
19    with_ox_clone_based_vega_transcript                    with clone based VEGA transcript ID(s)
20                            with_dbass3                                         with DBASS3 ID(s)
 with 2 more variables: dataset &lt;chr&gt;, mart &lt;chr&gt;</code></pre>
<p>The <code>organismFilters()</code> function also allows users to search for filters that correspond to a specific topic or category.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># search for filter topic &quot;id&quot;</span>
<span class="kw">head</span>(<span class="kw">organismFilters</span>(<span class="st">&quot;Homo sapiens&quot;</span>, <span class="dt">topic =</span> <span class="st">&quot;id&quot;</span>), <span class="dv">20</span>)</code></pre></div>
<pre><code>                             name                                        description
                            &lt;chr&gt;                                              &lt;chr&gt;
1                      with_go_id                          with GO Term Accession(s)
2                 with_mim_morbid                              with MIM MORBID ID(s)
3                 with_protein_id                       with protein (Genbank) ID(s)
4             with_refseq_peptide                          with RefSeq protein ID(s)
5   with_refseq_peptide_predicted                with RefSeq predicted protein ID(s)
6                 ensembl_gene_id                  Gene ID(s) [e.g. ENSG00000139618]
7           ensembl_transcript_id            Transcript ID(s) [e.g. ENST00000380152]
8              ensembl_peptide_id               Protein ID(s) [e.g. ENSP00000369497]
9                 ensembl_exon_id                  Exon ID(s) [e.g. ENSE00001508081]
10                        hgnc_id                        HGNC ID(s) [e.g. HGNC:8030]
11                          go_id             GO Term Accession(s) [e.g. GO:0005515]
12                     mim_morbid                     MIM MORBID ID(s) [e.g. 100100]
13                     mirbase_id                   miRBase ID(s) [e.g. hsa-mir-137]
14                     protein_id            Protein (Genbank) ID(s) [e.g. ACU09872]
15                 refseq_peptide           RefSeq protein ID(s) [e.g. NP_001005353]
16       refseq_peptide_predicted RefSeq predicted protein ID(s) [e.g. XP_011520427]
17                    wikigene_id                       WikiGene ID(s) [e.g. 115286]
18               go_evidence_code                                   GO Evidence code
19 with_itridecemlineatus_homolog                         Orthologous Squirrel Genes
20     with_tnigroviridis_homolog                        Orthologous Tetraodon Genes
with 2 more variables: dataset &lt;chr&gt;, mart &lt;chr&gt;</code></pre>
</div>
<div id="performing-biomart-queries-with-biomartr" class="section level2">
<h2>Performing BioMart queries with biomartr</h2>
<p>The short introduction to the functionality of <code>organismBM()</code>, <code>organismAttributes()</code>, and <code>organismFilters()</code> will allow users to perform BioMart queries in a very intuitive organism centric way. The main function to perform BioMart queries is <code>biomart()</code>.</p>
<p>For the following examples we will assume that we are interested in the annotation of specific genes from the <em>Homo sapiens</em> proteome. We want to map the corresponding refseq gene id to a set of other gene ids used in other databases. For this purpose, first we need consult the <code>organismAttributes()</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(<span class="kw">organismAttributes</span>(<span class="st">&quot;Homo sapiens&quot;</span>, <span class="dt">topic =</span> <span class="st">&quot;id&quot;</span>))</code></pre></div>
<pre><code>                   name              description               dataset                 mart
                  &lt;chr&gt;                    &lt;chr&gt;                 &lt;chr&gt;                &lt;chr&gt;
1       ensembl_gene_id                  Gene ID hsapiens_gene_ensembl ENSEMBL_MART_ENSEMBL
2 ensembl_transcript_id            Transcript ID hsapiens_gene_ensembl ENSEMBL_MART_ENSEMBL
3    ensembl_peptide_id               Protein ID hsapiens_gene_ensembl ENSEMBL_MART_ENSEMBL
4       ensembl_exon_id                  Exon ID hsapiens_gene_ensembl ENSEMBL_MART_ENSEMBL
5     study_external_id Study External Reference hsapiens_gene_ensembl ENSEMBL_MART_ENSEMBL
6                 go_id        GO Term Accession hsapiens_gene_ensembl ENSEMBL_MART_ENSEMBL</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># retrieve the proteome of Homo sapiens from refseq</span>
file_path &lt;-<span class="st"> </span><span class="kw">getProteome</span>( <span class="dt">db       =</span> <span class="st">&quot;refseq&quot;</span>,
                          <span class="dt">organism =</span> <span class="st">&quot;Homo sapiens&quot;</span>,
                          <span class="dt">path     =</span> <span class="kw">file.path</span>(<span class="st">&quot;_ncbi_downloads&quot;</span>,<span class="st">&quot;proteomes&quot;</span>) )

Hsapiens_proteome &lt;-<span class="st"> </span><span class="kw">read_proteome</span>(file_path, <span class="dt">format =</span> <span class="st">&quot;fasta&quot;</span>)

<span class="co"># remove splice variants from id</span>
gene_set &lt;-<span class="st"> </span><span class="kw">unlist</span>(<span class="kw">sapply</span>(<span class="kw">strsplit</span>(Hsapiens_proteome@ranges@NAMES[<span class="dv">1</span>:<span class="dv">5</span>], <span class="st">&quot;.&quot;</span>,<span class="dt">fixed =</span> <span class="ot">TRUE</span>), function(x) x[<span class="dv">1</span>]))

result_BM &lt;-<span class="st"> </span><span class="kw">biomart</span>( <span class="dt">genes      =</span> gene_set,
                      <span class="dt">mart       =</span> <span class="st">&quot;ENSEMBL_MART_ENSEMBL&quot;</span>, 
                      <span class="dt">dataset    =</span> <span class="st">&quot;hsapiens_gene_ensembl&quot;</span>,
                      <span class="dt">attributes =</span> <span class="kw">c</span>(<span class="st">&quot;ensembl_gene_id&quot;</span>,<span class="st">&quot;ensembl_peptide_id&quot;</span>),
                      <span class="dt">filters    =</span> <span class="st">&quot;refseq_peptide&quot;</span>)

result_BM </code></pre></div>
<pre><code>  refseq_peptide ensembl_gene_id ensembl_peptide_id
1      NP_000005 ENSG00000175899    ENSP00000323929
2      NP_000006 ENSG00000156006    ENSP00000286479
3      NP_000007 ENSG00000117054    ENSP00000359878
4      NP_000008 ENSG00000122971    ENSP00000242592
5      NP_000009 ENSG00000072778    ENSP00000349297</code></pre>
<p>The <code>biomart()</code> function takes as arguments a set of genes (gene ids specified in the <code>filter</code> argument), the corresponding <code>mart</code> and <code>dataset</code>, as well as the <code>attributes</code> which shall be returned.</p>
</div>
<div id="gene-ontology" class="section level2">
<h2>Gene Ontology</h2>
<p>The <code>biomartr</code> package also enables a fast and intuitive retrieval of GO terms and additional information via the <code>getGO()</code> function. Several databases can be selected to retrieve GO annotation information for a set of query genes. So far, the <code>getGO()</code> function allows GO information retrieval from the <a href="http://www.biomart.org/">BioMart</a> database.</p>
<p>In this example we will retrieve GO information for a set of <em>Homo sapiens</em> genes stored as <code>hgnc_symbol</code>.</p>
<div id="go-annotation-retrieval-via-biomart" class="section level3">
<h3>GO Annotation Retrieval via BioMart</h3>
<p>The <code>getGO()</code> function takes several arguments as input to retrieve GO information from BioMart. First, the scientific name of the <code>organism</code> of interest needs to be specified. Furthermore, a set of <code>gene ids</code> as well as their corresponding <code>filter</code> notation (<code>GUCA2A</code> gene ids have <code>filter</code> notation <code>hgnc_symbol</code>; see <code>organismFilters()</code> for details) need to be specified. The <code>database</code> argument then defines the database from which GO information shall be retrieved.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># search for GO terms of an example Homo sapiens gene</span>
GO_tbl &lt;-<span class="st"> </span><span class="kw">getGO</span>(<span class="dt">organism =</span> <span class="st">&quot;Homo sapiens&quot;</span>, 
                <span class="dt">genes    =</span> <span class="st">&quot;GUCA2A&quot;</span>,
                <span class="dt">filters  =</span> <span class="st">&quot;hgnc_symbol&quot;</span>)

GO_tbl</code></pre></div>
<pre><code>  hgnc_symbol                       goslim_goa_description goslim_goa_accession
1      GUCA2A                           cellular_component           GO:0005575
2      GUCA2A                         extracellular region           GO:0005576
3      GUCA2A                           biological_process           GO:0008150
4      GUCA2A cellular nitrogen compound metabolic process           GO:0034641
5      GUCA2A             small molecule metabolic process           GO:0044281
6      GUCA2A                         biosynthetic process           GO:0009058
7      GUCA2A                           molecular_function           GO:0003674
8      GUCA2A                                    organelle           GO:0043226
9      GUCA2A                    enzyme regulator activity           GO:0030234</code></pre>
<p>Hence, for each <em>gene id</em> the resulting table stores all annotated GO terms found in BioMart.</p>
</div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
